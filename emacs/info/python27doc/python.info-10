This is python.info, produced by makeinfo version 4.8 from python.texi.

Generated by Sphinx 1.6.3.
INFO-DIR-SECTION Python
START-INFO-DIR-ENTRY
* Python: (python.info). The Python reference manual.
END-INFO-DIR-ENTRY

     Python 2.7.13, July 15, 2017

     Copyright (C) 1990-2017, Python Software Foundation


File: python.info,  Node: Process Management,  Next: Miscellaneous System Information,  Prev: Files and Directories,  Up: os — Miscellaneous operating system interfaces

5.15.1.6 Process Management
...........................

These functions may be used to create and manage processes.

The various *Note exec*: 1191. functions take a list of arguments for
the new program loaded into the process.  In each case, the first of
these arguments is passed to the new program as its own name rather
than as an argument a user may have typed on a command line.  For the C
programmer, this is the `argv[0]' passed to a program’s `main()'.
For example, `os.execv('/bin/echo', ['foo', 'bar'])' will only print
`bar' on standard output; `foo' will seem to be ignored.

 -- Function: os.abort ()
     Generate a `SIGABRT' signal to the current process.  On Unix, the
     default behavior is to produce a core dump; on Windows, the
     process immediately returns an exit code of `3'.  Be aware that
     calling this function will not call the Python signal handler
     registered for `SIGABRT' with *Note signal.signal(): 426.

     Availability: Unix, Windows.

 -- Function: os.execl (path, arg0, arg1, ...)
 -- Function: os.execle (path, arg0, arg1, ..., env)
 -- Function: os.execlp (file, arg0, arg1, ...)
 -- Function: os.execlpe (file, arg0, arg1, ..., env)
 -- Function: os.execv (path, args)
 -- Function: os.execve (path, args, env)
 -- Function: os.execvp (file, args)
 -- Function: os.execvpe (file, args, env)
     These functions all execute a new program, replacing the current
     process; they do not return.  On Unix, the new executable is
     loaded into the current process, and will have the same process id
     as the caller.  Errors will be reported as *Note OSError: 231.
     exceptions.

     The current process is replaced immediately. Open file objects and
     descriptors are not flushed, so if there may be data buffered on
     these open files, you should flush them using `sys.stdout.flush()'
     or *Note os.fsync(): 934. before calling an *Note exec*: 1191.
     function.

     The “l” and “v” variants of the *Note exec*: 1191.
     functions differ in how command-line arguments are passed.  The
     “l” variants are perhaps the easiest to work with if the
     number of parameters is fixed when the code is written; the
     individual parameters simply become additional parameters to the
     `execl*()' functions.  The “v” variants are good when the
     number of parameters is variable, with the arguments being passed
     in a list or tuple as the `args' parameter.  In either case, the
     arguments to the child process should start with the name of the
     command being run, but this is not enforced.

     The variants which include a “p” near the end (*Note execlp():
     1194, *Note execlpe(): 1195, *Note execvp(): 1197, and *Note
     execvpe(): 1198.) will use the `PATH' environment variable to
     locate the program `file'.  When the environment is being replaced
     (using one of the *Note exec*e: 1191. variants, discussed in the
     next paragraph), the new environment is used as the source of the `PATH'
     variable. The other variants, *Note execl(): 1191, *Note execle():
     1193, *Note execv(): 1124, and *Note execve(): 1196, will not use
     the `PATH' variable to locate the executable; `path' must contain
     an appropriate absolute or relative path.

     For *Note execle(): 1193, *Note execlpe(): 1195, *Note execve():
     1196, and *Note execvpe(): 1198. (note that these all end in
     “e”), the `env' parameter must be a mapping which is used to
     define the environment variables for the new process (these are
     used instead of the current process’ environment); the functions
     *Note execl(): 1191, *Note execlp(): 1194, *Note execv(): 1124,
     and *Note execvp(): 1197. all cause the new process to inherit the
     environment of the current process.

     Availability: Unix, Windows.

 -- Function: os._exit (n)
     Exit the process with status `n', without calling cleanup
     handlers, flushing stdio buffers, etc.

     Availability: Unix, Windows.

          Note: The standard way to exit is `sys.exit(n)'.  *Note
          _exit(): 97b. should normally only be used in the child
          process after a *Note fork(): 244.

The following exit codes are defined and can be used with *Note
_exit(): 97b, although they are not required.  These are typically used
for system programs written in Python, such as a mail server’s
external command delivery program.

     Note: Some of these may not be available on all Unix platforms,
     since there is some variation.  These constants are defined where
     they are defined by the underlying platform.

 -- Data: os.EX_OK
     Exit code that means no error occurred.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_USAGE
     Exit code that means the command was used incorrectly, such as
     when the wrong number of arguments are given.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_DATAERR
     Exit code that means the input data was incorrect.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_NOINPUT
     Exit code that means an input file did not exist or was not
     readable.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_NOUSER
     Exit code that means a specified user did not exist.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_NOHOST
     Exit code that means a specified host did not exist.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_UNAVAILABLE
     Exit code that means that a required service is unavailable.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_SOFTWARE
     Exit code that means an internal software error was detected.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_OSERR
     Exit code that means an operating system error was detected, such
     as the inability to fork or create a pipe.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_OSFILE
     Exit code that means some system file did not exist, could not be
     opened, or had some other kind of error.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_CANTCREAT
     Exit code that means a user specified output file could not be
     created.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_IOERR
     Exit code that means that an error occurred while doing I/O on
     some file.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_TEMPFAIL
     Exit code that means a temporary failure occurred.  This indicates
     something that may not really be an error, such as a network
     connection that couldn’t be made during a retryable operation.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_PROTOCOL
     Exit code that means that a protocol exchange was illegal,
     invalid, or not understood.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_NOPERM
     Exit code that means that there were insufficient permissions to
     perform the operation (but not intended for file system problems).

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_CONFIG
     Exit code that means that some kind of configuration error
     occurred.

     Availability: Unix.

     New in version 2.3.


 -- Data: os.EX_NOTFOUND
     Exit code that means something like “an entry was not found”.

     Availability: Unix.

     New in version 2.3.


 -- Function: os.fork ()
     Fork a child process.  Return `0' in the child and the child’s
     process id in the parent.  If an error occurs *Note OSError: 231.
     is raised.

     Note that some platforms including FreeBSD <= 6.3, Cygwin and OS/2
     EMX have known issues when using fork() from a thread.

          Warning: See *Note ssl: 160. for applications that use the
          SSL module with fork().

     Availability: Unix.

 -- Function: os.forkpty ()
     Fork a child process, using a new pseudo-terminal as the child’s
     controlling terminal. Return a pair of `(pid, fd)', where `pid' is
     `0' in the child, the new child’s process id in the parent, and
     `fd' is the file descriptor of the master end of the
     pseudo-terminal.  For a more portable approach, use the *Note pty:
     13c. module.  If an error occurs *Note OSError: 231. is raised.

     Availability: some flavors of Unix.

 -- Function: os.kill (pid, sig)
     Send signal `sig' to the process `pid'.  Constants for the
     specific signals available on the host platform are defined in the
     *Note signal: 155. module.

     Windows: The *Note signal.CTRL_C_EVENT: 11ab. and *Note
     signal.CTRL_BREAK_EVENT: 11ac. signals are special signals which
     can only be sent to console processes which share a common console
     window, e.g., some subprocesses. Any other value for `sig' will
     cause the process to be unconditionally killed by the
     TerminateProcess API, and the exit code will be set to `sig'. The
     Windows version of *Note kill(): 2d4. additionally takes process
     handles to be killed.

     New in version 2.7: Windows support


 -- Function: os.killpg (pgid, sig)
     Send the signal `sig' to the process group `pgid'.

     Availability: Unix.

     New in version 2.3.


 -- Function: os.nice (increment)
     Add `increment' to the process’s “niceness”.  Return the new
     niceness.

     Availability: Unix.

 -- Function: os.plock (op)
     Lock program segments into memory.  The value of `op' (defined in
     `<sys/lock.h>') determines which segments are locked.

     Availability: Unix.

 -- Function: os.popen (...)
 -- Function: os.popen2 (...)
 -- Function: os.popen3 (...)
 -- Function: os.popen4 (...)
     Run child processes, returning opened pipes for communications.
     These functions are described in section *Note File Object
     Creation: 1133.

 -- Function: os.spawnl (mode, path, ...)
 -- Function: os.spawnle (mode, path, ..., env)
 -- Function: os.spawnlp (mode, file, ...)
 -- Function: os.spawnlpe (mode, file, ..., env)
 -- Function: os.spawnv (mode, path, args)
 -- Function: os.spawnve (mode, path, args, env)
 -- Function: os.spawnvp (mode, file, args)
 -- Function: os.spawnvpe (mode, file, args, env)
     Execute the program `path' in a new process.

     (Note that the *Note subprocess: 167. module provides more
     powerful facilities for spawning new processes and retrieving
     their results; using that module is preferable to using these
     functions.  Check especially the *Note Replacing Older Functions
     with the subprocess Module: 1135. section.)

     If `mode' is *Note P_NOWAIT: 11b7, this function returns the
     process id of the new process; if `mode' is *Note P_WAIT: 11b8,
     returns the process’s exit code if it exits normally, or
     `-signal', where `signal' is the signal that killed the process.
     On Windows, the process id will actually be the process handle, so
     can be used with the *Note waitpid(): 11b9. function.

     The “l” and “v” variants of the *Note spawn*: 11b0.
     functions differ in how command-line arguments are passed.  The
     “l” variants are perhaps the easiest to work with if the
     number of parameters is fixed when the code is written; the
     individual parameters simply become additional parameters to the
     `spawnl*()' functions.  The “v” variants are good when the
     number of parameters is variable, with the arguments being passed
     in a list or tuple as the `args' parameter.  In either case, the
     arguments to the child process must start with the name of the
     command being run.

     The variants which include a second “p” near the end (*Note
     spawnlp(): 11b2, *Note spawnlpe(): 11b3, *Note spawnvp(): 11b5,
     and *Note spawnvpe(): 11b6.) will use the `PATH' environment
     variable to locate the program `file'.  When the environment is
     being replaced (using one of the *Note spawn*e: 11b0. variants,
     discussed in the next paragraph), the new environment is used as
     the source of the `PATH' variable.  The other variants, *Note
     spawnl(): 11b0, *Note spawnle(): 11b1, *Note spawnv(): 1137, and
     *Note spawnve(): 11b4, will not use the `PATH' variable to locate
     the executable; `path' must contain an appropriate absolute or
     relative path.

     For *Note spawnle(): 11b1, *Note spawnlpe(): 11b3, *Note
     spawnve(): 11b4, and *Note spawnvpe(): 11b6.  (note that these all
     end in “e”), the `env' parameter must be a mapping which is
     used to define the environment variables for the new process (they
     are used instead of the current process’ environment); the
     functions *Note spawnl(): 11b0, *Note spawnlp(): 11b2, *Note
     spawnv(): 1137, and *Note spawnvp(): 11b5. all cause the new
     process to inherit the environment of the current process.  Note
     that keys and values in the `env' dictionary must be strings;
     invalid keys or values will cause the function to fail, with a
     return value of `127'.

     As an example, the following calls to *Note spawnlp(): 11b2. and
     *Note spawnvpe(): 11b6. are equivalent:

         import os
         os.spawnlp(os.P_WAIT, 'cp', 'cp', 'index.html', '/dev/null')

         L = ['cp', 'index.html', '/dev/null']
         os.spawnvpe(os.P_WAIT, 'cp', L, os.environ)

     Availability: Unix, Windows.  *Note spawnlp(): 11b2, *Note
     spawnlpe(): 11b3, *Note spawnvp(): 11b5.  and *Note spawnvpe():
     11b6. are not available on Windows.  *Note spawnle(): 11b1. and
     *Note spawnve(): 11b4. are not thread-safe on Windows; we advise
     you to use the *Note subprocess: 167. module instead.

     New in version 1.6.


 -- Data: os.P_NOWAIT
 -- Data: os.P_NOWAITO
     Possible values for the `mode' parameter to the *Note spawn*:
     11b0. family of functions.  If either of these values is given,
     the `spawn*()' functions will return as soon as the new process
     has been created, with the process id as the return value.

     Availability: Unix, Windows.

     New in version 1.6.


 -- Data: os.P_WAIT
     Possible value for the `mode' parameter to the *Note spawn*: 11b0.
     family of functions.  If this is given as `mode', the `spawn*()'
     functions will not return until the new process has run to
     completion and will return the exit code of the process the run is
     successful, or `-signal' if a signal kills the process.

     Availability: Unix, Windows.

     New in version 1.6.


 -- Data: os.P_DETACH
 -- Data: os.P_OVERLAY
     Possible values for the `mode' parameter to the *Note spawn*:
     11b0. family of functions.  These are less portable than those
     listed above. *Note P_DETACH: 11bb.  is similar to *Note P_NOWAIT:
     11b7, but the new process is detached from the console of the
     calling process. If *Note P_OVERLAY: 11bc. is used, the current
     process will be replaced; the `spawn*()' function will not return.

     Availability: Windows.

     New in version 1.6.


 -- Function: os.startfile (path[, operation])
     Start a file with its associated application.

     When `operation' is not specified or `'open'', this acts like
     double-clicking the file in Windows Explorer, or giving the file
     name as an argument to the `start' command from the interactive
     command shell: the file is opened with whatever application (if
     any) its extension is associated.

     When another `operation' is given, it must be a “command verb”
     that specifies what should be done with the file. Common verbs
     documented by Microsoft are `'print'' and  `'edit'' (to be used on
     files) as well as `'explore'' and `'find'' (to be used on
     directories).

     *Note startfile(): 11bd. returns as soon as the associated
     application is launched.  There is no option to wait for the
     application to close, and no way to retrieve the application’s
     exit status.  The `path' parameter is relative to the current
     directory.  If you want to use an absolute path, make sure the
     first character is not a slash (`'/''); the underlying Win32
     `ShellExecute()' function doesn’t work if it is.  Use the *Note
     os.path.normpath(): 245. function to ensure that the path is
     properly encoded for Win32.

     Availability: Windows.

     New in version 2.0.

     New in version 2.5: The `operation' parameter.


 -- Function: os.system (command)
     Execute the command (a string) in a subshell.  This is implemented
     by calling the Standard C function `system()', and has the same
     limitations.  Changes to *Note sys.stdin: 65c, etc. are not
     reflected in the environment of the executed command.

     On Unix, the return value is the exit status of the process
     encoded in the format specified for *Note wait(): 1134.  Note that
     POSIX does not specify the meaning of the return value of the C
     `system()' function, so the return value of the Python function is
     system-dependent.

     On Windows, the return value is that returned by the system shell
     after running `command', given by the Windows environment variable `COMSPEC':
     on `command.com' systems (Windows 95, 98 and ME) this is always
     `0'; on `cmd.exe' systems (Windows NT, 2000 and XP) this is the
     exit status of the command run; on systems using a non-native
     shell, consult your shell documentation.

     The *Note subprocess: 167. module provides more powerful
     facilities for spawning new processes and retrieving their
     results; using that module is preferable to using this function.
     See the *Note Replacing Older Functions with the subprocess
     Module: 1135. section in the *Note subprocess: 167. documentation
     for some helpful recipes.

     Availability: Unix, Windows.

 -- Function: os.times ()
     Return a 5-tuple of floating point numbers indicating accumulated
     (processor or other) times, in seconds.  The items are: user time,
     system time, children’s user time, children’s system time, and
     elapsed real time since a fixed point in the past, in that order.
     See the Unix manual page `times(2)' or the corresponding Windows
     Platform API documentation.  On Windows, only the first two items
     are filled, the others are zero.

     Availability: Unix, Windows

 -- Function: os.wait ()
     Wait for completion of a child process, and return a tuple
     containing its pid and exit status indication: a 16-bit number,
     whose low byte is the signal number that killed the process, and
     whose high byte is the exit status (if the signal number is zero);
     the high bit of the low byte is set if a core file was produced.

     Availability: Unix.

 -- Function: os.waitpid (pid, options)
     The details of this function differ on Unix and Windows.

     On Unix: Wait for completion of a child process given by process
     id `pid', and return a tuple containing its process id and exit
     status indication (encoded as for *Note wait(): 1134.).  The
     semantics of the call are affected by the value of the integer
     `options', which should be `0' for normal operation.

     If `pid' is greater than `0', *Note waitpid(): 11b9. requests
     status information for that specific process.  If `pid' is `0',
     the request is for the status of any child in the process group of
     the current process.  If `pid' is `-1', the request pertains to
     any child of the current process.  If `pid' is less than `-1',
     status is requested for any process in the process group `-pid'
     (the absolute value of `pid').

     An *Note OSError: 231. is raised with the value of errno when the
     syscall returns -1.

     On Windows: Wait for completion of a process given by process
     handle `pid', and return a tuple containing `pid', and its exit
     status shifted left by 8 bits (shifting makes cross-platform use
     of the function easier). A `pid' less than or equal to `0' has no
     special meaning on Windows, and raises an exception. The value of
     integer `options' has no effect. `pid' can refer to any process
     whose id is known, not necessarily a child process. The *Note
     spawn*: 11b0.  functions called with *Note P_NOWAIT: 11b7. return
     suitable process handles.

 -- Function: os.wait3 (options)
     Similar to *Note waitpid(): 11b9, except no process id argument is
     given and a 3-element tuple containing the child’s process id,
     exit status indication, and resource usage information is
     returned.  Refer to *Note resource: 146.*Note getrusage(): 3e5.
     for details on resource usage information.  The option argument is
     the same as that provided to *Note waitpid(): 11b9. and *Note
     wait4(): 11c0.

     Availability: Unix.

     New in version 2.5.


 -- Function: os.wait4 (pid, options)
     Similar to *Note waitpid(): 11b9, except a 3-element tuple,
     containing the child’s process id, exit status indication, and
     resource usage information is returned.  Refer to *Note resource:
     146.*Note getrusage(): 3e5. for details on resource usage
     information.  The arguments to *Note wait4(): 11c0. are the same as
     those provided to *Note waitpid(): 11b9.

     Availability: Unix.

     New in version 2.5.


 -- Data: os.WNOHANG
     The option for *Note waitpid(): 11b9. to return immediately if no
     child process status is available immediately. The function
     returns `(0, 0)' in this case.

     Availability: Unix.

 -- Data: os.WCONTINUED
     This option causes child processes to be reported if they have
     been continued from a job control stop since their status was last
     reported.

     Availability: Some Unix systems.

     New in version 2.3.


 -- Data: os.WUNTRACED
     This option causes child processes to be reported if they have
     been stopped but their current state has not been reported since
     they were stopped.

     Availability: Unix.

     New in version 2.3.


The following functions take a process status code as returned by *Note
system(): 413, *Note wait(): 1134, or *Note waitpid(): 11b9. as a
parameter.  They may be used to determine the disposition of a process.

 -- Function: os.WCOREDUMP (status)
     Return `True' if a core dump was generated for the process,
     otherwise return `False'.

     Availability: Unix.

     New in version 2.3.


 -- Function: os.WIFCONTINUED (status)
     Return `True' if the process has been continued from a job control
     stop, otherwise return `False'.

     Availability: Unix.

     New in version 2.3.


 -- Function: os.WIFSTOPPED (status)
     Return `True' if the process has been stopped, otherwise return
     `False'.

     Availability: Unix.

 -- Function: os.WIFSIGNALED (status)
     Return `True' if the process exited due to a signal, otherwise
     return `False'.

     Availability: Unix.

 -- Function: os.WIFEXITED (status)
     Return `True' if the process exited using the `exit(2)' system
     call, otherwise return `False'.

     Availability: Unix.

 -- Function: os.WEXITSTATUS (status)
     If `WIFEXITED(status)' is true, return the integer parameter to the
     `exit(2)' system call.  Otherwise, the return value is meaningless.

     Availability: Unix.

 -- Function: os.WSTOPSIG (status)
     Return the signal which caused the process to stop.

     Availability: Unix.

 -- Function: os.WTERMSIG (status)
     Return the signal which caused the process to exit.

     Availability: Unix.


File: python.info,  Node: Miscellaneous System Information,  Next: Miscellaneous Functions,  Prev: Process Management,  Up: os — Miscellaneous operating system interfaces

5.15.1.7 Miscellaneous System Information
.........................................

 -- Function: os.confstr (name)
     Return string-valued system configuration values. `name' specifies
     the configuration value to retrieve; it may be a string which is
     the name of a defined system value; these names are specified in a
     number of standards (POSIX, Unix 95, Unix 98, and others).  Some
     platforms define additional names as well.  The names known to the
     host operating system are given as the keys of the `confstr_names'
     dictionary.  For configuration variables not included in that
     mapping, passing an integer for `name' is also accepted.

     If the configuration value specified by `name' isn’t defined,
     `None' is returned.

     If `name' is a string and is not known, *Note ValueError: 236. is
     raised.  If a specific value for `name' is not supported by the
     host system, even if it is included in `confstr_names', an *Note
     OSError: 231. is raised with *Note errno.EINVAL: 1148. for the
     error number.

     Availability: Unix

 -- Data: os.confstr_names
     Dictionary mapping names accepted by *Note confstr(): 11ce. to the
     integer values defined for those names by the host operating
     system. This can be used to determine the set of names known to
     the system.

     Availability: Unix.

 -- Function: os.getloadavg ()
     Return the number of processes in the system run queue averaged
     over the last 1, 5, and 15 minutes or raises *Note OSError: 231.
     if the load average was unobtainable.

     Availability: Unix.

     New in version 2.3.


 -- Function: os.sysconf (name)
     Return integer-valued system configuration values. If the
     configuration value specified by `name' isn’t defined, `-1' is
     returned.  The comments regarding the `name' parameter for *Note
     confstr(): 11ce. apply here as well; the dictionary that provides
     information on the known names is given by `sysconf_names'.

     Availability: Unix.

 -- Data: os.sysconf_names
     Dictionary mapping names accepted by *Note sysconf(): 11d1. to the
     integer values defined for those names by the host operating
     system. This can be used to determine the set of names known to
     the system.

     Availability: Unix.

The following data values are used to support path manipulation
operations.  These are defined for all platforms.

Higher-level operations on pathnames are defined in the *Note os.path:
12a. module.

 -- Data: os.curdir
     The constant string used by the operating system to refer to the
     current directory. This is `'.'' for Windows and POSIX. Also
     available via *Note os.path: 12a.

 -- Data: os.pardir
     The constant string used by the operating system to refer to the
     parent directory. This is `'..'' for Windows and POSIX. Also
     available via *Note os.path: 12a.

 -- Data: os.sep
     The character used by the operating system to separate pathname
     components.  This is `'/'' for POSIX and `'\\'' for Windows.  Note
     that knowing this is not sufficient to be able to parse or
     concatenate pathnames — use *Note os.path.split(): e23. and
     *Note os.path.join(): e32. — but it is occasionally useful. Also
     available via *Note os.path: 12a.

 -- Data: os.altsep
     An alternative character used by the operating system to separate
     pathname components, or `None' if only one separator character
     exists.  This is set to `'/'' on Windows systems where `sep' is a
     backslash. Also available via *Note os.path: 12a.

 -- Data: os.extsep
     The character which separates the base filename from the
     extension; for example, the `'.'' in `os.py'. Also available via
     *Note os.path: 12a.

     New in version 2.2.


 -- Data: os.pathsep
     The character conventionally used by the operating system to
     separate search path components (as in `PATH'), such as `':'' for
     POSIX or `';'' for Windows. Also available via *Note os.path: 12a.

 -- Data: os.defpath
     The default search path used by *Note exec*p*: 1191. and *Note
     spawn*p*: 11b0. if the environment doesn’t have a `'PATH'' key.
     Also available via *Note os.path: 12a.

 -- Data: os.linesep
     The string used to separate (or, rather, terminate) lines on the
     current platform.  This may be a single character, such as `'\n''
     for POSIX, or multiple characters, for example, `'\r\n'' for
     Windows. Do not use `os.linesep' as a line terminator when writing
     files opened in text mode (the default); use a single `'\n''
     instead, on all platforms.

 -- Data: os.devnull
     The file path of the null device. For example: `'/dev/null'' for
     POSIX, `'nul'' for Windows.  Also available via *Note os.path: 12a.

     New in version 2.4.



File: python.info,  Node: Miscellaneous Functions,  Prev: Miscellaneous System Information,  Up: os — Miscellaneous operating system interfaces

5.15.1.8 Miscellaneous Functions
................................

 -- Function: os.urandom (n)
     Return a string of `n' random bytes suitable for cryptographic use.

     This function returns random bytes from an OS-specific randomness
     source.  The returned data should be unpredictable enough for
     cryptographic applications, though its exact quality depends on
     the OS implementation.  On a UNIX-like system this will query
     `/dev/urandom', and on Windows it will use `CryptGenRandom()'.  If
     a randomness source is not found, *Note NotImplementedError: 978.
     will be raised.

     For an easy-to-use interface to the random number generator
     provided by your platform, please see *Note random.SystemRandom:
     d77.

     New in version 2.4.



File: python.info,  Node: io — Core tools for working with streams,  Next: time — Time access and conversions,  Prev: os — Miscellaneous operating system interfaces,  Up: Generic Operating System Services

5.15.2 `io' — Core tools for working with streams
---------------------------------------------------

New in version 2.6.

The *Note io: fa. module provides the Python interfaces to stream
handling.  Under Python 2.x, this is proposed as an alternative to the
built-in *Note file: 1f9. object, but in Python 3.x it is the default
interface to access files and streams.

     Note: Since this module has been designed primarily for Python
     3.x, you have to be aware that all uses of “bytes” in this
     document refer to the *Note str: 1ea. type (of which `bytes' is an
     alias), and all uses of “text” refer to the *Note unicode:
     1f5. type.  Furthermore, those two types are not interchangeable
     in the *Note io: fa. APIs.

At the top of the I/O hierarchy is the abstract base class *Note
IOBase: 11dd.  It defines the basic interface to a stream.  Note,
however, that there is no separation between reading and writing to
streams; implementations are allowed to raise an *Note IOError: 1fa. if
they do not support a given operation.

Extending *Note IOBase: 11dd. is *Note RawIOBase: 11de. which deals
simply with the reading and writing of raw bytes to a stream.  *Note
FileIO: 230. subclasses *Note RawIOBase: 11de. to provide an interface
to files in the machine’s file system.

*Note BufferedIOBase: 228. deals with buffering on a raw byte stream
(*Note RawIOBase: 11de.).  Its subclasses, *Note BufferedWriter: 11df,
*Note BufferedReader: 229, and *Note BufferedRWPair: 11e0. buffer
streams that are readable, writable, and both readable and writable.
*Note BufferedRandom: 11e1. provides a buffered interface to random
access streams.  *Note BytesIO: 11e2. is a simple stream of in-memory
bytes.

Another *Note IOBase: 11dd. subclass, *Note TextIOBase: 22f, deals with
streams whose bytes represent text, and handles encoding and decoding
from and to *Note unicode: 1f5. strings.  *Note TextIOWrapper: 11e3,
which extends it, is a buffered text interface to a buffered raw stream
(*Note BufferedIOBase: 228.). Finally, *Note StringIO: 32b. is an
in-memory stream for unicode text.

Argument names are not part of the specification, and only the
arguments of *Note open(): e4c. are intended to be used as keyword
arguments.

* Menu:

* Module Interface::
* I/O Base Classes::
* Raw File I/O::
* Buffered Streams::
* Text I/O::
* Advanced topics::


File: python.info,  Node: Module Interface,  Next: I/O Base Classes,  Up: io — Core tools for working with streams

5.15.2.1 Module Interface
.........................

 -- Data: io.DEFAULT_BUFFER_SIZE
     An int containing the default buffer size used by the module’s
     buffered I/O classes.  *Note open(): e4c. uses the file’s
     blksize (as obtained by *Note os.stat(): 3de.) if possible.

 -- Function: io.open (file, mode='r', buffering=-1, encoding=None,
          errors=None, newline=None, closefd=True)
     Open `file' and return a corresponding stream.  If the file cannot
     be opened, an *Note IOError: 1fa. is raised.

     `file' is either a string giving the pathname (absolute or
     relative to the current working directory) of the file to be
     opened or an integer file descriptor of the file to be wrapped.
     (If a file descriptor is given, it is closed when the returned I/O
     object is closed, unless `closefd' is set to `False'.)

     `mode' is an optional string that specifies the mode in which the
     file is opened.  It defaults to `'r'' which means open for reading
     in text mode.  Other common values are `'w'' for writing
     (truncating the file if it already exists), and `'a'' for
     appending (which on `some' Unix systems, means that `all' writes
     append to the end of the file regardless of the current seek
     position).  In text mode, if `encoding' is not specified the
     encoding used is platform dependent. (For reading and writing raw
     bytes use binary mode and leave `encoding' unspecified.)  The
     available modes are:

     Character     Meaning
     `'r''         open for reading (default)
     `'w''         open for writing, truncating the file first
     `'a''         open for writing, appending to the end of the file if it exists
     `'b''         binary mode
     `'t''         text mode (default)
     `'+''         open a disk file for updating (reading and writing)
     `'U''         universal newlines mode (for backwards compatibility; should not
                   be used in new code)

     The default mode is `'rt'' (open for reading text).  For binary
     random access, the mode `'w+b'' opens and truncates the file to 0
     bytes, while `'r+b'' opens the file without truncation.

     Python distinguishes between files opened in binary and text
     modes, even when the underlying operating system doesn’t.  Files
     opened in binary mode (including `'b'' in the `mode' argument)
     return contents as `bytes' objects without any decoding.  In text
     mode (the default, or when `'t'' is included in the `mode'
     argument), the contents of the file are returned as *Note unicode:
     1f5. strings, the bytes having been first decoded using a
     platform-dependent encoding or using the specified `encoding' if
     given.

     `buffering' is an optional integer used to set the buffering
     policy.  Pass 0 to switch buffering off (only allowed in binary
     mode), 1 to select line buffering (only usable in text mode), and
     an integer > 1 to indicate the size of a fixed-size chunk buffer.
     When no `buffering' argument is given, the default buffering
     policy works as follows:

        * Binary files are buffered in fixed-size chunks; the size of
          the buffer is chosen using a heuristic trying to determine
          the underlying device’s “block size” and falling back
          on *Note DEFAULT_BUFFER_SIZE: 11e5.  On many systems, the
          buffer will typically be 4096 or 8192 bytes long.

        * “Interactive” text files (files for which `isatty()'
          returns True) use line buffering.  Other text files use the
          policy described above for binary files.

     `encoding' is the name of the encoding used to decode or encode
     the file.  This should only be used in text mode.  The default
     encoding is platform dependent (whatever *Note
     locale.getpreferredencoding(): 11e6. returns), but any encoding
     supported by Python can be used.  See the *Note codecs: 63. module
     for the list of supported encodings.

     `errors' is an optional string that specifies how encoding and
     decoding errors are to be handled—this cannot be used in binary
     mode.  Pass `'strict'' to raise a *Note ValueError: 236. exception
     if there is an encoding error (the default of `None' has the same
     effect), or pass `'ignore'' to ignore errors.  (Note that ignoring
     encoding errors can lead to data loss.)  `'replace'' causes a
     replacement marker (such as `'?'') to be inserted where there is
     malformed data.  When writing, `'xmlcharrefreplace'' (replace with
     the appropriate XML character reference) or `'backslashreplace''
     (replace with backslashed escape sequences) can be used.  Any
     other error handling name that has been registered with *Note
     codecs.register_error(): 457. is also valid.

     `newline' controls how *Note universal newlines: 329. works (it
     only applies to text mode).  It can be `None', `''', `'\n'',
     `'\r'', and `'\r\n''.  It works as follows:

        * On input, if `newline' is `None', universal newlines mode is
          enabled.  Lines in the input can end in `'\n'', `'\r'', or
          `'\r\n'', and these are translated into `'\n'' before being
          returned to the caller.  If it is `''', universal newlines
          mode is enabled, but line endings are returned to the caller
          untranslated.  If it has any of the other legal values, input
          lines are only terminated by the given string, and the line
          ending is returned to the caller untranslated.

        * On output, if `newline' is `None', any `'\n'' characters
          written are translated to the system default line separator,
          *Note os.linesep: 11d7.  If `newline' is `''', no translation
          takes place.  If `newline' is any of the other legal values,
          any `'\n'' characters written are translated to the given
          string.

     If `closefd' is `False' and a file descriptor rather than a
     filename was given, the underlying file descriptor will be kept
     open when the file is closed.  If a filename is given `closefd'
     has no effect and must be `True' (the default).

     The type of file object returned by the *Note open(): e4c.
     function depends on the mode.  When *Note open(): e4c. is used to
     open a file in a text mode (`'w'', `'r'', `'wt'', `'rt'', etc.),
     it returns a subclass of *Note TextIOBase: 22f. (specifically
     *Note TextIOWrapper: 11e3.).  When used to open a file in a binary
     mode with buffering, the returned class is a subclass of *Note
     BufferedIOBase: 228.  The exact class varies: in read binary mode,
     it returns a *Note BufferedReader: 229.; in write binary and
     append binary modes, it returns a *Note BufferedWriter: 11df, and
     in read/write mode, it returns a *Note BufferedRandom: 11e1.  When
     buffering is disabled, the raw stream, a subclass of *Note
     RawIOBase: 11de, *Note FileIO: 230, is returned.

     It is also possible to use an *Note unicode: 1f5. or `bytes' string
     as a file for both reading and writing.  For *Note unicode: 1f5.
     strings *Note StringIO: 32b. can be used like a file opened in
     text mode, and for `bytes' a *Note BytesIO: 11e2. can be used like
     a file opened in a binary mode.

 -- Exception: io.BlockingIOError
     Error raised when blocking would occur on a non-blocking stream.
     It inherits *Note IOError: 1fa.

     In addition to those of *Note IOError: 1fa, *Note BlockingIOError:
     11e7. has one attribute:

      -- Attribute: characters_written
          An integer containing the number of characters written to the
          stream before it blocked.

 -- Exception: io.UnsupportedOperation
     An exception inheriting *Note IOError: 1fa. and *Note ValueError:
     236. that is raised when an unsupported operation is called on a
     stream.


File: python.info,  Node: I/O Base Classes,  Next: Raw File I/O,  Prev: Module Interface,  Up: io — Core tools for working with streams

5.15.2.2 I/O Base Classes
.........................

 -- Class: io.IOBase
     The abstract base class for all I/O classes, acting on streams of
     bytes.  There is no public constructor.

     This class provides empty abstract implementations for many methods
     that derived classes can override selectively; the default
     implementations represent a file that cannot be read, written or
     seeked.

     Even though *Note IOBase: 11dd. does not declare `read()',
     `readinto()', or `write()' because their signatures will vary,
     implementations and clients should consider those methods part of
     the interface.  Also, implementations may raise an *Note IOError:
     1fa. when operations they do not support are called.

     The basic type used for binary data read from or written to a file
     is `bytes' (also known as *Note str: 1ea.).  Method arguments may
     also be *Note bytearray: 1f7. or *Note memoryview: 1c4. of arrays
     of bytes.  In some cases, such as *Note readinto(): 11eb, a
     writable object such as *Note bytearray: 1f7. is required.  Text
     I/O classes work with *Note unicode: 1f5. data.

     Changed in version 2.7: Implementations should support *Note
     memoryview: 1c4. arguments.

     Note that calling any method (even inquiries) on a closed stream is
     undefined.  Implementations may raise *Note IOError: 1fa. in this
     case.

     IOBase (and its subclasses) support the iterator protocol, meaning
     that an *Note IOBase: 11dd. object can be iterated over yielding
     the lines in a stream.  Lines are defined slightly differently
     depending on whether the stream is a binary stream (yielding
     `bytes'), or a text stream (yielding *Note unicode: 1f5. strings).
     See *Note readline(): 11ec. below.

     IOBase is also a context manager and therefore supports the *Note
     with: 1c1. statement.  In this example, `file' is closed after the
     *Note with: 1c1. statement’s suite is finished—even if an
     exception occurs:

         with io.open('spam.txt', 'w') as file:
             file.write(u'Spam and eggs!')

     *Note IOBase: 11dd. provides these data attributes and methods:

      -- Method: close ()
          Flush and close this stream. This method has no effect if the
          file is already closed. Once the file is closed, any
          operation on the file (e.g. reading or writing) will raise a
          *Note ValueError: 236.

          As a convenience, it is allowed to call this method more than
          once; only the first call, however, will have an effect.

      -- Attribute: closed
          True if the stream is closed.

      -- Method: fileno ()
          Return the underlying file descriptor (an integer) of the
          stream if it exists.  An *Note IOError: 1fa. is raised if the
          IO object does not use a file descriptor.

      -- Method: flush ()
          Flush the write buffers of the stream if applicable.  This
          does nothing for read-only and non-blocking streams.

      -- Method: isatty ()
          Return `True' if the stream is interactive (i.e., connected to
          a terminal/tty device).

      -- Method: readable ()
          Return `True' if the stream can be read from.  If `False',
          `read()' will raise *Note IOError: 1fa.

      -- Method: readline (limit=-1)
          Read and return one line from the stream.  If `limit' is
          specified, at most `limit' bytes will be read.

          The line terminator is always `b'\n'' for binary files; for
          text files, the `newline' argument to *Note open(): e4c. can
          be used to select the line terminator(s) recognized.

      -- Method: readlines (hint=-1)
          Read and return a list of lines from the stream.  `hint' can
          be specified to control the number of lines read: no more
          lines will be read if the total size (in bytes/characters) of
          all lines so far exceeds `hint'.

          Note that it’s already possible to iterate on file objects
          using `for line in file: ...' without calling
          `file.readlines()'.

      -- Method: seek (offset[, whence])
          Change the stream position to the given byte `offset'.
          `offset' is interpreted relative to the position indicated by
          `whence'.  The default value for `whence' is `SEEK_SET'.
          Values for `whence' are:

             * `SEEK_SET' or `0' – start of the stream (the default);
               `offset' should be zero or positive

             * `SEEK_CUR' or `1' – current stream position; `offset'
               may be negative

             * `SEEK_END' or `2' – end of the stream; `offset' is
               usually negative

          Return the new absolute position.

          New in version 2.7: The `SEEK_*' constants


      -- Method: seekable ()
          Return `True' if the stream supports random access.  If
          `False', *Note seek(): 11f3, *Note tell(): 11f5. and *Note
          truncate(): 232. will raise *Note IOError: 1fa.

      -- Method: tell ()
          Return the current stream position.

      -- Method: truncate (size=None)
          Resize the stream to the given `size' in bytes (or the
          current position if `size' is not specified).  The current
          stream position isn’t changed.  This resizing can extend or
          reduce the current file size.  In case of extension, the
          contents of the new file area depend on the platform (on most
          systems, additional bytes are zero-filled, on Windows
          they’re undetermined).  The new file size is returned.

      -- Method: writable ()
          Return `True' if the stream supports writing.  If `False',
          `write()' and *Note truncate(): 232. will raise *Note
          IOError: 1fa.

      -- Method: writelines (lines)
          Write a list of lines to the stream.  Line separators are not
          added, so it is usual for each of the lines provided to have
          a line separator at the end.

      -- Method: __del__ ()
          Prepare for object destruction. *Note IOBase: 11dd. provides
          a default implementation of this method that calls the
          instance’s *Note close(): 1140. method.

 -- Class: io.RawIOBase
     Base class for raw binary I/O.  It inherits *Note IOBase: 11dd.
     There is no public constructor.

     Raw binary I/O typically provides low-level access to an
     underlying OS device or API, and does not try to encapsulate it in
     high-level primitives (this is left to Buffered I/O and Text I/O,
     described later in this page).

     In addition to the attributes and methods from *Note IOBase: 11dd,
     RawIOBase provides the following methods:

      -- Method: read (n=-1)
          Read up to `n' bytes from the object and return them.  As a
          convenience, if `n' is unspecified or -1, *Note readall():
          11fa. is called.  Otherwise, only one system call is ever
          made.  Fewer than `n' bytes may be returned if the operating
          system call returns fewer than `n' bytes.

          If 0 bytes are returned, and `n' was not 0, this indicates
          end of file.  If the object is in non-blocking mode and no
          bytes are available, `None' is returned.

      -- Method: readall ()
          Read and return all the bytes from the stream until EOF,
          using multiple calls to the stream if necessary.

      -- Method: readinto (b)
          Read up to len(b) bytes into `b', and return the number of
          bytes read.  The object `b' should be a pre-allocated,
          writable array of bytes, either *Note bytearray: 1f7. or
          *Note memoryview: 1c4.  If the object is in non-blocking mode
          and no bytes are available, `None' is returned.

      -- Method: write (b)
          Write `b' to the underlying raw stream, and return the number
          of bytes written.  The object `b' should be an array of
          bytes, either `bytes', *Note bytearray: 1f7, or *Note
          memoryview: 1c4.  The return value can be less than `len(b)',
          depending on specifics of the underlying raw stream, and
          especially if it is in non-blocking mode.  `None' is returned
          if the raw stream is set not to block and no single byte
          could be readily written to it.  The caller may release or
          mutate `b' after this method returns, so the implementation
          should only access `b' during the method call.

 -- Class: io.BufferedIOBase
     Base class for binary streams that support some kind of buffering.
     It inherits *Note IOBase: 11dd. There is no public constructor.

     The main difference with *Note RawIOBase: 11de. is that methods
     *Note read(): 11fc, *Note readinto(): 11fd. and *Note write():
     11fe. will try (respectively) to read as much input as requested
     or to consume all given output, at the expense of making perhaps
     more than one system call.

     In addition, those methods can raise *Note BlockingIOError: 11e7.
     if the underlying raw stream is in non-blocking mode and cannot
     take or give enough data; unlike their *Note RawIOBase: 11de.
     counterparts, they will never return `None'.

     Besides, the *Note read(): 11fc. method does not have a default
     implementation that defers to *Note readinto(): 11fd.

     A typical *Note BufferedIOBase: 228. implementation should not
     inherit from a *Note RawIOBase: 11de. implementation, but wrap
     one, like *Note BufferedWriter: 11df. and *Note BufferedReader:
     229. do.

     *Note BufferedIOBase: 228. provides or overrides these methods and
     attribute in addition to those from *Note IOBase: 11dd.:

      -- Attribute: raw
          The underlying raw stream (a *Note RawIOBase: 11de. instance)
          that *Note BufferedIOBase: 228. deals with.  This is not part
          of the *Note BufferedIOBase: 228. API and may not exist on
          some implementations.

      -- Method: detach ()
          Separate the underlying raw stream from the buffer and return
          it.

          After the raw stream has been detached, the buffer is in an
          unusable state.

          Some buffers, like *Note BytesIO: 11e2, do not have the
          concept of a single raw stream to return from this method.
          They raise *Note UnsupportedOperation: 11e9.

          New in version 2.7.


      -- Method: read (n=-1)
          Read and return up to `n' bytes.  If the argument is omitted,
          `None', or negative, data is read and returned until EOF is
          reached.  An empty bytes object is returned if the stream is
          already at EOF.

          If the argument is positive, and the underlying raw stream is
          not interactive, multiple raw reads may be issued to satisfy
          the byte count (unless EOF is reached first).  But for
          interactive raw streams, at most one raw read will be issued,
          and a short result does not imply that EOF is imminent.

          A *Note BlockingIOError: 11e7. is raised if the underlying
          raw stream is in non blocking-mode, and has no data available
          at the moment.

      -- Method: read1 (n=-1)
          Read and return up to `n' bytes, with at most one call to the
          underlying raw stream’s *Note read(): 11f9. method.  This
          can be useful if you are implementing your own buffering on
          top of a *Note BufferedIOBase: 228.  object.

      -- Method: readinto (b)
          Read up to len(b) bytes into `b', and return the number of
          bytes read.  The object `b' should be a pre-allocated,
          writable array of bytes, either *Note bytearray: 1f7. or
          *Note memoryview: 1c4.

          Like *Note read(): 11fc, multiple reads may be issued to the
          underlying raw stream, unless the latter is ‘interactive’.

          A *Note BlockingIOError: 11e7. is raised if the underlying
          raw stream is in non blocking-mode, and has no data available
          at the moment.

      -- Method: write (b)
          Write `b', and return the number of bytes written (always
          equal to `len(b)', since if the write fails an *Note IOError:
          1fa. will be raised).  The object `b' should be an array of
          bytes, either `bytes', *Note bytearray: 1f7, or *Note
          memoryview: 1c4.  Depending on the actual implementation,
          these bytes may be readily written to the underlying stream,
          or held in a buffer for performance and latency reasons.

          When in non-blocking mode, a *Note BlockingIOError: 11e7. is
          raised if the data needed to be written to the raw stream but
          it couldn’t accept all the data without blocking.

          The caller may release or mutate `b' after this method
          returns, so the implementation should only access `b' during
          the method call.


File: python.info,  Node: Raw File I/O,  Next: Buffered Streams,  Prev: I/O Base Classes,  Up: io — Core tools for working with streams

5.15.2.3 Raw File I/O
.....................

 -- Class: io.FileIO (name, mode='r', closefd=True)
     *Note FileIO: 230. represents an OS-level file containing bytes
     data.  It implements the *Note RawIOBase: 11de. interface (and
     therefore the *Note IOBase: 11dd. interface, too).

     The `name' can be one of two things:

        * a string representing the path to the file which will be
          opened;

        * an integer representing the number of an existing OS-level
          file descriptor to which the resulting *Note FileIO: 230.
          object will give access.

     The `mode' can be `'r'', `'w'' or `'a'' for reading (default),
     writing, or appending.  The file will be created if it doesn’t
     exist when opened for writing or appending; it will be truncated
     when opened for writing.  Add a `'+'' to the mode to allow
     simultaneous reading and writing.

     The `read()' (when called with a positive argument), `readinto()'
     and `write()' methods on this class will only make one system call.

     In addition to the attributes and methods from *Note IOBase: 11dd.
     and *Note RawIOBase: 11de, *Note FileIO: 230. provides the
     following data attributes and methods:

      -- Attribute: mode
          The mode as given in the constructor.

      -- Attribute: name
          The file name.  This is the file descriptor of the file when
          no name is given in the constructor.


File: python.info,  Node: Buffered Streams,  Next: Text I/O,  Prev: Raw File I/O,  Up: io — Core tools for working with streams

5.15.2.4 Buffered Streams
.........................

Buffered I/O streams provide a higher-level interface to an I/O device
than raw I/O does.

 -- Class: io.BytesIO ([initial_bytes])
     A stream implementation using an in-memory bytes buffer.  It
     inherits *Note BufferedIOBase: 228.

     The optional argument `initial_bytes' is a `bytes' object that
     contains initial data.

     *Note BytesIO: 11e2. provides or overrides these methods in
     addition to those from *Note BufferedIOBase: 228. and *Note
     IOBase: 11dd.:

      -- Method: getvalue ()
          Return `bytes' containing the entire contents of the buffer.

      -- Method: read1 ()
          In *Note BytesIO: 11e2, this is the same as `read()'.

 -- Class: io.BufferedReader (raw, buffer_size=DEFAULT_BUFFER_SIZE)
     A buffer providing higher-level access to a readable, sequential
     *Note RawIOBase: 11de. object.  It inherits *Note BufferedIOBase:
     228.  When reading data from this object, a larger amount of data
     may be requested from the underlying raw stream, and kept in an
     internal buffer.  The buffered data can then be returned directly
     on subsequent reads.

     The constructor creates a *Note BufferedReader: 229. for the given
     readable `raw' stream and `buffer_size'.  If `buffer_size' is
     omitted, *Note DEFAULT_BUFFER_SIZE: 11e5. is used.

     *Note BufferedReader: 229. provides or overrides these methods in
     addition to those from *Note BufferedIOBase: 228. and *Note
     IOBase: 11dd.:

      -- Method: peek ([n])
          Return bytes from the stream without advancing the position.
          At most one single read on the raw stream is done to satisfy
          the call. The number of bytes returned may be less or more
          than requested.

      -- Method: read ([n])
          Read and return `n' bytes, or if `n' is not given or
          negative, until EOF or if the read call would block in
          non-blocking mode.

      -- Method: read1 (n)
          Read and return up to `n' bytes with only one call on the raw
          stream.  If at least one byte is buffered, only buffered
          bytes are returned.  Otherwise, one raw stream read call is
          made.

 -- Class: io.BufferedWriter (raw, buffer_size=DEFAULT_BUFFER_SIZE)
     A buffer providing higher-level access to a writeable, sequential
     *Note RawIOBase: 11de. object.  It inherits *Note BufferedIOBase:
     228.  When writing to this object, data is normally held into an
     internal buffer.  The buffer will be written out to the underlying
     *Note RawIOBase: 11de.  object under various conditions, including:

        * when the buffer gets too small for all pending data;

        * when *Note flush(): 120b. is called;

        * when a `seek()' is requested (for *Note BufferedRandom: 11e1.
          objects);

        * when the *Note BufferedWriter: 11df. object is closed or
          destroyed.

     The constructor creates a *Note BufferedWriter: 11df. for the
     given writeable `raw' stream.  If the `buffer_size' is not given,
     it defaults to *Note DEFAULT_BUFFER_SIZE: 11e5.

     A third argument, `max_buffer_size', is supported, but unused and
     deprecated.

     *Note BufferedWriter: 11df. provides or overrides these methods in
     addition to those from *Note BufferedIOBase: 228. and *Note
     IOBase: 11dd.:

      -- Method: flush ()
          Force bytes held in the buffer into the raw stream.  A *Note
          BlockingIOError: 11e7. should be raised if the raw stream
          blocks.

      -- Method: write (b)
          Write `b', and return the number of bytes written.  The
          object `b' should be an array of bytes, either `bytes', *Note
          bytearray: 1f7, or *Note memoryview: 1c4.  When in
          non-blocking mode, a *Note BlockingIOError: 11e7. is raised
          if the buffer needs to be written out but the raw stream
          blocks.

 -- Class: io.BufferedRandom (raw, buffer_size=DEFAULT_BUFFER_SIZE)
     A buffered interface to random access streams.  It inherits *Note
     BufferedReader: 229. and *Note BufferedWriter: 11df, and further
     supports `seek()' and `tell()' functionality.

     The constructor creates a reader and writer for a seekable raw
     stream, given in the first argument.  If the `buffer_size' is
     omitted it defaults to *Note DEFAULT_BUFFER_SIZE: 11e5.

     A third argument, `max_buffer_size', is supported, but unused and
     deprecated.

     *Note BufferedRandom: 11e1. is capable of anything *Note
     BufferedReader: 229. or *Note BufferedWriter: 11df. can do.

 -- Class: io.BufferedRWPair (reader, writer,
          buffer_size=DEFAULT_BUFFER_SIZE)
     A buffered I/O object combining two unidirectional *Note
     RawIOBase: 11de.  objects – one readable, the other writeable
     – into a single bidirectional endpoint.  It inherits *Note
     BufferedIOBase: 228.

     `reader' and `writer' are *Note RawIOBase: 11de. objects that are
     readable and writeable respectively.  If the `buffer_size' is
     omitted it defaults to *Note DEFAULT_BUFFER_SIZE: 11e5.

     A fourth argument, `max_buffer_size', is supported, but unused and
     deprecated.

     *Note BufferedRWPair: 11e0. implements all of *Note
     BufferedIOBase: 228.’s methods except for *Note detach(): 1200,
     which raises *Note UnsupportedOperation: 11e9.

          Warning: *Note BufferedRWPair: 11e0. does not attempt to
          synchronize accesses to its underlying raw streams.  You
          should not pass it the same object as reader and writer; use
          *Note BufferedRandom: 11e1. instead.


File: python.info,  Node: Text I/O,  Next: Advanced topics,  Prev: Buffered Streams,  Up: io — Core tools for working with streams

5.15.2.5 Text I/O
.................

 -- Class: io.TextIOBase
     Base class for text streams.  This class provides a unicode
     character and line based interface to stream I/O.  There is no
     `readinto()' method because Python’s *Note unicode: 1f5. strings
     are immutable.  It inherits *Note IOBase: 11dd.  There is no
     public constructor.

     *Note TextIOBase: 22f. provides or overrides these data attributes
     and methods in addition to those from *Note IOBase: 11dd.:

      -- Attribute: encoding
          The name of the encoding used to decode the stream’s bytes
          into strings, and to encode strings into bytes.

      -- Attribute: errors
          The error setting of the decoder or encoder.

      -- Attribute: newlines
          A string, a tuple of strings, or `None', indicating the
          newlines translated so far.  Depending on the implementation
          and the initial constructor flags, this may not be available.

      -- Attribute: buffer
          The underlying binary buffer (a *Note BufferedIOBase: 228.
          instance) that *Note TextIOBase: 22f. deals with.  This is
          not part of the *Note TextIOBase: 22f. API and may not exist
          on some implementations.

      -- Method: detach ()
          Separate the underlying binary buffer from the *Note
          TextIOBase: 22f. and return it.

          After the underlying buffer has been detached, the *Note
          TextIOBase: 22f. is in an unusable state.

          Some *Note TextIOBase: 22f. implementations, like *Note
          StringIO: 32b, may not have the concept of an underlying
          buffer and calling this method will raise *Note
          UnsupportedOperation: 11e9.

          New in version 2.7.


      -- Method: read (n)
          Read and return at most `n' characters from the stream as a
          single *Note unicode: 1f5.  If `n' is negative or `None',
          reads until EOF.

      -- Method: readline (limit=-1)
          Read until newline or EOF and return a single `unicode'.  If
          the stream is already at EOF, an empty string is returned.

          If `limit' is specified, at most `limit' characters will be
          read.

      -- Method: seek (offset[, whence])
          Change the stream position to the given `offset'.  Behaviour
          depends on the `whence' parameter.  The default value for
          `whence' is `SEEK_SET'.

             * `SEEK_SET' or `0': seek from the start of the stream
               (the default); `offset' must either be a number returned
               by *Note TextIOBase.tell(): 1215, or zero.  Any other
               `offset' value produces undefined behaviour.

             * `SEEK_CUR' or `1': “seek” to the current position;
               `offset' must be zero, which is a no-operation (all
               other values are unsupported).

             * `SEEK_END' or `2': seek to the end of the stream;
               `offset' must be zero (all other values are unsupported).

          Return the new absolute position as an opaque number.

          New in version 2.7: The `SEEK_*' constants.


      -- Method: tell ()
          Return the current stream position as an opaque number.  The
          number does not usually represent a number of bytes in the
          underlying binary storage.

      -- Method: write (s)
          Write the *Note unicode: 1f5. string `s' to the stream and
          return the number of characters written.

 -- Class: io.TextIOWrapper (buffer, encoding=None, errors=None,
          newline=None, line_buffering=False)
     A buffered text stream over a *Note BufferedIOBase: 228. binary
     stream.  It inherits *Note TextIOBase: 22f.

     `encoding' gives the name of the encoding that the stream will be
     decoded or encoded with.  It defaults to *Note
     locale.getpreferredencoding(): 11e6.

     `errors' is an optional string that specifies how encoding and
     decoding errors are to be handled.  Pass `'strict'' to raise a
     *Note ValueError: 236.  exception if there is an encoding error
     (the default of `None' has the same effect), or pass `'ignore'' to
     ignore errors.  (Note that ignoring encoding errors can lead to
     data loss.)  `'replace'' causes a replacement marker (such as
     `'?'') to be inserted where there is malformed data.  When
     writing, `'xmlcharrefreplace'' (replace with the appropriate XML
     character reference) or `'backslashreplace'' (replace with
     backslashed escape sequences) can be used.  Any other error
     handling name that has been registered with *Note
     codecs.register_error(): 457. is also valid.

     `newline' controls how line endings are handled.  It can be `None',
     `''', `'\n'', `'\r'', and `'\r\n''.  It works as follows:

        * On input, if `newline' is `None', *Note universal newlines:
          329. mode is enabled.  Lines in the input can end in `'\n'',
          `'\r'', or `'\r\n'', and these are translated into `'\n''
          before being returned to the caller.  If it is `''',
          universal newlines mode is enabled, but line endings are
          returned to the caller untranslated.  If it has any of the
          other legal values, input lines are only terminated by the
          given string, and the line ending is returned to the caller
          untranslated.

        * On output, if `newline' is `None', any `'\n'' characters
          written are translated to the system default line separator,
          *Note os.linesep: 11d7.  If `newline' is `''', no translation
          takes place.  If `newline' is any of the other legal values,
          any `'\n'' characters written are translated to the given
          string.

     If `line_buffering' is `True', `flush()' is implied when a call to
     write contains a newline character.

     *Note TextIOWrapper: 11e3. provides one attribute in addition to
     those of *Note TextIOBase: 22f. and its parents:

      -- Attribute: line_buffering
          Whether line buffering is enabled.

 -- Class: io.StringIO (initial_value=u'', newline=u'\n')
     An in-memory stream for unicode text.  It inherits *Note
     TextIOWrapper: 11e3.

     The initial value of the buffer can be set by providing
     `initial_value'.  If newline translation is enabled, newlines will
     be encoded as if by *Note write(): 1216.  The stream is positioned
     at the start of the buffer.

     The `newline' argument works like that of *Note TextIOWrapper:
     11e3.  The default is to consider only `\n' characters as ends of
     lines and to do no newline translation.  If `newline' is set to
     `None', newlines are written as `\n' on all platforms, but
     universal newline decoding is still performed when reading.

     *Note StringIO: 32b. provides this method in addition to those from
     *Note TextIOWrapper: 11e3. and its parents:

      -- Method: getvalue ()
          Return a `unicode' containing the entire contents of the
          buffer at any time before the *Note StringIO: 32b. object’s
          `close()' method is called.  Newlines are decoded as if by
          *Note read(): 1213, although the stream position is not
          changed.

     Example usage:

         import io

         output = io.StringIO()
         output.write(u'First line.\n')
         output.write(u'Second line.\n')

         # Retrieve file contents -- this will be
         # u'First line.\nSecond line.\n'
         contents = output.getvalue()

         # Close object and discard memory buffer --
         # .getvalue() will now raise an exception.
         output.close()

 -- Class: io.IncrementalNewlineDecoder
     A helper codec that decodes newlines for *Note universal newlines:
     329. mode.  It inherits *Note codecs.IncrementalDecoder: a7a.


File: python.info,  Node: Advanced topics,  Prev: Text I/O,  Up: io — Core tools for working with streams

5.15.2.6 Advanced topics
........................

Here we will discuss several advanced topics pertaining to the concrete
I/O implementations described above.

* Menu:

* Performance::
* Multi-threading: Multi-threading<2>.
* Reentrancy::


File: python.info,  Node: Performance,  Next: Multi-threading<2>,  Up: Advanced topics

5.15.2.7 Performance
....................

* Menu:

* Binary I/O::
* Text I/O: Text I/O<2>.


File: python.info,  Node: Binary I/O,  Next: Text I/O<2>,  Up: Performance

5.15.2.8 Binary I/O
...................

By reading and writing only large chunks of data even when the user asks
for a single byte, buffered I/O is designed to hide any inefficiency in
calling and executing the operating system’s unbuffered I/O routines.
The gain will vary very much depending on the OS and the kind of I/O
which is performed (for example, on some contemporary OSes such as
Linux, unbuffered disk I/O can be as fast as buffered I/O).  The bottom
line, however, is that buffered I/O will offer you predictable
performance regardless of the platform and the backing device.
Therefore, it is most always preferable to use buffered I/O rather than
unbuffered I/O.


File: python.info,  Node: Text I/O<2>,  Prev: Binary I/O,  Up: Performance

5.15.2.9 Text I/O
.................

Text I/O over a binary storage (such as a file) is significantly slower
than binary I/O over the same storage, because it implies conversions
from unicode to binary data using a character codec.  This can become
noticeable if you handle huge amounts of text data (for example very
large log files).  Also, `TextIOWrapper.tell()' and
`TextIOWrapper.seek()' are both quite slow due to the reconstruction
algorithm used.

*Note StringIO: 32b, however, is a native in-memory unicode container
and will exhibit similar speed to *Note BytesIO: 11e2.


File: python.info,  Node: Multi-threading<2>,  Next: Reentrancy,  Prev: Performance,  Up: Advanced topics

5.15.2.10 Multi-threading
.........................

*Note FileIO: 230. objects are thread-safe to the extent that the
operating system calls (such as `read(2)' under Unix) they are wrapping
are thread-safe too.

Binary buffered objects (instances of *Note BufferedReader: 229, *Note
BufferedWriter: 11df, *Note BufferedRandom: 11e1. and *Note
BufferedRWPair: 11e0.)  protect their internal structures using a lock;
it is therefore safe to call them from multiple threads at once.

*Note TextIOWrapper: 11e3. objects are not thread-safe.


File: python.info,  Node: Reentrancy,  Prev: Multi-threading<2>,  Up: Advanced topics

5.15.2.11 Reentrancy
....................

Binary buffered objects (instances of *Note BufferedReader: 229, *Note
BufferedWriter: 11df, *Note BufferedRandom: 11e1. and *Note
BufferedRWPair: 11e0.)  are not reentrant.  While reentrant calls will
not happen in normal situations, they can arise if you are doing I/O in
a *Note signal: 155. handler.  If it is attempted to enter a buffered
object again while already being accessed `from the same thread', then
a *Note RuntimeError: 3b3. is raised.

The above implicitly extends to text files, since the *Note open(): 2d9.
function will wrap a buffered object inside a *Note TextIOWrapper:
11e3.  This includes standard streams and therefore affects the
built-in function *Note print(): 31f. as well.


File: python.info,  Node: time — Time access and conversions,  Next: argparse — Parser for command-line options arguments and sub-commands,  Prev: io — Core tools for working with streams,  Up: Generic Operating System Services

5.15.3 `time' — Time access and conversions
---------------------------------------------

This module provides various time-related functions. For related
functionality, see also the *Note datetime: 7d. and *Note calendar: 1f.
modules.

Although this module is always available, not all functions are
available on all platforms.  Most of the functions defined in this
module call platform C library functions with the same name.  It may
sometimes be helpful to consult the platform documentation, because the
semantics of these functions varies among platforms.

An explanation of some terminology and conventions is in order.

   * The `epoch' is the point where the time starts.  On January 1st of
     that year, at 0 hours, the “time since the epoch” is zero.
     For Unix, the epoch is 1970.  To find out what the epoch is, look
     at `gmtime(0)'.

   * The functions in this module do not handle dates and times before
     the epoch or far in the future.  The cut-off point in the future
     is determined by the C library; for Unix, it is typically in 2038.

   * `Year 2000 (Y2K) issues':  Python depends on the platform’s C
     library, which generally doesn’t have year 2000 issues, since
     all dates and times are represented internally as seconds since
     the epoch.  Functions accepting a *Note struct_time: b18. (see
     below) generally require a 4-digit year.  For backward
     compatibility, 2-digit years are supported if the module variable
     `accept2dyear' is a non-zero integer; this variable is initialized
     to `1' unless the environment variable *Note PYTHONY2K: 67b. is
     set to a non-empty string, in which case it is initialized to `0'.
     Thus, you can set *Note PYTHONY2K: 67b. to a non-empty string in
     the environment to require 4-digit years for all year input.  When
     2-digit years are accepted, they are converted according to the
     POSIX or X/Open standard: values 69-99 are mapped to 1969-1999,
     and values 0–68 are mapped to 2000–2068. Values 100–1899 are
     always illegal.

   * UTC is Coordinated Universal Time (formerly known as Greenwich
     Mean Time, or GMT).  The acronym UTC is not a mistake but a
     compromise between English and French.

   * DST is Daylight Saving Time, an adjustment of the timezone by
     (usually) one hour during part of the year.  DST rules are magic
     (determined by local law) and can change from year to year.  The C
     library has a table containing the local rules (often it is read
     from a system file for flexibility) and is the only source of True
     Wisdom in this respect.

   * The precision of the various real-time functions may be less than
     suggested by the units in which their value or argument is
     expressed. E.g. on most Unix systems, the clock “ticks” only
     50 or 100 times a second.

   * On the other hand, the precision of *Note time(): 47d. and *Note
     sleep(): 1223. is better than their Unix equivalents: times are
     expressed as floating point numbers, *Note time(): 47d. returns
     the most accurate time available (using Unix `gettimeofday()'
     where available), and *Note sleep(): 1223. will accept a time with
     a nonzero fraction (Unix `select()' is used to implement this,
     where available).

   * The time value as returned by *Note gmtime(): b7f, *Note
     localtime(): b19, and *Note strptime(): 3d7, and accepted by *Note
     asctime(): 1224, *Note mktime(): 1225. and *Note strftime(): 3d8,
     may be considered as a sequence of 9 integers.  The return values
     of *Note gmtime(): b7f, *Note localtime(): b19, and *Note
     strptime(): 3d7. also offer attribute names for individual fields.

     See *Note struct_time: b18. for a description of these objects.

     Changed in version 2.2: The time value sequence was changed from a
     tuple to a *Note struct_time: b18, with the addition of attribute
     names for the fields.

   * Use the following functions to convert between time
     representations:

     From                          To                            Use
     ------------------------------------------------------------------------------------------ 
     seconds since the epoch       *Note struct_time: b18. in    *Note gmtime(): b7f.
                                   UTC                           
     seconds since the epoch       *Note struct_time: b18. in    *Note localtime(): b19.
                                   local time                    
     *Note struct_time: b18. in    seconds since the epoch       *Note calendar.timegm(): b7e.
     UTC                                                         
     *Note struct_time: b18. in    seconds since the epoch       *Note mktime(): 1225.
     local time                                                  


The module defines the following functions and data items:

 -- Data: time.accept2dyear
     Boolean value indicating whether two-digit year values will be
     accepted.  This is true by default, but will be set to false if
     the environment variable *Note PYTHONY2K: 67b. has been set to a
     non-empty string.  It may also be modified at run time.

 -- Data: time.altzone
     The offset of the local DST timezone, in seconds west of UTC, if
     one is defined.  This is negative if the local DST timezone is
     east of UTC (as in Western Europe, including the UK).  Only use
     this if `daylight' is nonzero.

 -- Function: time.asctime ([t])
     Convert a tuple or *Note struct_time: b18. representing a time as
     returned by *Note gmtime(): b7f. or *Note localtime(): b19. to a
     24-character string of the following form: `'Sun Jun 20 23:21:05
     1993''.  If `t' is not provided, the current time as returned by
     *Note localtime(): b19. is used. Locale information is not used by
     *Note asctime(): 1224.

          Note: Unlike the C function of the same name, there is no
          trailing newline.

     Changed in version 2.1: Allowed `t' to be omitted.


 -- Function: time.clock ()
     On Unix, return the current processor time as a floating point
     number expressed in seconds.  The precision, and in fact the very
     definition of the meaning of “processor time”, depends on that
     of the C function of the same name, but in any case, this is the
     function to use for benchmarking Python or timing algorithms.

     On Windows, this function returns wall-clock seconds elapsed since
     the first call to this function, as a floating point number, based
     on the Win32 function `QueryPerformanceCounter()'. The resolution
     is typically better than one microsecond.

 -- Function: time.ctime ([secs])
     Convert a time expressed in seconds since the epoch to a string
     representing local time. If `secs' is not provided or *Note None:
     3b2, the current time as returned by *Note time(): 47d. is used.
     `ctime(secs)' is equivalent to `asctime(localtime(secs))'. Locale
     information is not used by *Note ctime(): b21.

     Changed in version 2.1: Allowed `secs' to be omitted.

     Changed in version 2.4: If `secs' is *Note None: 3b2, the current
     time is used.


 -- Data: time.daylight
     Nonzero if a DST timezone is defined.

 -- Function: time.gmtime ([secs])
     Convert a time expressed in seconds since the epoch to a *Note
     struct_time: b18. in UTC in which the dst flag is always zero.  If
     `secs' is not provided or *Note None: 3b2, the current time as
     returned by *Note time(): 47d. is used.  Fractions of a second are
     ignored.  See above for a description of the *Note struct_time:
     b18. object. See *Note calendar.timegm(): b7e. for the inverse of
     this function.

     Changed in version 2.1: Allowed `secs' to be omitted.

     Changed in version 2.4: If `secs' is *Note None: 3b2, the current
     time is used.


 -- Function: time.localtime ([secs])
     Like *Note gmtime(): b7f. but converts to local time.  If `secs'
     is not provided or *Note None: 3b2, the current time as returned
     by *Note time(): 47d. is used.  The dst flag is set to `1' when
     DST applies to the given time.

     Changed in version 2.1: Allowed `secs' to be omitted.

     Changed in version 2.4: If `secs' is *Note None: 3b2, the current
     time is used.


 -- Function: time.mktime (t)
     This is the inverse function of *Note localtime(): b19.  Its
     argument is the *Note struct_time: b18. or full 9-tuple (since the
     dst flag is needed; use `-1' as the dst flag if it is unknown)
     which expresses the time in `local' time, not UTC.  It returns a
     floating point number, for compatibility with *Note time(): 47d.
     If the input value cannot be represented as a valid time, either
     *Note OverflowError: 2dd. or *Note ValueError: 236. will be raised
     (which depends on whether the invalid value is caught by Python or
     the underlying C libraries).  The earliest date for which it can
     generate a time is platform-dependent.

 -- Function: time.sleep (secs)
     Suspend execution of the current thread for the given number of
     seconds.  The argument may be a floating point number to indicate
     a more precise sleep time. The actual suspension time may be less
     than that requested because any caught signal will terminate the
     *Note sleep(): 1223. following execution of that signal’s
     catching routine.  Also, the suspension time may be longer than
     requested by an arbitrary amount because of the scheduling of
     other activity in the system.

 -- Function: time.strftime (format[, t])
     Convert a tuple or *Note struct_time: b18. representing a time as
     returned by *Note gmtime(): b7f. or *Note localtime(): b19. to a
     string as specified by the `format' argument.  If `t' is not
     provided, the current time as returned by *Note localtime(): b19.
     is used.  `format' must be a string.  *Note ValueError: 236. is
     raised if any field in `t' is outside of the allowed range. *Note
     strftime(): 3d8.  returns a locale depedent byte string; the
     result may be converted to unicode by doing
     `strftime(<myformat>).decode(locale.getlocale()[1])'.

     Changed in version 2.1: Allowed `t' to be omitted.

     Changed in version 2.4: *Note ValueError: 236. raised if a field
     in `t' is out of range.

     Changed in version 2.5: 0 is now a legal argument for any position
     in the time tuple; if it is normally illegal the value is forced
     to a correct one.

     The following directives can be embedded in the `format' string.
     They are shown without the optional field width and precision
     specification, and are replaced by the indicated characters in the
     *Note strftime(): 3d8. result:

     Directive       Meaning                              Notes
     ----------------------------------------------------------------- 
     `%a'            Locale’s abbreviated weekday name. 
     `%A'            Locale’s full weekday name.        
     `%b'            Locale’s abbreviated month name.   
     `%B'            Locale’s full month name.          
     `%c'            Locale’s appropriate date and      
                     time representation.                 
     `%d'            Day of the month as a decimal        
                     number [01,31].                      
     `%H'            Hour (24-hour clock) as a decimal    
                     number [00,23].                      
     `%I'            Hour (12-hour clock) as a decimal    
                     number [01,12].                      
     `%j'            Day of the year as a decimal number  
                     [001,366].                           
     `%m'            Month as a decimal number [01,12].   
     `%M'            Minute as a decimal number [00,59].  
     `%p'            Locale’s equivalent of either AM   (1)
                     or PM.                               
     `%S'            Second as a decimal number [00,61].  (2)
     `%U'            Week number of the year (Sunday as   (3)
                     the first day of the week) as a      
                     decimal number [00,53].  All days    
                     in a new year preceding the first    
                     Sunday are considered to be in week  
                     0.                                   
     `%w'            Weekday as a decimal number          
                     [0(Sunday),6].                       
     `%W'            Week number of the year (Monday as   (3)
                     the first day of the week) as a      
                     decimal number [00,53].  All days    
                     in a new year preceding the first    
                     Monday are considered to be in week  
                     0.                                   
     `%x'            Locale’s appropriate date          
                     representation.                      
     `%X'            Locale’s appropriate time          
                     representation.                      
     `%y'            Year without century as a decimal    
                     number [00,99].                      
     `%Y'            Year with century as a decimal       
                     number.                              
     `%Z'            Time zone name (no characters if no  
                     time zone exists).                   
     `%%'            A literal `'%'' character.           

     Notes:

       1. When used with the *Note strptime(): 3d7. function, the `%p'
          directive only affects the output hour field if the `%I'
          directive is used to parse the hour.

       2. The range really is `0' to `61'; this accounts for leap
          seconds and the (very rare) double leap seconds.

       3. When used with the *Note strptime(): 3d7. function, `%U' and
          `%W' are only used in calculations when the day of the week
          and the year are specified.

     Here is an example, a format for dates compatible with that
     specified  in the RFC 2822(1) Internet email standard.  (2)

         >>> from time import gmtime, strftime
         >>> strftime("%a, %d %b %Y %H:%M:%S +0000", gmtime())
         'Thu, 28 Jun 2001 14:17:15 +0000'

     Additional directives may be supported on certain platforms, but
     only the ones listed here have a meaning standardized by ANSI C.
     To see the full set of format codes supported on your platform,
     consult the `strftime(3)' documentation.

     On some platforms, an optional field width and precision
     specification can immediately follow the initial `'%'' of a
     directive in the following order; this is also not portable. The
     field width is normally 2 except for `%j' where it is 3.

 -- Function: time.strptime (string[, format])
     Parse a string representing a time according to a format.  The
     return  value is a *Note struct_time: b18. as returned by *Note
     gmtime(): b7f. or *Note localtime(): b19.

     The `format' parameter uses the same directives as those used by
     *Note strftime(): 3d8.; it defaults to `"%a %b %d %H:%M:%S %Y"'
     which matches the formatting returned by *Note ctime(): b21. If
     `string' cannot be parsed according to `format', or if it has
     excess data after parsing, *Note ValueError: 236. is raised.  The
     default values used to fill in any missing data when more accurate
     values cannot be inferred are `(1900, 1, 1, 0, 0, 0, 0, 1, -1)'.

     For example:

         >>> import time
         >>> time.strptime("30 Nov 00", "%d %b %y")   # doctest: +NORMALIZE_WHITESPACE
         time.struct_time(tm_year=2000, tm_mon=11, tm_mday=30, tm_hour=0, tm_min=0,
                          tm_sec=0, tm_wday=3, tm_yday=335, tm_isdst=-1)

     Support for the `%Z' directive is based on the values contained in
     `tzname' and whether `daylight' is true.  Because of this, it is
     platform-specific except for recognizing UTC and GMT which are
     always known (and are considered to be non-daylight savings
     timezones).

     Only the directives specified in the documentation are supported.
     Because `strftime()' is implemented per platform it can sometimes
     offer more directives than those listed.  But `strptime()' is
     independent of any platform and thus does not necessarily support
     all directives available that are not documented as supported.

 -- Class: time.struct_time
     The type of the time value sequence returned by *Note gmtime():
     b7f, *Note localtime(): b19, and *Note strptime(): 3d7.  It is an
     object with a *Note named tuple: a4a. interface: values can be
     accessed by index and by attribute name.  The following values are
     present:

     Index       Attribute               Values
     -------------------------------------------------------------------------- 
     0           `tm_year'               (for example, 1993)
     1           `tm_mon'                range [1, 12]
     2           `tm_mday'               range [1, 31]
     3           `tm_hour'               range [0, 23]
     4           `tm_min'                range [0, 59]
     5           `tm_sec'                range [0, 61]; see `(2)' in *Note
                                         strftime(): 3d8. description
     6           `tm_wday'               range [0, 6], Monday is 0
     7           `tm_yday'               range [1, 366]
     8           `tm_isdst'              0, 1 or -1; see below

     New in version 2.2.

     Note that unlike the C structure, the month value is a range of
     [1, 12], not [0, 11].  A year value will be handled as described
     under *Note Year 2000 (Y2K) issues: 1222. above.

     In calls to *Note mktime(): 1225, `tm_isdst' may be set to 1 when
     daylight savings time is in effect, and 0 when it is not.  A value
     of -1 indicates that this is not known, and will usually result in
     the correct state being filled in.

     When a tuple with an incorrect length is passed to a function
     expecting a *Note struct_time: b18, or having elements of the
     wrong type, a *Note TypeError: 218. is raised.

 -- Function: time.time ()
     Return the time in seconds since the epoch as a floating point
     number.  Note that even though the time is always returned as a
     floating point number, not all systems provide time with a better
     precision than 1 second.  While this function normally returns
     non-decreasing values, it can return a lower value than a previous
     call if the system clock has been set back between the two calls.

 -- Data: time.timezone
     The offset of the local (non-DST) timezone, in seconds west of UTC
     (negative in most of Western Europe, positive in the US, zero in
     the UK).

 -- Data: time.tzname
     A tuple of two strings: the first is the name of the local non-DST
     timezone, the second is the name of the local DST timezone.  If no
     DST timezone is defined, the second string should not be used.

 -- Function: time.tzset ()
     Resets the time conversion rules used by the library routines. The
     environment variable `TZ' specifies how this is done.

     New in version 2.3.

     Availability: Unix.

          Note: Although in many cases, changing the `TZ' environment
          variable may affect the output of functions like *Note
          localtime(): b19. without calling *Note tzset(): 122c, this
          behavior should not be relied on.

          The `TZ' environment variable should contain no whitespace.

     The standard format of the `TZ' environment variable is (whitespace
     added for clarity):

         std offset [dst [offset [,start[/time], end[/time]]]]

     Where the components are:

    `std' and `dst'
          Three or more alphanumerics giving the timezone
          abbreviations. These will be propagated into time.tzname

    `offset'
          The offset has the form: `± hh[:mm[:ss]]'. This indicates
          the value added the local time to arrive at UTC.  If preceded
          by a ‘-‘, the timezone is east of the Prime Meridian;
          otherwise, it is west. If no offset follows dst, summer time
          is assumed to be one hour ahead of standard time.

    `start[/time], end[/time]'
          Indicates when to change to and back from DST. The format of
          the start and end dates are one of the following:

         `J`n''
               The Julian day `n' (1 <= `n' <= 365). Leap days are not
               counted, so in all years February 28 is day 59 and March
               1 is day 60.

         ``n''
               The zero-based Julian day (0 <= `n' <= 365). Leap days
               are counted, and it is possible to refer to February 29.

         `M`m'.`n'.`d''
               The `d'’th day (0 <= `d' <= 6) or week `n' of month
               `m' of the year (1 <= `n' <= 5, 1 <= `m' <= 12, where
               week 5 means “the last `d' day in month `m'” which
               may occur in either the fourth or the fifth week). Week
               1 is the first week in which the `d'’th day occurs. Day
               zero is Sunday.

          `time' has the same format as `offset' except that no leading
          sign (‘-‘ or ‘+’) is allowed. The default, if time is
          not given, is 02:00:00.

         >>> os.environ['TZ'] = 'EST+05EDT,M4.1.0,M10.5.0'
         >>> time.tzset()
         >>> time.strftime('%X %x %Z')
         '02:07:36 05/08/03 EDT'
         >>> os.environ['TZ'] = 'AEST-10AEDT-11,M10.5.0,M3.5.0'
         >>> time.tzset()
         >>> time.strftime('%X %x %Z')
         '16:08:12 05/08/03 AEST'

     On many Unix systems (including *BSD, Linux, Solaris, and Darwin),
     it is more convenient to use the system’s zoneinfo (`tzfile(5)')
     database to specify the timezone rules. To do this, set the `TZ'
     environment variable to the path of the required timezone
     datafile, relative to the root of the systems ‘zoneinfo’
     timezone database, usually located at `/usr/share/zoneinfo'. For
     example,  `'US/Eastern'', `'Australia/Melbourne'', `'Egypt'' or
     `'Europe/Amsterdam''.

         >>> os.environ['TZ'] = 'US/Eastern'
         >>> time.tzset()
         >>> time.tzname
         ('EST', 'EDT')
         >>> os.environ['TZ'] = 'Egypt'
         >>> time.tzset()
         >>> time.tzname
         ('EET', 'EEST')

See also
........

Module *Note datetime: 7d.
     More object-oriented interface to dates and times.

Module *Note locale: 101.
     Internationalization services.  The locale setting affects the
     interpretation of many format specifiers in *Note strftime(): 3d8.
     and *Note strptime(): 3d7.

Module *Note calendar: 1f.
     General calendar-related functions.   *Note timegm(): b7e. is the
     inverse of *Note gmtime(): b7f. from this module.

---------- Footnotes ----------

(1) https://tools.ietf.org/html/rfc2822.html

(2) The use of `%Z' is now deprecated, but the `%z' escape that expands
to the preferred  hour/minute offset is not supported by all ANSI C
libraries. Also, a strict reading of the original 1982 RFC 822
(https://tools.ietf.org/html/rfc822.html) standard calls for a two-digit
year (%y rather than %Y), but practice moved to 4-digit years long
before the year 2000.  After that, RFC 822
(https://tools.ietf.org/html/rfc822.html) became obsolete and the
4-digit year has been first recommended by RFC 1123
(https://tools.ietf.org/html/rfc1123.html) and then mandated by RFC
2822 (https://tools.ietf.org/html/rfc2822.html).


File: python.info,  Node: argparse — Parser for command-line options arguments and sub-commands,  Next: optparse — Parser for command line options,  Prev: time — Time access and conversions,  Up: Generic Operating System Services

5.15.4 `argparse' — Parser for command-line options, arguments and sub-commands
---------------------------------------------------------------------------------

New in version 2.7.

`Source code:' Lib/argparse.py(1)

__________________________________________________________________

Tutorial
........

This page contains the API reference information. For a more gentle
introduction to Python command-line parsing, have a look at the *Note
argparse tutorial: 122f.

The *Note argparse: d. module makes it easy to write user-friendly
command-line interfaces. The program defines what arguments it
requires, and *Note argparse: d.  will figure out how to parse those
out of *Note sys.argv: 65a.  The *Note argparse: d.  module also
automatically generates help and usage messages and issues errors when
users give the program invalid arguments.

* Menu:

* Example: Example<6>.
* ArgumentParser objects::
* The add_argument() method: The add_argument method.
* The parse_args() method: The parse_args method.
* Other utilities::
* Upgrading optparse code::

---------- Footnotes ----------

(1) https://hg.python.org/cpython/file/2.7/Lib/argparse.py


File: python.info,  Node: Example<6>,  Next: ArgumentParser objects,  Up: argparse — Parser for command-line options arguments and sub-commands

5.15.4.1 Example
................

The following code is a Python program that takes a list of integers and
produces either the sum or the max:

    import argparse

    parser = argparse.ArgumentParser(description='Process some integers.')
    parser.add_argument('integers', metavar='N', type=int, nargs='+',
                        help='an integer for the accumulator')
    parser.add_argument('--sum', dest='accumulate', action='store_const',
                        const=sum, default=max,
                        help='sum the integers (default: find the max)')

    args = parser.parse_args()
    print args.accumulate(args.integers)

Assuming the Python code above is saved into a file called `prog.py',
it can be run at the command line and provides useful help messages:

    $ python prog.py -h
    usage: prog.py [-h] [--sum] N [N ...]

    Process some integers.

    positional arguments:
     N           an integer for the accumulator

    optional arguments:
     -h, --help  show this help message and exit
     --sum       sum the integers (default: find the max)

When run with the appropriate arguments, it prints either the sum or
the max of the command-line integers:

    $ python prog.py 1 2 3 4
    4

    $ python prog.py 1 2 3 4 --sum
    10

If invalid arguments are passed in, it will issue an error:

    $ python prog.py a b c
    usage: prog.py [-h] [--sum] N [N ...]
    prog.py: error: argument N: invalid int value: 'a'

The following sections walk you through this example.

* Menu:

* Creating a parser::
* Adding arguments::
* Parsing arguments::


File: python.info,  Node: Creating a parser,  Next: Adding arguments,  Up: Example<6>

5.15.4.2 Creating a parser
..........................

The first step in using the *Note argparse: d. is creating an *Note
ArgumentParser: 1232. object:

    >>> parser = argparse.ArgumentParser(description='Process some integers.')

The *Note ArgumentParser: 1232. object will hold all the information
necessary to parse the command line into Python data types.


File: python.info,  Node: Adding arguments,  Next: Parsing arguments,  Prev: Creating a parser,  Up: Example<6>

5.15.4.3 Adding arguments
.........................

Filling an *Note ArgumentParser: 1232. with information about program
arguments is done by making calls to the *Note add_argument(): 1234.
method.  Generally, these calls tell the *Note ArgumentParser: 1232.
how to take the strings on the command line and turn them into objects.
This information is stored and used when *Note parse_args(): 1235. is
called. For example:

    >>> parser.add_argument('integers', metavar='N', type=int, nargs='+',
    ...                     help='an integer for the accumulator')
    >>> parser.add_argument('--sum', dest='accumulate', action='store_const',
    ...                     const=sum, default=max,
    ...                     help='sum the integers (default: find the max)')

Later, calling *Note parse_args(): 1235. will return an object with two
attributes, `integers' and `accumulate'.  The `integers' attribute will
be a list of one or more ints, and the `accumulate' attribute will be
either the *Note sum(): 43f. function, if `--sum' was specified at the
command line, or the *Note max(): 225. function if it was not.


File: python.info,  Node: Parsing arguments,  Prev: Adding arguments,  Up: Example<6>

5.15.4.4 Parsing arguments
..........................

*Note ArgumentParser: 1232. parses arguments through the *Note
parse_args(): 1235. method.  This will inspect the command line,
convert each argument to the appropriate type and then invoke the
appropriate action.  In most cases, this means a simple *Note
Namespace: 1237. object will be built up from attributes parsed out of
the command line:

    >>> parser.parse_args(['--sum', '7', '-1', '42'])
    Namespace(accumulate=<built-in function sum>, integers=[7, -1, 42])

In a script, *Note parse_args(): 1235. will typically be called with no
arguments, and the *Note ArgumentParser: 1232. will automatically
determine the command-line arguments from *Note sys.argv: 65a.


File: python.info,  Node: ArgumentParser objects,  Next: The add_argument method,  Prev: Example<6>,  Up: argparse — Parser for command-line options arguments and sub-commands

5.15.4.5 ArgumentParser objects
...............................

 -- Class: argparse.ArgumentParser (prog=None, usage=None,
          description=None, epilog=None, parents=[],
          formatter_class=argparse.HelpFormatter, prefix_chars='-',
          fromfile_prefix_chars=None, argument_default=None,
          conflict_handler='error', add_help=True)
     Create a new *Note ArgumentParser: 1232. object. All parameters
     should be passed as keyword arguments. Each parameter has its own
     more detailed description below, but in short they are:

        * *Note prog: 1239. - The name of the program (default:
          `sys.argv[0]')

        * *Note usage: 123a. - The string describing the program usage
          (default: generated from arguments added to parser)

        * *Note description: 123b. - Text to display before the
          argument help (default: none)

        * *Note epilog: 123c. - Text to display after the argument help
          (default: none)

        * *Note parents: 123d. - A list of *Note ArgumentParser: 1232.
          objects whose arguments should also be included

        * *Note formatter_class: 123e. - A class for customizing the
          help output

        * *Note prefix_chars: 123f. - The set of characters that prefix
          optional arguments (default: ‘-‘)

        * *Note fromfile_prefix_chars: 1240. - The set of characters
          that prefix files from which additional arguments should be
          read (default: `None')

        * *Note argument_default: 1241. - The global default value for
          arguments (default: `None')

        * *Note conflict_handler: 1242. - The strategy for resolving
          conflicting optionals (usually unnecessary)

        * *Note add_help: 1243. - Add a -h/–help option to the parser
          (default: `True')

The following sections describe how each of these are used.

* Menu:

* prog::
* usage::
* description::
* epilog::
* parents::
* formatter_class::
* prefix_chars::
* fromfile_prefix_chars::
* argument_default::
* conflict_handler::
* add_help::


File: python.info,  Node: prog,  Next: usage,  Up: ArgumentParser objects

5.15.4.6 prog
.............

By default, *Note ArgumentParser: 1232. objects use `sys.argv[0]' to
determine how to display the name of the program in help messages.
This default is almost always desirable because it will make the help
messages match how the program was invoked on the command line.  For
example, consider a file named `myprogram.py' with the following code:

    import argparse
    parser = argparse.ArgumentParser()
    parser.add_argument('--foo', help='foo help')
    args = parser.parse_args()

The help for this program will display `myprogram.py' as the program
name (regardless of where the program was invoked from):

    $ python myprogram.py --help
    usage: myprogram.py [-h] [--foo FOO]

    optional arguments:
     -h, --help  show this help message and exit
     --foo FOO   foo help
    $ cd ..
    $ python subdir\myprogram.py --help
    usage: myprogram.py [-h] [--foo FOO]

    optional arguments:
     -h, --help  show this help message and exit
     --foo FOO   foo help

To change this default behavior, another value can be supplied using the
`prog=' argument to *Note ArgumentParser: 1232.:

    >>> parser = argparse.ArgumentParser(prog='myprogram')
    >>> parser.print_help()
    usage: myprogram [-h]

    optional arguments:
     -h, --help  show this help message and exit

Note that the program name, whether determined from `sys.argv[0]' or
from the `prog=' argument, is available to help messages using the
`%(prog)s' format specifier.

    >>> parser = argparse.ArgumentParser(prog='myprogram')
    >>> parser.add_argument('--foo', help='foo of the %(prog)s program')
    >>> parser.print_help()
    usage: myprogram [-h] [--foo FOO]

    optional arguments:
     -h, --help  show this help message and exit
     --foo FOO   foo of the myprogram program


File: python.info,  Node: usage,  Next: description,  Prev: prog,  Up: ArgumentParser objects

5.15.4.7 usage
..............

By default, *Note ArgumentParser: 1232. calculates the usage message
from the arguments it contains:

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('--foo', nargs='?', help='foo help')
    >>> parser.add_argument('bar', nargs='+', help='bar help')
    >>> parser.print_help()
    usage: PROG [-h] [--foo [FOO]] bar [bar ...]

    positional arguments:
     bar          bar help

    optional arguments:
     -h, --help   show this help message and exit
     --foo [FOO]  foo help

The default message can be overridden with the `usage=' keyword
argument:

    >>> parser = argparse.ArgumentParser(prog='PROG', usage='%(prog)s [options]')
    >>> parser.add_argument('--foo', nargs='?', help='foo help')
    >>> parser.add_argument('bar', nargs='+', help='bar help')
    >>> parser.print_help()
    usage: PROG [options]

    positional arguments:
     bar          bar help

    optional arguments:
     -h, --help   show this help message and exit
     --foo [FOO]  foo help

The `%(prog)s' format specifier is available to fill in the program
name in your usage messages.


File: python.info,  Node: description,  Next: epilog,  Prev: usage,  Up: ArgumentParser objects

5.15.4.8 description
....................

Most calls to the *Note ArgumentParser: 1232. constructor will use the
`description=' keyword argument.  This argument gives a brief
description of what the program does and how it works.  In help
messages, the description is displayed between the command-line usage
string and the help messages for the various arguments:

    >>> parser = argparse.ArgumentParser(description='A foo that bars')
    >>> parser.print_help()
    usage: argparse.py [-h]

    A foo that bars

    optional arguments:
     -h, --help  show this help message and exit

By default, the description will be line-wrapped so that it fits within
the given space.  To change this behavior, see the *Note
formatter_class: 123e. argument.


File: python.info,  Node: epilog,  Next: parents,  Prev: description,  Up: ArgumentParser objects

5.15.4.9 epilog
...............

Some programs like to display additional description of the program
after the description of the arguments.  Such text can be specified
using the `epilog=' argument to *Note ArgumentParser: 1232.:

    >>> parser = argparse.ArgumentParser(
    ...     description='A foo that bars',
    ...     epilog="And that's how you'd foo a bar")
    >>> parser.print_help()
    usage: argparse.py [-h]

    A foo that bars

    optional arguments:
     -h, --help  show this help message and exit

    And that's how you'd foo a bar

As with the *Note description: 123b. argument, the `epilog=' text is by
default line-wrapped, but this behavior can be adjusted with the *Note
formatter_class: 123e.  argument to *Note ArgumentParser: 1232.


File: python.info,  Node: parents,  Next: formatter_class,  Prev: epilog,  Up: ArgumentParser objects

5.15.4.10 parents
.................

Sometimes, several parsers share a common set of arguments. Rather than
repeating the definitions of these arguments, a single parser with all
the shared arguments and passed to `parents=' argument to *Note
ArgumentParser: 1232.  can be used.  The `parents=' argument takes a
list of *Note ArgumentParser: 1232.  objects, collects all the
positional and optional actions from them, and adds these actions to
the *Note ArgumentParser: 1232. object being constructed:

    >>> parent_parser = argparse.ArgumentParser(add_help=False)
    >>> parent_parser.add_argument('--parent', type=int)

    >>> foo_parser = argparse.ArgumentParser(parents=[parent_parser])
    >>> foo_parser.add_argument('foo')
    >>> foo_parser.parse_args(['--parent', '2', 'XXX'])
    Namespace(foo='XXX', parent=2)

    >>> bar_parser = argparse.ArgumentParser(parents=[parent_parser])
    >>> bar_parser.add_argument('--bar')
    >>> bar_parser.parse_args(['--bar', 'YYY'])
    Namespace(bar='YYY', parent=None)

Note that most parent parsers will specify `add_help=False'.
Otherwise, the *Note ArgumentParser: 1232. will see two `-h/--help'
options (one in the parent and one in the child) and raise an error.

     Note: You must fully initialize the parsers before passing them
     via `parents='.  If you change the parent parsers after the child
     parser, those changes will not be reflected in the child.


File: python.info,  Node: formatter_class,  Next: prefix_chars,  Prev: parents,  Up: ArgumentParser objects

5.15.4.11 formatter_class
.........................

*Note ArgumentParser: 1232. objects allow the help formatting to be
customized by specifying an alternate formatting class.  Currently,
there are three such classes:

 -- Class: argparse.RawDescriptionHelpFormatter
 -- Class: argparse.RawTextHelpFormatter
 -- Class: argparse.ArgumentDefaultsHelpFormatter

The first two allow more control over how textual descriptions are
displayed, while the last automatically adds information about argument
default values.

By default, *Note ArgumentParser: 1232. objects line-wrap the *Note
description: 123b. and *Note epilog: 123c. texts in command-line help
messages:

    >>> parser = argparse.ArgumentParser(
    ...     prog='PROG',
    ...     description='''this description
    ...         was indented weird
    ...             but that is okay''',
    ...     epilog='''
    ...             likewise for this epilog whose whitespace will
    ...         be cleaned up and whose words will be wrapped
    ...         across a couple lines''')
    >>> parser.print_help()
    usage: PROG [-h]

    this description was indented weird but that is okay

    optional arguments:
     -h, --help  show this help message and exit

    likewise for this epilog whose whitespace will be cleaned up and whose words
    will be wrapped across a couple lines

Passing *Note RawDescriptionHelpFormatter: 1244. as `formatter_class='
indicates that *Note description: 123b. and *Note epilog: 123c. are
already correctly formatted and should not be line-wrapped:

    >>> parser = argparse.ArgumentParser(
    ...     prog='PROG',
    ...     formatter_class=argparse.RawDescriptionHelpFormatter,
    ...     description=textwrap.dedent('''\
    ...         Please do not mess up this text!
    ...         --------------------------------
    ...             I have indented it
    ...             exactly the way
    ...             I want it
    ...         '''))
    >>> parser.print_help()
    usage: PROG [-h]

    Please do not mess up this text!
    --------------------------------
       I have indented it
       exactly the way
       I want it

    optional arguments:
     -h, --help  show this help message and exit

*Note RawTextHelpFormatter: 1245. maintains whitespace for all sorts of
help text, including argument descriptions.

The other formatter class available, *Note
ArgumentDefaultsHelpFormatter: 1246, will add information about the
default value of each of the arguments:

    >>> parser = argparse.ArgumentParser(
    ...     prog='PROG',
    ...     formatter_class=argparse.ArgumentDefaultsHelpFormatter)
    >>> parser.add_argument('--foo', type=int, default=42, help='FOO!')
    >>> parser.add_argument('bar', nargs='*', default=[1, 2, 3], help='BAR!')
    >>> parser.print_help()
    usage: PROG [-h] [--foo FOO] [bar [bar ...]]

    positional arguments:
     bar         BAR! (default: [1, 2, 3])

    optional arguments:
     -h, --help  show this help message and exit
     --foo FOO   FOO! (default: 42)


File: python.info,  Node: prefix_chars,  Next: fromfile_prefix_chars,  Prev: formatter_class,  Up: ArgumentParser objects

5.15.4.12 prefix_chars
......................

Most command-line options will use `-' as the prefix, e.g. `-f/--foo'.
Parsers that need to support different or additional prefix characters,
e.g. for options like `+f' or `/foo', may specify them using the
`prefix_chars=' argument to the ArgumentParser constructor:

    >>> parser = argparse.ArgumentParser(prog='PROG', prefix_chars='-+')
    >>> parser.add_argument('+f')
    >>> parser.add_argument('++bar')
    >>> parser.parse_args('+f X ++bar Y'.split())
    Namespace(bar='Y', f='X')

The `prefix_chars=' argument defaults to `'-''. Supplying a set of
characters that does not include `-' will cause `-f/--foo' options to be
disallowed.


File: python.info,  Node: fromfile_prefix_chars,  Next: argument_default,  Prev: prefix_chars,  Up: ArgumentParser objects

5.15.4.13 fromfile_prefix_chars
...............................

Sometimes, for example when dealing with a particularly long argument
lists, it may make sense to keep the list of arguments in a file rather
than typing it out at the command line.  If the
`fromfile_prefix_chars=' argument is given to the *Note ArgumentParser:
1232. constructor, then arguments that start with any of the specified
characters will be treated as files, and will be replaced by the
arguments they contain.  For example:

    >>> with open('args.txt', 'w') as fp:
    ...     fp.write('-f\nbar')
    >>> parser = argparse.ArgumentParser(fromfile_prefix_chars='@')
    >>> parser.add_argument('-f')
    >>> parser.parse_args(['-f', 'foo', '@args.txt'])
    Namespace(f='bar')

Arguments read from a file must by default be one per line (but see also
*Note convert_arg_line_to_args(): 1247.) and are treated as if they
were in the same place as the original file referencing argument on the
command line.  So in the example above, the expression `['-f', 'foo',
'@args.txt']' is considered equivalent to the expression `['-f', 'foo',
'-f', 'bar']'.

The `fromfile_prefix_chars=' argument defaults to `None', meaning that
arguments will never be treated as file references.


File: python.info,  Node: argument_default,  Next: conflict_handler,  Prev: fromfile_prefix_chars,  Up: ArgumentParser objects

5.15.4.14 argument_default
..........................

Generally, argument defaults are specified either by passing a default
to *Note add_argument(): 1234. or by calling the *Note set_defaults():
1248. methods with a specific set of name-value pairs.  Sometimes
however, it may be useful to specify a single parser-wide default for
arguments.  This can be accomplished by passing the `argument_default='
keyword argument to *Note ArgumentParser: 1232.  For example, to
globally suppress attribute creation on *Note parse_args(): 1235.
calls, we supply `argument_default=SUPPRESS':

    >>> parser = argparse.ArgumentParser(argument_default=argparse.SUPPRESS)
    >>> parser.add_argument('--foo')
    >>> parser.add_argument('bar', nargs='?')
    >>> parser.parse_args(['--foo', '1', 'BAR'])
    Namespace(bar='BAR', foo='1')
    >>> parser.parse_args([])
    Namespace()


File: python.info,  Node: conflict_handler,  Next: add_help,  Prev: argument_default,  Up: ArgumentParser objects

5.15.4.15 conflict_handler
..........................

*Note ArgumentParser: 1232. objects do not allow two actions with the
same option string.  By default, *Note ArgumentParser: 1232. objects
raise an exception if an attempt is made to create an argument with an
option string that is already in use:

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('-f', '--foo', help='old foo help')
    >>> parser.add_argument('--foo', help='new foo help')
    Traceback (most recent call last):
     ..
    ArgumentError: argument --foo: conflicting option string(s): --foo

Sometimes (e.g. when using *Note parents: 123d.) it may be useful to
simply override any older arguments with the same option string.  To
get this behavior, the value `'resolve'' can be supplied to the
`conflict_handler=' argument of *Note ArgumentParser: 1232.:

    >>> parser = argparse.ArgumentParser(prog='PROG', conflict_handler='resolve')
    >>> parser.add_argument('-f', '--foo', help='old foo help')
    >>> parser.add_argument('--foo', help='new foo help')
    >>> parser.print_help()
    usage: PROG [-h] [-f FOO] [--foo FOO]

    optional arguments:
     -h, --help  show this help message and exit
     -f FOO      old foo help
     --foo FOO   new foo help

Note that *Note ArgumentParser: 1232. objects only remove an action if
all of its option strings are overridden.  So, in the example above,
the old `-f/--foo' action is retained as the `-f' action, because only
the `--foo' option string was overridden.


File: python.info,  Node: add_help,  Prev: conflict_handler,  Up: ArgumentParser objects

5.15.4.16 add_help
..................

By default, ArgumentParser objects add an option which simply displays
the parser’s help message. For example, consider a file named
`myprogram.py' containing the following code:

    import argparse
    parser = argparse.ArgumentParser()
    parser.add_argument('--foo', help='foo help')
    args = parser.parse_args()

If `-h' or `--help' is supplied at the command line, the ArgumentParser
help will be printed:

    $ python myprogram.py --help
    usage: myprogram.py [-h] [--foo FOO]

    optional arguments:
     -h, --help  show this help message and exit
     --foo FOO   foo help

Occasionally, it may be useful to disable the addition of this help
option.  This can be achieved by passing `False' as the `add_help='
argument to *Note ArgumentParser: 1232.:

    >>> parser = argparse.ArgumentParser(prog='PROG', add_help=False)
    >>> parser.add_argument('--foo', help='foo help')
    >>> parser.print_help()
    usage: PROG [--foo FOO]

    optional arguments:
     --foo FOO  foo help

The help option is typically `-h/--help'. The exception to this is if
the `prefix_chars=' is specified and does not include `-', in which
case `-h' and `--help' are not valid options.  In this case, the first
character in `prefix_chars' is used to prefix the help options:

    >>> parser = argparse.ArgumentParser(prog='PROG', prefix_chars='+/')
    >>> parser.print_help()
    usage: PROG [+h]

    optional arguments:
      +h, ++help  show this help message and exit


File: python.info,  Node: The add_argument method,  Next: The parse_args method,  Prev: ArgumentParser objects,  Up: argparse — Parser for command-line options arguments and sub-commands

5.15.4.17 The add_argument() method
...................................

 -- Method: ArgumentParser.add_argument (name or flags...[, action][,
          nargs][, const][, default][, type][, choices][, required][,
          help][, metavar][, dest])
     Define how a single command-line argument should be parsed.  Each
     parameter has its own more detailed description below, but in
     short they are:

        * *Note name or flags: 124a. - Either a name or a list of
          option strings, e.g. `foo' or `-f, --foo'.

        * *Note action: 124b. - The basic type of action to be taken
          when this argument is encountered at the command line.

        * *Note nargs: 124c. - The number of command-line arguments
          that should be consumed.

        * *Note const: 124d. - A constant value required by some *Note
          action: 124b. and *Note nargs: 124c. selections.

        * *Note default: 124e. - The value produced if the argument is
          absent from the command line.

        * *Note type: 124f. - The type to which the command-line
          argument should be converted.

        * *Note choices: 1250. - A container of the allowable values
          for the argument.

        * *Note required: 1251. - Whether or not the command-line
          option may be omitted (optionals only).

        * *Note help: 1252. - A brief description of what the argument
          does.

        * *Note metavar: 1253. - A name for the argument in usage
          messages.

        * *Note dest: 1254. - The name of the attribute to be added to
          the object returned by *Note parse_args(): 1235.

The following sections describe how each of these are used.

* Menu:

* name or flags::
* action::
* nargs::
* const::
* default::
* type::
* choices::
* required::
* help::
* metavar::
* dest::
* Action classes::


File: python.info,  Node: name or flags,  Next: action,  Up: The add_argument method

5.15.4.18 name or flags
.......................

The *Note add_argument(): 1234. method must know whether an optional
argument, like `-f' or `--foo', or a positional argument, like a list of
filenames, is expected.  The first arguments passed to *Note
add_argument(): 1234. must therefore be either a series of flags, or a
simple argument name.  For example, an optional argument could be
created like:

    >>> parser.add_argument('-f', '--foo')

while a positional argument could be created like:

    >>> parser.add_argument('bar')

When *Note parse_args(): 1235. is called, optional arguments will be
identified by the `-' prefix, and the remaining arguments will be
assumed to be positional:

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('-f', '--foo')
    >>> parser.add_argument('bar')
    >>> parser.parse_args(['BAR'])
    Namespace(bar='BAR', foo=None)
    >>> parser.parse_args(['BAR', '--foo', 'FOO'])
    Namespace(bar='BAR', foo='FOO')
    >>> parser.parse_args(['--foo', 'FOO'])
    usage: PROG [-h] [-f FOO] bar
    PROG: error: too few arguments


File: python.info,  Node: action,  Next: nargs,  Prev: name or flags,  Up: The add_argument method

5.15.4.19 action
................

*Note ArgumentParser: 1232. objects associate command-line arguments
with actions.  These actions can do just about anything with the
command-line arguments associated with them, though most actions simply
add an attribute to the object returned by *Note parse_args(): 1235.
The `action' keyword argument specifies how the command-line arguments
should be handled. The supplied actions are:

   * `'store'' - This just stores the argument’s value.  This is the
     default action. For example:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--foo')
         >>> parser.parse_args('--foo 1'.split())
         Namespace(foo='1')

   * `'store_const'' - This stores the value specified by the *Note
     const: 124d. keyword argument.  The `'store_const'' action is most
     commonly used with optional arguments that specify some sort of
     flag.  For example:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--foo', action='store_const', const=42)
         >>> parser.parse_args(['--foo'])
         Namespace(foo=42)

   * `'store_true'' and `'store_false'' - These are special cases of
     `'store_const'' using for storing the values `True' and `False'
     respectively.  In addition, they create default values of `False'
     and `True' respectively.  For example:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--foo', action='store_true')
         >>> parser.add_argument('--bar', action='store_false')
         >>> parser.add_argument('--baz', action='store_false')
         >>> parser.parse_args('--foo --bar'.split())
         Namespace(bar=False, baz=True, foo=True)

   * `'append'' - This stores a list, and appends each argument value
     to the list.  This is useful to allow an option to be specified
     multiple times.  Example usage:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--foo', action='append')
         >>> parser.parse_args('--foo 1 --foo 2'.split())
         Namespace(foo=['1', '2'])

   * `'append_const'' - This stores a list, and appends the value
     specified by the *Note const: 124d. keyword argument to the list.
     (Note that the *Note const: 124d. keyword argument defaults to
     `None'.)  The `'append_const'' action is typically useful when
     multiple arguments need to store constants to the same list. For
     example:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--str', dest='types', action='append_const', const=str)
         >>> parser.add_argument('--int', dest='types', action='append_const', const=int)
         >>> parser.parse_args('--str --int'.split())
         Namespace(types=[<type 'str'>, <type 'int'>])

   * `'count'' - This counts the number of times a keyword argument
     occurs. For example, this is useful for increasing verbosity
     levels:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--verbose', '-v', action='count')
         >>> parser.parse_args(['-vvv'])
         Namespace(verbose=3)

   * `'help'' - This prints a complete help message for all the options
     in the current parser and then exits. By default a help action is
     automatically added to the parser. See *Note ArgumentParser: 1232.
     for details of how the output is created.

   * `'version'' - This expects a `version=' keyword argument in the
     *Note add_argument(): 1234. call, and prints version information
     and exits when invoked:

         >>> import argparse
         >>> parser = argparse.ArgumentParser(prog='PROG')
         >>> parser.add_argument('--version', action='version', version='%(prog)s 2.0')
         >>> parser.parse_args(['--version'])
         PROG 2.0

You may also specify an arbitrary action by passing an Action subclass
or other object that implements the same interface.  The recommended
way to do this is to extend *Note Action: 1255, overriding the
`__call__' method and optionally the `__init__' method.

An example of a custom action:

    >>> class FooAction(argparse.Action):
    ...     def __init__(self, option_strings, dest, nargs=None, **kwargs):
    ...         if nargs is not None:
    ...             raise ValueError("nargs not allowed")
    ...         super(FooAction, self).__init__(option_strings, dest, **kwargs)
    ...     def __call__(self, parser, namespace, values, option_string=None):
    ...         print '%r %r %r' % (namespace, values, option_string)
    ...         setattr(namespace, self.dest, values)
    ...
    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo', action=FooAction)
    >>> parser.add_argument('bar', action=FooAction)
    >>> args = parser.parse_args('1 --foo 2'.split())
    Namespace(bar=None, foo=None) '1' None
    Namespace(bar='1', foo=None) '2' '--foo'
    >>> args
    Namespace(bar='1', foo='2')

For more details, see *Note Action: 1255.


File: python.info,  Node: nargs,  Next: const,  Prev: action,  Up: The add_argument method

5.15.4.20 nargs
...............

ArgumentParser objects usually associate a single command-line argument
with a single action to be taken.  The `nargs' keyword argument
associates a different number of command-line arguments with a single
action.  The supported values are:

   * `N' (an integer).  `N' arguments from the command line will be
     gathered together into a list.  For example:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--foo', nargs=2)
         >>> parser.add_argument('bar', nargs=1)
         >>> parser.parse_args('c --foo a b'.split())
         Namespace(bar=['c'], foo=['a', 'b'])

     Note that `nargs=1' produces a list of one item.  This is
     different from the default, in which the item is produced by
     itself.

   * `'?''. One argument will be consumed from the command line if
     possible, and produced as a single item.  If no command-line
     argument is present, the value from *Note default: 124e. will be
     produced.  Note that for optional arguments, there is an
     additional case - the option string is present but not followed by
     a command-line argument.  In this case the value from *Note const:
     124d. will be produced.  Some examples to illustrate this:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--foo', nargs='?', const='c', default='d')
         >>> parser.add_argument('bar', nargs='?', default='d')
         >>> parser.parse_args(['XX', '--foo', 'YY'])
         Namespace(bar='XX', foo='YY')
         >>> parser.parse_args(['XX', '--foo'])
         Namespace(bar='XX', foo='c')
         >>> parser.parse_args([])
         Namespace(bar='d', foo='d')

     One of the more common uses of `nargs='?'' is to allow optional
     input and output files:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('infile', nargs='?', type=argparse.FileType('r'),
         ...                     default=sys.stdin)
         >>> parser.add_argument('outfile', nargs='?', type=argparse.FileType('w'),
         ...                     default=sys.stdout)
         >>> parser.parse_args(['input.txt', 'output.txt'])
         Namespace(infile=<open file 'input.txt', mode 'r' at 0x...>,
                   outfile=<open file 'output.txt', mode 'w' at 0x...>)
         >>> parser.parse_args([])
         Namespace(infile=<open file '<stdin>', mode 'r' at 0x...>,
                   outfile=<open file '<stdout>', mode 'w' at 0x...>)

   * `'*''.  All command-line arguments present are gathered into a
     list.  Note that it generally doesn’t make much sense to have
     more than one positional argument with `nargs='*'', but multiple
     optional arguments with `nargs='*'' is possible.  For example:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--foo', nargs='*')
         >>> parser.add_argument('--bar', nargs='*')
         >>> parser.add_argument('baz', nargs='*')
         >>> parser.parse_args('a b --foo x y --bar 1 2'.split())
         Namespace(bar=['1', '2'], baz=['a', 'b'], foo=['x', 'y'])

   * `'+''. Just like `'*'', all command-line args present are gathered
     into a list.  Additionally, an error message will be generated if
     there wasn’t at least one command-line argument present.  For
     example:

         >>> parser = argparse.ArgumentParser(prog='PROG')
         >>> parser.add_argument('foo', nargs='+')
         >>> parser.parse_args(['a', 'b'])
         Namespace(foo=['a', 'b'])
         >>> parser.parse_args([])
         usage: PROG [-h] foo [foo ...]
         PROG: error: too few arguments

   * `argparse.REMAINDER'.  All the remaining command-line arguments
     are gathered into a list.  This is commonly useful for command
     line utilities that dispatch to other command line utilities:

         >>> parser = argparse.ArgumentParser(prog='PROG')
         >>> parser.add_argument('--foo')
         >>> parser.add_argument('command')
         >>> parser.add_argument('args', nargs=argparse.REMAINDER)
         >>> print parser.parse_args('--foo B cmd --arg1 XX ZZ'.split())
         Namespace(args=['--arg1', 'XX', 'ZZ'], command='cmd', foo='B')

If the `nargs' keyword argument is not provided, the number of
arguments consumed is determined by the *Note action: 124b.  Generally
this means a single command-line argument will be consumed and a single
item (not a list) will be produced.


File: python.info,  Node: const,  Next: default,  Prev: nargs,  Up: The add_argument method

5.15.4.21 const
...............

The `const' argument of *Note add_argument(): 1234. is used to hold
constant values that are not read from the command line but are
required for the various *Note ArgumentParser: 1232. actions.  The two
most common uses of it are:

   * When *Note add_argument(): 1234. is called with
     `action='store_const'' or `action='append_const''.  These actions
     add the `const' value to one of the attributes of the object
     returned by *Note parse_args(): 1235. See the *Note action: 124b.
     description for examples.

   * When *Note add_argument(): 1234. is called with option strings
     (like `-f' or `--foo') and `nargs='?''.  This creates an optional
     argument that can be followed by zero or one command-line
     arguments.  When parsing the command line, if the option string is
     encountered with no command-line argument following it, the value
     of `const' will be assumed instead.  See the *Note nargs: 124c.
     description for examples.

With the `'store_const'' and `'append_const'' actions, the `const'
keyword argument must be given.  For other actions, it defaults to
`None'.


File: python.info,  Node: default,  Next: type,  Prev: const,  Up: The add_argument method

5.15.4.22 default
.................

All optional arguments and some positional arguments may be omitted at
the command line.  The `default' keyword argument of *Note
add_argument(): 1234, whose value defaults to `None', specifies what
value should be used if the command-line argument is not present.  For
optional arguments, the `default' value is used when the option string
was not present at the command line:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo', default=42)
    >>> parser.parse_args(['--foo', '2'])
    Namespace(foo='2')
    >>> parser.parse_args([])
    Namespace(foo=42)

If the `default' value is a string, the parser parses the value as if it
were a command-line argument.  In particular, the parser applies any
*Note type: 124f.  conversion argument, if provided, before setting the
attribute on the *Note Namespace: 1237. return value.  Otherwise, the
parser uses the value as is:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--length', default='10', type=int)
    >>> parser.add_argument('--width', default=10.5, type=int)
    >>> parser.parse_args()
    Namespace(length=10, width=10.5)

For positional arguments with *Note nargs: 124c. equal to `?' or `*',
the `default' value is used when no command-line argument was present:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('foo', nargs='?', default=42)
    >>> parser.parse_args(['a'])
    Namespace(foo='a')
    >>> parser.parse_args([])
    Namespace(foo=42)

Providing `default=argparse.SUPPRESS' causes no attribute to be added
if the command-line argument was not present.:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo', default=argparse.SUPPRESS)
    >>> parser.parse_args([])
    Namespace()
    >>> parser.parse_args(['--foo', '1'])
    Namespace(foo='1')


File: python.info,  Node: type,  Next: choices,  Prev: default,  Up: The add_argument method

5.15.4.23 type
..............

By default, *Note ArgumentParser: 1232. objects read command-line
arguments in as simple strings. However, quite often the command-line
string should instead be interpreted as another type, like a *Note
float: 1eb. or *Note int: 1f2.  The `type' keyword argument of *Note
add_argument(): 1234. allows any necessary type-checking and type
conversions to be performed.  Common built-in types and functions can
be used directly as the value of the `type' argument:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('foo', type=int)
    >>> parser.add_argument('bar', type=file)
    >>> parser.parse_args('2 temp.txt'.split())
    Namespace(bar=<open file 'temp.txt', mode 'r' at 0x...>, foo=2)

See the section on the *Note default: 124e. keyword argument for
information on when the `type' argument is applied to default arguments.

To ease the use of various types of files, the argparse module provides
the factory FileType which takes the `mode=' and `bufsize=' arguments
of the `file' object.  For example, `FileType('w')' can be used to
create a writable file:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('bar', type=argparse.FileType('w'))
    >>> parser.parse_args(['out.txt'])
    Namespace(bar=<open file 'out.txt', mode 'w' at 0x...>)

`type=' can take any callable that takes a single string argument and
returns the converted value:

    >>> def perfect_square(string):
    ...     value = int(string)
    ...     sqrt = math.sqrt(value)
    ...     if sqrt != int(sqrt):
    ...         msg = "%r is not a perfect square" % string
    ...         raise argparse.ArgumentTypeError(msg)
    ...     return value
    ...
    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('foo', type=perfect_square)
    >>> parser.parse_args(['9'])
    Namespace(foo=9)
    >>> parser.parse_args(['7'])
    usage: PROG [-h] foo
    PROG: error: argument foo: '7' is not a perfect square

The *Note choices: 1250. keyword argument may be more convenient for
type checkers that simply check against a range of values:

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('foo', type=int, choices=xrange(5, 10))
    >>> parser.parse_args(['7'])
    Namespace(foo=7)
    >>> parser.parse_args(['11'])
    usage: PROG [-h] {5,6,7,8,9}
    PROG: error: argument foo: invalid choice: 11 (choose from 5, 6, 7, 8, 9)

See the *Note choices: 1250. section for more details.


File: python.info,  Node: choices,  Next: required,  Prev: type,  Up: The add_argument method

5.15.4.24 choices
.................

Some command-line arguments should be selected from a restricted set of
values.  These can be handled by passing a container object as the
`choices' keyword argument to *Note add_argument(): 1234.  When the
command line is parsed, argument values will be checked, and an error
message will be displayed if the argument was not one of the acceptable
values:

    >>> parser = argparse.ArgumentParser(prog='game.py')
    >>> parser.add_argument('move', choices=['rock', 'paper', 'scissors'])
    >>> parser.parse_args(['rock'])
    Namespace(move='rock')
    >>> parser.parse_args(['fire'])
    usage: game.py [-h] {rock,paper,scissors}
    game.py: error: argument move: invalid choice: 'fire' (choose from 'rock',
    'paper', 'scissors')

Note that inclusion in the `choices' container is checked after any
*Note type: 124f.  conversions have been performed, so the type of the
objects in the `choices' container should match the *Note type: 124f.
specified:

    >>> parser = argparse.ArgumentParser(prog='doors.py')
    >>> parser.add_argument('door', type=int, choices=range(1, 4))
    >>> print(parser.parse_args(['3']))
    Namespace(door=3)
    >>> parser.parse_args(['4'])
    usage: doors.py [-h] {1,2,3}
    doors.py: error: argument door: invalid choice: 4 (choose from 1, 2, 3)

Any object that supports the `in' operator can be passed as the
`choices' value, so *Note dict: 319. objects, *Note set: 382. objects,
custom containers, etc. are all supported.


File: python.info,  Node: required,  Next: help,  Prev: choices,  Up: The add_argument method

5.15.4.25 required
..................

In general, the *Note argparse: d. module assumes that flags like `-f'
and `--bar' indicate `optional' arguments, which can always be omitted
at the command line.  To make an option `required', `True' can be
specified for the `required=' keyword argument to *Note add_argument():
1234.:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo', required=True)
    >>> parser.parse_args(['--foo', 'BAR'])
    Namespace(foo='BAR')
    >>> parser.parse_args([])
    usage: argparse.py [-h] [--foo FOO]
    argparse.py: error: option --foo is required

As the example shows, if an option is marked as `required', *Note
parse_args(): 1235. will report an error if that option is not present
at the command line.

     Note: Required options are generally considered bad form because
     users expect `options' to be `optional', and thus they should be
     avoided when possible.


File: python.info,  Node: help,  Next: metavar,  Prev: required,  Up: The add_argument method

5.15.4.26 help
..............

The `help' value is a string containing a brief description of the
argument.  When a user requests help (usually by using `-h' or `--help'
at the command line), these `help' descriptions will be displayed with
each argument:

    >>> parser = argparse.ArgumentParser(prog='frobble')
    >>> parser.add_argument('--foo', action='store_true',
    ...                     help='foo the bars before frobbling')
    >>> parser.add_argument('bar', nargs='+',
    ...                     help='one of the bars to be frobbled')
    >>> parser.parse_args(['-h'])
    usage: frobble [-h] [--foo] bar [bar ...]

    positional arguments:
     bar     one of the bars to be frobbled

    optional arguments:
     -h, --help  show this help message and exit
     --foo   foo the bars before frobbling

The `help' strings can include various format specifiers to avoid
repetition of things like the program name or the argument *Note
default: 124e.  The available specifiers include the program name,
`%(prog)s' and most keyword arguments to *Note add_argument(): 1234,
e.g. `%(default)s', `%(type)s', etc.:

    >>> parser = argparse.ArgumentParser(prog='frobble')
    >>> parser.add_argument('bar', nargs='?', type=int, default=42,
    ...                     help='the bar to %(prog)s (default: %(default)s)')
    >>> parser.print_help()
    usage: frobble [-h] [bar]

    positional arguments:
     bar     the bar to frobble (default: 42)

    optional arguments:
     -h, --help  show this help message and exit

*Note argparse: d. supports silencing the help entry for certain
options, by setting the `help' value to `argparse.SUPPRESS':

    >>> parser = argparse.ArgumentParser(prog='frobble')
    >>> parser.add_argument('--foo', help=argparse.SUPPRESS)
    >>> parser.print_help()
    usage: frobble [-h]

    optional arguments:
      -h, --help  show this help message and exit


File: python.info,  Node: metavar,  Next: dest,  Prev: help,  Up: The add_argument method

5.15.4.27 metavar
.................

When *Note ArgumentParser: 1232. generates help messages, it needs some
way to refer to each expected argument.  By default, ArgumentParser
objects use the *Note dest: 1254.  value as the “name” of each
object.  By default, for positional argument actions, the *Note dest:
1254. value is used directly, and for optional argument actions, the
*Note dest: 1254. value is uppercased.  So, a single positional
argument with `dest='bar'' will be referred to as `bar'. A single
optional argument `--foo' that should be followed by a single
command-line argument will be referred to as `FOO'.  An example:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo')
    >>> parser.add_argument('bar')
    >>> parser.parse_args('X --foo Y'.split())
    Namespace(bar='X', foo='Y')
    >>> parser.print_help()
    usage:  [-h] [--foo FOO] bar

    positional arguments:
     bar

    optional arguments:
     -h, --help  show this help message and exit
     --foo FOO

An alternative name can be specified with `metavar':

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo', metavar='YYY')
    >>> parser.add_argument('bar', metavar='XXX')
    >>> parser.parse_args('X --foo Y'.split())
    Namespace(bar='X', foo='Y')
    >>> parser.print_help()
    usage:  [-h] [--foo YYY] XXX

    positional arguments:
     XXX

    optional arguments:
     -h, --help  show this help message and exit
     --foo YYY

Note that `metavar' only changes the `displayed' name - the name of the
attribute on the *Note parse_args(): 1235. object is still determined
by the *Note dest: 1254. value.

Different values of `nargs' may cause the metavar to be used multiple
times.  Providing a tuple to `metavar' specifies a different display
for each of the arguments:

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('-x', nargs=2)
    >>> parser.add_argument('--foo', nargs=2, metavar=('bar', 'baz'))
    >>> parser.print_help()
    usage: PROG [-h] [-x X X] [--foo bar baz]

    optional arguments:
     -h, --help     show this help message and exit
     -x X X
     --foo bar baz


File: python.info,  Node: dest,  Next: Action classes,  Prev: metavar,  Up: The add_argument method

5.15.4.28 dest
..............

Most *Note ArgumentParser: 1232. actions add some value as an attribute
of the object returned by *Note parse_args(): 1235.  The name of this
attribute is determined by the `dest' keyword argument of *Note
add_argument(): 1234.  For positional argument actions, `dest' is
normally supplied as the first argument to *Note add_argument(): 1234.:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('bar')
    >>> parser.parse_args(['XXX'])
    Namespace(bar='XXX')

For optional argument actions, the value of `dest' is normally inferred
from the option strings.  *Note ArgumentParser: 1232. generates the
value of `dest' by taking the first long option string and stripping
away the initial `--' string.  If no long option strings were supplied,
`dest' will be derived from the first short option string by stripping
the initial `-' character.  Any internal `-' characters will be
converted to `_' characters to make sure the string is a valid
attribute name.  The examples below illustrate this behavior:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('-f', '--foo-bar', '--foo')
    >>> parser.add_argument('-x', '-y')
    >>> parser.parse_args('-f 1 -x 2'.split())
    Namespace(foo_bar='1', x='2')
    >>> parser.parse_args('--foo 1 -y 2'.split())
    Namespace(foo_bar='1', x='2')

`dest' allows a custom attribute name to be provided:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo', dest='bar')
    >>> parser.parse_args('--foo XXX'.split())
    Namespace(bar='XXX')


File: python.info,  Node: Action classes,  Prev: dest,  Up: The add_argument method

5.15.4.29 Action classes
........................

Action classes implement the Action API, a callable which returns a
callable which processes arguments from the command-line. Any object
which follows this API may be passed as the `action' parameter to
`add_argument()'.

 -- Class: argparse.Action (option_strings, dest, nargs=None,
          const=None, default=None, type=None, choices=None,
          required=False, help=None, metavar=None)

Action objects are used by an ArgumentParser to represent the
information needed to parse a single argument from one or more strings
from the command line. The Action class must accept the two positional
arguments plus any keyword arguments passed to *Note
ArgumentParser.add_argument(): 1234. except for the `action' itself.

Instances of Action (or return value of any callable to the `action'
parameter) should have attributes “dest”, “option_strings”,
“default”, “type”, “required”, “help”, etc. defined.
The easiest way to ensure these attributes are defined is to call
`Action.__init__'.

Action instances should be callable, so subclasses must override the
`__call__' method, which should accept four parameters:

   * `parser' - The ArgumentParser object which contains this action.

   * `namespace' - The *Note Namespace: 1237. object that will be
     returned by *Note parse_args(): 1235.  Most actions add an
     attribute to this object using *Note setattr(): 8a2.

   * `values' - The associated command-line arguments, with any type
     conversions applied.  Type conversions are specified with the
     *Note type: 124f. keyword argument to *Note add_argument(): 1234.

   * `option_string' - The option string that was used to invoke this
     action.  The `option_string' argument is optional, and will be
     absent if the action is associated with a positional argument.

The `__call__' method may perform arbitrary actions, but will typically
set attributes on the `namespace' based on `dest' and `values'.


File: python.info,  Node: The parse_args method,  Next: Other utilities,  Prev: The add_argument method,  Up: argparse — Parser for command-line options arguments and sub-commands

5.15.4.30 The parse_args() method
.................................

 -- Method: ArgumentParser.parse_args (args=None, namespace=None)
     Convert argument strings to objects and assign them as attributes
     of the namespace.  Return the populated namespace.

     Previous calls to *Note add_argument(): 1234. determine exactly
     what objects are created and how they are assigned. See the
     documentation for *Note add_argument(): 1234. for details.

     By default, the argument strings are taken from *Note sys.argv:
     65a, and a new empty *Note Namespace: 1237. object is created for
     the attributes.

* Menu:

* Option value syntax::
* Invalid arguments::
* Arguments containing -::
* Argument abbreviations (prefix matching): Argument abbreviations prefix matching.
* Beyond sys.argv: Beyond sys argv.
* The Namespace object::


File: python.info,  Node: Option value syntax,  Next: Invalid arguments,  Up: The parse_args method

5.15.4.31 Option value syntax
.............................

The *Note parse_args(): 1235. method supports several ways of
specifying the value of an option (if it takes one).  In the simplest
case, the option and its value are passed as two separate arguments:

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('-x')
    >>> parser.add_argument('--foo')
    >>> parser.parse_args(['-x', 'X'])
    Namespace(foo=None, x='X')
    >>> parser.parse_args(['--foo', 'FOO'])
    Namespace(foo='FOO', x=None)

For long options (options with names longer than a single character),
the option and value can also be passed as a single command-line
argument, using `=' to separate them:

    >>> parser.parse_args(['--foo=FOO'])
    Namespace(foo='FOO', x=None)

For short options (options only one character long), the option and its
value can be concatenated:

    >>> parser.parse_args(['-xX'])
    Namespace(foo=None, x='X')

Several short options can be joined together, using only a single `-'
prefix, as long as only the last option (or none of them) requires a
value:

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('-x', action='store_true')
    >>> parser.add_argument('-y', action='store_true')
    >>> parser.add_argument('-z')
    >>> parser.parse_args(['-xyzZ'])
    Namespace(x=True, y=True, z='Z')


File: python.info,  Node: Invalid arguments,  Next: Arguments containing -,  Prev: Option value syntax,  Up: The parse_args method

5.15.4.32 Invalid arguments
...........................

While parsing the command line, *Note parse_args(): 1235. checks for a
variety of errors, including ambiguous options, invalid types, invalid
options, wrong number of positional arguments, etc.  When it encounters
such an error, it exits and prints the error along with a usage message:

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('--foo', type=int)
    >>> parser.add_argument('bar', nargs='?')

    >>> # invalid type
    >>> parser.parse_args(['--foo', 'spam'])
    usage: PROG [-h] [--foo FOO] [bar]
    PROG: error: argument --foo: invalid int value: 'spam'

    >>> # invalid option
    >>> parser.parse_args(['--bar'])
    usage: PROG [-h] [--foo FOO] [bar]
    PROG: error: no such option: --bar

    >>> # wrong number of arguments
    >>> parser.parse_args(['spam', 'badger'])
    usage: PROG [-h] [--foo FOO] [bar]
    PROG: error: extra arguments found: badger


File: python.info,  Node: Arguments containing -,  Next: Argument abbreviations prefix matching,  Prev: Invalid arguments,  Up: The parse_args method

5.15.4.33 Arguments containing `-'
..................................

The *Note parse_args(): 1235. method attempts to give errors whenever
the user has clearly made a mistake, but some situations are inherently
ambiguous.  For example, the command-line argument `-1' could either be
an attempt to specify an option or an attempt to provide a positional
argument.  The *Note parse_args(): 1235. method is cautious here:
positional arguments may only begin with `-' if they look like negative
numbers and there are no options in the parser that look like negative
numbers:

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('-x')
    >>> parser.add_argument('foo', nargs='?')

    >>> # no negative number options, so -1 is a positional argument
    >>> parser.parse_args(['-x', '-1'])
    Namespace(foo=None, x='-1')

    >>> # no negative number options, so -1 and -5 are positional arguments
    >>> parser.parse_args(['-x', '-1', '-5'])
    Namespace(foo='-5', x='-1')

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('-1', dest='one')
    >>> parser.add_argument('foo', nargs='?')

    >>> # negative number options present, so -1 is an option
    >>> parser.parse_args(['-1', 'X'])
    Namespace(foo=None, one='X')

    >>> # negative number options present, so -2 is an option
    >>> parser.parse_args(['-2'])
    usage: PROG [-h] [-1 ONE] [foo]
    PROG: error: no such option: -2

    >>> # negative number options present, so both -1s are options
    >>> parser.parse_args(['-1', '-1'])
    usage: PROG [-h] [-1 ONE] [foo]
    PROG: error: argument -1: expected one argument

If you have positional arguments that must begin with `-' and don’t
look like negative numbers, you can insert the pseudo-argument `'--''
which tells *Note parse_args(): 1235. that everything after that is a
positional argument:

    >>> parser.parse_args(['--', '-f'])
    Namespace(foo='-f', one=None)


File: python.info,  Node: Argument abbreviations prefix matching,  Next: Beyond sys argv,  Prev: Arguments containing -,  Up: The parse_args method

5.15.4.34 Argument abbreviations (prefix matching)
..................................................

The *Note parse_args(): 1235. method allows long options to be
abbreviated to a prefix, if the abbreviation is unambiguous (the prefix
matches a unique option):

    >>> parser = argparse.ArgumentParser(prog='PROG')
    >>> parser.add_argument('-bacon')
    >>> parser.add_argument('-badger')
    >>> parser.parse_args('-bac MMM'.split())
    Namespace(bacon='MMM', badger=None)
    >>> parser.parse_args('-bad WOOD'.split())
    Namespace(bacon=None, badger='WOOD')
    >>> parser.parse_args('-ba BA'.split())
    usage: PROG [-h] [-bacon BACON] [-badger BADGER]
    PROG: error: ambiguous option: -ba could match -badger, -bacon

An error is produced for arguments that could produce more than one
options.


File: python.info,  Node: Beyond sys argv,  Next: The Namespace object,  Prev: Argument abbreviations prefix matching,  Up: The parse_args method

5.15.4.35 Beyond `sys.argv'
...........................

Sometimes it may be useful to have an ArgumentParser parse arguments
other than those of *Note sys.argv: 65a.  This can be accomplished by
passing a list of strings to *Note parse_args(): 1235.  This is useful
for testing at the interactive prompt:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument(
    ...     'integers', metavar='int', type=int, choices=xrange(10),
    ...     nargs='+', help='an integer in the range 0..9')
    >>> parser.add_argument(
    ...     '--sum', dest='accumulate', action='store_const', const=sum,
    ...     default=max, help='sum the integers (default: find the max)')
    >>> parser.parse_args(['1', '2', '3', '4'])
    Namespace(accumulate=<built-in function max>, integers=[1, 2, 3, 4])
    >>> parser.parse_args(['1', '2', '3', '4', '--sum'])
    Namespace(accumulate=<built-in function sum>, integers=[1, 2, 3, 4])


File: python.info,  Node: The Namespace object,  Prev: Beyond sys argv,  Up: The parse_args method

5.15.4.36 The Namespace object
..............................

 -- Class: argparse.Namespace
     Simple class used by default by *Note parse_args(): 1235. to create
     an object holding attributes and return it.

This class is deliberately simple, just an *Note object: 1f1. subclass
with a readable string representation. If you prefer to have dict-like
view of the attributes, you can use the standard Python idiom, *Note
vars(): 5b3.:

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo')
    >>> args = parser.parse_args(['--foo', 'BAR'])
    >>> vars(args)
    {'foo': 'BAR'}

It may also be useful to have an *Note ArgumentParser: 1232. assign
attributes to an already existing object, rather than a new *Note
Namespace: 1237. object.  This can be achieved by specifying the
`namespace=' keyword argument:

    >>> class C(object):
    ...     pass
    ...
    >>> c = C()
    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo')
    >>> parser.parse_args(args=['--foo', 'BAR'], namespace=c)
    >>> c.foo
    'BAR'


File: python.info,  Node: Other utilities,  Next: Upgrading optparse code,  Prev: The parse_args method,  Up: argparse — Parser for command-line options arguments and sub-commands

5.15.4.37 Other utilities
.........................

* Menu:

* Sub-commands::
* FileType objects::
* Argument groups::
* Mutual exclusion::
* Parser defaults::
* Printing help::
* Partial parsing::
* Customizing file parsing::
* Exiting methods::


File: python.info,  Node: Sub-commands,  Next: FileType objects,  Up: Other utilities

5.15.4.38 Sub-commands
......................

 -- Method: ArgumentParser.add_subparsers ([title][, description][,
          prog][, parser_class][, action][, option_string][, dest][,
          help][, metavar])
     Many programs split up their functionality into a number of
     sub-commands, for example, the `svn' program can invoke
     sub-commands like `svn checkout', `svn update', and `svn commit'.
     Splitting up functionality this way can be a particularly good
     idea when a program performs several different functions which
     require different kinds of command-line arguments.  *Note
     ArgumentParser: 1232. supports the creation of such sub-commands
     with the *Note add_subparsers(): 1261. method.  The *Note
     add_subparsers(): 1261. method is normally called with no
     arguments and returns a special action object.  This object has a
     single method, `add_parser()', which takes a command name and any
     *Note ArgumentParser: 1232. constructor arguments, and returns an
     *Note ArgumentParser: 1232. object that can be modified as usual.

     Description of parameters:

        * title - title for the sub-parser group in help output; by
          default “subcommands” if description is provided,
          otherwise uses title for positional arguments

        * description - description for the sub-parser group in help
          output, by default `None'

        * prog - usage information that will be displayed with
          sub-command help, by default the name of the program and any
          positional arguments before the subparser argument

        * parser_class - class which will be used to create sub-parser
          instances, by default the class of the current parser (e.g.
          ArgumentParser)

        * *Note action: 124b. - the basic type of action to be taken
          when this argument is encountered at the command line

        * *Note dest: 1254. - name of the attribute under which
          sub-command name will be stored; by default `None' and no
          value is stored

        * *Note help: 1252. - help for sub-parser group in help output,
          by default `None'

        * *Note metavar: 1253. - string presenting available
          sub-commands in help; by default it is `None' and presents
          sub-commands in form {cmd1, cmd2, ..}

     Some example usage:

         >>> # create the top-level parser
         >>> parser = argparse.ArgumentParser(prog='PROG')
         >>> parser.add_argument('--foo', action='store_true', help='foo help')
         >>> subparsers = parser.add_subparsers(help='sub-command help')
         >>>
         >>> # create the parser for the "a" command
         >>> parser_a = subparsers.add_parser('a', help='a help')
         >>> parser_a.add_argument('bar', type=int, help='bar help')
         >>>
         >>> # create the parser for the "b" command
         >>> parser_b = subparsers.add_parser('b', help='b help')
         >>> parser_b.add_argument('--baz', choices='XYZ', help='baz help')
         >>>
         >>> # parse some argument lists
         >>> parser.parse_args(['a', '12'])
         Namespace(bar=12, foo=False)
         >>> parser.parse_args(['--foo', 'b', '--baz', 'Z'])
         Namespace(baz='Z', foo=True)

     Note that the object returned by *Note parse_args(): 1235. will
     only contain attributes for the main parser and the subparser that
     was selected by the command line (and not any other subparsers).
     So in the example above, when the `a' command is specified, only
     the `foo' and `bar' attributes are present, and when the `b'
     command is specified, only the `foo' and `baz' attributes are
     present.

     Similarly, when a help message is requested from a subparser, only
     the help for that particular parser will be printed.  The help
     message will not include parent parser or sibling parser messages.
     (A help message for each subparser command, however, can be given
     by supplying the `help=' argument to `add_parser()' as above.)

         >>> parser.parse_args(['--help'])
         usage: PROG [-h] [--foo] {a,b} ...

         positional arguments:
           {a,b}   sub-command help
             a     a help
             b     b help

         optional arguments:
           -h, --help  show this help message and exit
           --foo   foo help

         >>> parser.parse_args(['a', '--help'])
         usage: PROG a [-h] bar

         positional arguments:
           bar     bar help

         optional arguments:
           -h, --help  show this help message and exit

         >>> parser.parse_args(['b', '--help'])
         usage: PROG b [-h] [--baz {X,Y,Z}]

         optional arguments:
           -h, --help     show this help message and exit
           --baz {X,Y,Z}  baz help

     The *Note add_subparsers(): 1261. method also supports `title' and
     `description' keyword arguments.  When either is present, the
     subparser’s commands will appear in their own group in the help
     output.  For example:

         >>> parser = argparse.ArgumentParser()
         >>> subparsers = parser.add_subparsers(title='subcommands',
         ...                                    description='valid subcommands',
         ...                                    help='additional help')
         >>> subparsers.add_parser('foo')
         >>> subparsers.add_parser('bar')
         >>> parser.parse_args(['-h'])
         usage:  [-h] {foo,bar} ...

         optional arguments:
           -h, --help  show this help message and exit

         subcommands:
           valid subcommands

           {foo,bar}   additional help

     One particularly effective way of handling sub-commands is to
     combine the use of the *Note add_subparsers(): 1261. method with
     calls to *Note set_defaults(): 1248. so that each subparser knows
     which Python function it should execute.  For example:

         >>> # sub-command functions
         >>> def foo(args):
         ...     print args.x * args.y
         ...
         >>> def bar(args):
         ...     print '((%s))' % args.z
         ...
         >>> # create the top-level parser
         >>> parser = argparse.ArgumentParser()
         >>> subparsers = parser.add_subparsers()
         >>>
         >>> # create the parser for the "foo" command
         >>> parser_foo = subparsers.add_parser('foo')
         >>> parser_foo.add_argument('-x', type=int, default=1)
         >>> parser_foo.add_argument('y', type=float)
         >>> parser_foo.set_defaults(func=foo)
         >>>
         >>> # create the parser for the "bar" command
         >>> parser_bar = subparsers.add_parser('bar')
         >>> parser_bar.add_argument('z')
         >>> parser_bar.set_defaults(func=bar)
         >>>
         >>> # parse the args and call whatever function was selected
         >>> args = parser.parse_args('foo 1 -x 2'.split())
         >>> args.func(args)
         2.0
         >>>
         >>> # parse the args and call whatever function was selected
         >>> args = parser.parse_args('bar XYZYX'.split())
         >>> args.func(args)
         ((XYZYX))

     This way, you can let *Note parse_args(): 1235. do the job of
     calling the appropriate function after argument parsing is
     complete.  Associating functions with actions like this is
     typically the easiest way to handle the different actions for each
     of your subparsers.  However, if it is necessary to check the name
     of the subparser that was invoked, the `dest' keyword argument to
     the *Note add_subparsers(): 1261. call will work:

         >>> parser = argparse.ArgumentParser()
         >>> subparsers = parser.add_subparsers(dest='subparser_name')
         >>> subparser1 = subparsers.add_parser('1')
         >>> subparser1.add_argument('-x')
         >>> subparser2 = subparsers.add_parser('2')
         >>> subparser2.add_argument('y')
         >>> parser.parse_args(['2', 'frobble'])
         Namespace(subparser_name='2', y='frobble')


File: python.info,  Node: FileType objects,  Next: Argument groups,  Prev: Sub-commands,  Up: Other utilities

5.15.4.39 FileType objects
..........................

 -- Class: argparse.FileType (mode='r', bufsize=None)
     The *Note FileType: 1d6. factory creates objects that can be
     passed to the type argument of *Note
     ArgumentParser.add_argument(): 1234.  Arguments that have *Note
     FileType: 1d6. objects as their type will open command-line
     arguments as files with the requested modes and buffer sizes:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--output', type=argparse.FileType('wb', 0))
         >>> parser.parse_args(['--output', 'out'])
         Namespace(output=<open file 'out', mode 'wb' at 0x...>)

     FileType objects understand the pseudo-argument `'-'' and
     automatically convert this into `sys.stdin' for readable *Note
     FileType: 1d6. objects and `sys.stdout' for writable *Note
     FileType: 1d6. objects:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('infile', type=argparse.FileType('r'))
         >>> parser.parse_args(['-'])
         Namespace(infile=<open file '<stdin>', mode 'r' at 0x...>)


File: python.info,  Node: Argument groups,  Next: Mutual exclusion,  Prev: FileType objects,  Up: Other utilities

5.15.4.40 Argument groups
.........................

 -- Method: ArgumentParser.add_argument_group (title=None,
          description=None)
     By default, *Note ArgumentParser: 1232. groups command-line
     arguments into “positional arguments” and “optional
     arguments” when displaying help messages. When there is a better
     conceptual grouping of arguments than this default one,
     appropriate groups can be created using the *Note
     add_argument_group(): 1264. method:

         >>> parser = argparse.ArgumentParser(prog='PROG', add_help=False)
         >>> group = parser.add_argument_group('group')
         >>> group.add_argument('--foo', help='foo help')
         >>> group.add_argument('bar', help='bar help')
         >>> parser.print_help()
         usage: PROG [--foo FOO] bar

         group:
           bar    bar help
           --foo FOO  foo help

     The *Note add_argument_group(): 1264. method returns an argument
     group object which has an *Note add_argument(): 1234. method just
     like a regular *Note ArgumentParser: 1232.  When an argument is
     added to the group, the parser treats it just like a normal
     argument, but displays the argument in a separate group for help
     messages.  The *Note add_argument_group(): 1264. method accepts
     `title' and `description' arguments which can be used to customize
     this display:

         >>> parser = argparse.ArgumentParser(prog='PROG', add_help=False)
         >>> group1 = parser.add_argument_group('group1', 'group1 description')
         >>> group1.add_argument('foo', help='foo help')
         >>> group2 = parser.add_argument_group('group2', 'group2 description')
         >>> group2.add_argument('--bar', help='bar help')
         >>> parser.print_help()
         usage: PROG [--bar BAR] foo

         group1:
           group1 description

           foo    foo help

         group2:
           group2 description

           --bar BAR  bar help

     Note that any arguments not in your user-defined groups will end
     up back in the usual “positional arguments” and “optional
     arguments” sections.


File: python.info,  Node: Mutual exclusion,  Next: Parser defaults,  Prev: Argument groups,  Up: Other utilities

5.15.4.41 Mutual exclusion
..........................

 -- Method: ArgumentParser.add_mutually_exclusive_group (required=False)
     Create a mutually exclusive group. *Note argparse: d. will make
     sure that only one of the arguments in the mutually exclusive
     group was present on the command line:

         >>> parser = argparse.ArgumentParser(prog='PROG')
         >>> group = parser.add_mutually_exclusive_group()
         >>> group.add_argument('--foo', action='store_true')
         >>> group.add_argument('--bar', action='store_false')
         >>> parser.parse_args(['--foo'])
         Namespace(bar=True, foo=True)
         >>> parser.parse_args(['--bar'])
         Namespace(bar=False, foo=False)
         >>> parser.parse_args(['--foo', '--bar'])
         usage: PROG [-h] [--foo | --bar]
         PROG: error: argument --bar: not allowed with argument --foo

     The *Note add_mutually_exclusive_group(): 1266. method also
     accepts a `required' argument, to indicate that at least one of
     the mutually exclusive arguments is required:

         >>> parser = argparse.ArgumentParser(prog='PROG')
         >>> group = parser.add_mutually_exclusive_group(required=True)
         >>> group.add_argument('--foo', action='store_true')
         >>> group.add_argument('--bar', action='store_false')
         >>> parser.parse_args([])
         usage: PROG [-h] (--foo | --bar)
         PROG: error: one of the arguments --foo --bar is required

     Note that currently mutually exclusive argument groups do not
     support the `title' and `description' arguments of *Note
     add_argument_group(): 1264.


File: python.info,  Node: Parser defaults,  Next: Printing help,  Prev: Mutual exclusion,  Up: Other utilities

5.15.4.42 Parser defaults
.........................

 -- Method: ArgumentParser.set_defaults (**kwargs)
     Most of the time, the attributes of the object returned by *Note
     parse_args(): 1235.  will be fully determined by inspecting the
     command-line arguments and the argument actions.  *Note
     set_defaults(): 1248. allows some additional attributes that are
     determined without any inspection of the command line to be added:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('foo', type=int)
         >>> parser.set_defaults(bar=42, baz='badger')
         >>> parser.parse_args(['736'])
         Namespace(bar=42, baz='badger', foo=736)

     Note that parser-level defaults always override argument-level
     defaults:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--foo', default='bar')
         >>> parser.set_defaults(foo='spam')
         >>> parser.parse_args([])
         Namespace(foo='spam')

     Parser-level defaults can be particularly useful when working with
     multiple parsers.  See the *Note add_subparsers(): 1261. method
     for an example of this type.

 -- Method: ArgumentParser.get_default (dest)
     Get the default value for a namespace attribute, as set by either
     *Note add_argument(): 1234. or by *Note set_defaults(): 1248.:

         >>> parser = argparse.ArgumentParser()
         >>> parser.add_argument('--foo', default='badger')
         >>> parser.get_default('foo')
         'badger'


File: python.info,  Node: Printing help,  Next: Partial parsing,  Prev: Parser defaults,  Up: Other utilities

5.15.4.43 Printing help
.......................

In most typical applications, *Note parse_args(): 1235. will take care
of formatting and printing any usage or error messages.  However,
several formatting methods are available:

 -- Method: ArgumentParser.print_usage (file=None)
     Print a brief description of how the *Note ArgumentParser: 1232.
     should be invoked on the command line.  If `file' is `None', *Note
     sys.stdout: 8b2. is assumed.

 -- Method: ArgumentParser.print_help (file=None)
     Print a help message, including the program usage and information
     about the arguments registered with the *Note ArgumentParser:
     1232.  If `file' is `None', *Note sys.stdout: 8b2. is assumed.

There are also variants of these methods that simply return a string
instead of printing it:

 -- Method: ArgumentParser.format_usage ()
     Return a string containing a brief description of how the *Note
     ArgumentParser: 1232. should be invoked on the command line.

 -- Method: ArgumentParser.format_help ()
     Return a string containing a help message, including the program
     usage and information about the arguments registered with the
     *Note ArgumentParser: 1232.


File: python.info,  Node: Partial parsing,  Next: Customizing file parsing,  Prev: Printing help,  Up: Other utilities

5.15.4.44 Partial parsing
.........................

 -- Method: ArgumentParser.parse_known_args (args=None, namespace=None)

Sometimes a script may only parse a few of the command-line arguments,
passing the remaining arguments on to another script or program. In
these cases, the *Note parse_known_args(): 126f. method can be useful.
It works much like *Note parse_args(): 1235. except that it does not
produce an error when extra arguments are present.  Instead, it returns
a two item tuple containing the populated namespace and the list of
remaining argument strings.

    >>> parser = argparse.ArgumentParser()
    >>> parser.add_argument('--foo', action='store_true')
    >>> parser.add_argument('bar')
    >>> parser.parse_known_args(['--foo', '--badger', 'BAR', 'spam'])
    (Namespace(bar='BAR', foo=True), ['--badger', 'spam'])

     Warning: *Note Prefix matching: 125b. rules apply to
     `parse_known_args()'. The parser may consume an option even if
     it’s just a prefix of one of its known options, instead of
     leaving it in the remaining arguments list.


File: python.info,  Node: Customizing file parsing,  Next: Exiting methods,  Prev: Partial parsing,  Up: Other utilities

5.15.4.45 Customizing file parsing
..................................

 -- Method: ArgumentParser.convert_arg_line_to_args (arg_line)
     Arguments that are read from a file (see the
     `fromfile_prefix_chars' keyword argument to the *Note
     ArgumentParser: 1232. constructor) are read one argument per line.
     *Note convert_arg_line_to_args(): 1247. can be overridden for
     fancier reading.

     This method takes a single argument `arg_line' which is a string
     read from the argument file.  It returns a list of arguments
     parsed from this string.  The method is called once per line read
     from the argument file, in order.

     A useful override of this method is one that treats each
     space-separated word as an argument:

         def convert_arg_line_to_args(self, arg_line):
             return arg_line.split()


File: python.info,  Node: Exiting methods,  Prev: Customizing file parsing,  Up: Other utilities

5.15.4.46 Exiting methods
.........................

 -- Method: ArgumentParser.exit (status=0, message=None)
     This method terminates the program, exiting with the specified
     `status' and, if given, it prints a `message' before that.

 -- Method: ArgumentParser.error (message)
     This method prints a usage message including the `message' to the
     standard error and terminates the program with a status code of 2.


File: python.info,  Node: Upgrading optparse code,  Prev: Other utilities,  Up: argparse — Parser for command-line options arguments and sub-commands

5.15.4.47 Upgrading optparse code
.................................

Originally, the *Note argparse: d. module had attempted to maintain
compatibility with *Note optparse: 128.  However, *Note optparse: 128.
was difficult to extend transparently, particularly with the changes
required to support the new `nargs=' specifiers and better usage
messages.  When most everything in *Note optparse: 128. had either been
copy-pasted over or monkey-patched, it no longer seemed practical to
try to maintain the backwards compatibility.

The *Note argparse: d. module improves on the standard library *Note
optparse: 128.  module in a number of ways including:

   * Handling positional arguments.

   * Supporting sub-commands.

   * Allowing alternative option prefixes like `+' and `/'.

   * Handling zero-or-more and one-or-more style arguments.

   * Producing more informative usage messages.

   * Providing a much simpler interface for custom `type' and `action'.

A partial upgrade path from *Note optparse: 128. to *Note argparse: d.:

   * Replace all *Note optparse.OptionParser.add_option(): 1275. calls
     with *Note ArgumentParser.add_argument(): 1234. calls.

   * Replace `(options, args) = parser.parse_args()' with `args =
     parser.parse_args()' and add additional *Note
     ArgumentParser.add_argument(): 1234.  calls for the positional
     arguments. Keep in mind that what was previously called `options',
     now in *Note argparse: d. context is called `args'.

   * Replace callback actions and the `callback_*' keyword arguments
     with `type' or `action' arguments.

   * Replace string names for `type' keyword arguments with the
     corresponding type objects (e.g. int, float, complex, etc).

   * Replace `optparse.Values' with *Note Namespace: 1237. and
     `optparse.OptionError' and `optparse.OptionValueError' with
     `ArgumentError'.

   * Replace strings with implicit arguments such as `%default' or
     `%prog' with the standard Python syntax to use dictionaries to
     format strings, that is, `%(default)s' and `%(prog)s'.

   * Replace the OptionParser constructor `version' argument with a
     call to `parser.add_argument('--version', action='version',
     version='<the version>')'.


File: python.info,  Node: optparse — Parser for command line options,  Next: getopt — C-style parser for command line options,  Prev: argparse — Parser for command-line options arguments and sub-commands,  Up: Generic Operating System Services

5.15.5 `optparse' — Parser for command line options
-----------------------------------------------------

New in version 2.3.

Deprecated since version 2.7: The *Note optparse: 128. module is
deprecated and will not be developed further; development will continue
with the *Note argparse: d. module.

`Source code:' Lib/optparse.py(1)

__________________________________________________________________

*Note optparse: 128. is a more convenient, flexible, and powerful
library for parsing command-line options than the old *Note getopt: df.
module.  *Note optparse: 128. uses a more declarative style of
command-line parsing: you create an instance of *Note OptionParser:
1278, populate it with options, and parse the command line. *Note
optparse: 128. allows users to specify options in the conventional
GNU/POSIX syntax, and additionally generates usage and help messages
for you.

Here’s an example of using *Note optparse: 128. in a simple script:

    from optparse import OptionParser
    ...
    parser = OptionParser()
    parser.add_option("-f", "--file", dest="filename",
                      help="write report to FILE", metavar="FILE")
    parser.add_option("-q", "--quiet",
                      action="store_false", dest="verbose", default=True,
                      help="don't print status messages to stdout")

    (options, args) = parser.parse_args()

With these few lines of code, users of your script can now do the
“usual thing” on the command-line, for example:

    <yourscript> --file=outfile -q

As it parses the command line, *Note optparse: 128. sets attributes of
the `options' object returned by `parse_args()' based on user-supplied
command-line values.  When `parse_args()' returns from parsing this
command line, `options.filename' will be `"outfile"' and
`options.verbose' will be `False'.  *Note optparse: 128. supports both
long and short options, allows short options to be merged together, and
allows options to be associated with their arguments in a variety of
ways.  Thus, the following command lines are all equivalent to the
above example:

    <yourscript> -f outfile --quiet
    <yourscript> --quiet --file outfile
    <yourscript> -q -foutfile
    <yourscript> -qfoutfile

Additionally, users can run one of

    <yourscript> -h
    <yourscript> --help

and *Note optparse: 128. will print out a brief summary of your
script’s options:

    Usage: <yourscript> [options]

    Options:
      -h, --help            show this help message and exit
      -f FILE, --file=FILE  write report to FILE
      -q, --quiet           don't print status messages to stdout

where the value of `yourscript' is determined at runtime (normally from
`sys.argv[0]').

* Menu:

* Background::
* Tutorial::
* Reference Guide::
* Option Callbacks::
* Extending optparse::

---------- Footnotes ----------

(1) https://hg.python.org/cpython/file/2.7/Lib/optparse.py


File: python.info,  Node: Background,  Next: Tutorial,  Up: optparse — Parser for command line options

5.15.5.1 Background
...................

*Note optparse: 128. was explicitly designed to encourage the creation
of programs with straightforward, conventional command-line interfaces.
To that end, it supports only the most common command-line syntax and
semantics conventionally used under Unix.  If you are unfamiliar with
these conventions, read this section to acquaint yourself with them.

* Menu:

* Terminology::
* What are options for?::
* What are positional arguments for?::


File: python.info,  Node: Terminology,  Next: What are options for?,  Up: Background

5.15.5.2 Terminology
....................

argument
     a string entered on the command-line, and passed by the shell to
     `execl()' or `execv()'.  In Python, arguments are elements of
     `sys.argv[1:]' (`sys.argv[0]' is the name of the program being
     executed).  Unix shells also use the term “word”.

     It is occasionally desirable to substitute an argument list other
     than `sys.argv[1:]', so you should read “argument” as “an
     element of `sys.argv[1:]', or of some other list provided as a
     substitute for `sys.argv[1:]'”.

option
     an argument used to supply extra information to guide or customize
     the execution of a program.  There are many different syntaxes for
     options; the traditional Unix syntax is a hyphen (“-“)
     followed by a single letter, e.g. `-x' or `-F'.  Also, traditional
     Unix syntax allows multiple options to be merged into a single
     argument, e.g. `-x -F' is equivalent to `-xF'.  The GNU project
     introduced `--' followed by a series of hyphen-separated words,
     e.g. `--file' or `--dry-run'.  These are the only two option
     syntaxes provided by *Note optparse: 128.

     Some other option syntaxes that the world has seen include:

        * a hyphen followed by a few letters, e.g. `-pf' (this is `not'
          the same as multiple options merged into a single argument)

        * a hyphen followed by a whole word, e.g. `-file' (this is
          technically equivalent to the previous syntax, but they
          aren’t usually seen in the same program)

        * a plus sign followed by a single letter, or a few letters, or
          a word, e.g.  `+f', `+rgb'

        * a slash followed by a letter, or a few letters, or a word,
          e.g. `/f', `/file'

     These option syntaxes are not supported by *Note optparse: 128,
     and they never will be.  This is deliberate: the first three are
     non-standard on any environment, and the last only makes sense if
     you’re exclusively targeting VMS, MS-DOS, and/or Windows.

option argument
     an argument that follows an option, is closely associated with
     that option, and is consumed from the argument list when that
     option is. With *Note optparse: 128, option arguments may either
     be in a separate argument from their option:

         -f foo
         --file foo

     or included in the same argument:

         -ffoo
         --file=foo

     Typically, a given option either takes an argument or it
     doesn’t. Lots of people want an “optional option arguments”
     feature, meaning that some options will take an argument if they
     see it, and won’t if they don’t.  This is somewhat
     controversial, because it makes parsing ambiguous: if `-a' takes
     an optional argument and `-b' is another option entirely, how do we
     interpret `-ab'?  Because of this ambiguity, *Note optparse: 128.
     does not support this feature.

positional argument
     something leftover in the argument list after options have been
     parsed, i.e.  after options and their arguments have been parsed
     and removed from the argument list.

required option
     an option that must be supplied on the command-line; note that the
     phrase “required option” is self-contradictory in English.
     *Note optparse: 128. doesn’t prevent you from implementing
     required options, but doesn’t give you much help at it either.

For example, consider this hypothetical command-line:

    prog -v --report report.txt foo bar

`-v' and `--report' are both options.  Assuming that `--report' takes
one argument, `report.txt' is an option argument.  `foo' and `bar' are
positional arguments.


File: python.info,  Node: What are options for?,  Next: What are positional arguments for?,  Prev: Terminology,  Up: Background

5.15.5.3 What are options for?
..............................

Options are used to provide extra information to tune or customize the
execution of a program.  In case it wasn’t clear, options are usually
`optional'.  A program should be able to run just fine with no options
whatsoever.  (Pick a random program from the Unix or GNU toolsets.  Can
it run without any options at all and still make sense?  The main
exceptions are `find', `tar', and `dd'—all of which are mutant
oddballs that have been rightly criticized for their non-standard
syntax and confusing interfaces.)

Lots of people want their programs to have “required options”.
Think about it.  If it’s required, then it’s `not optional'!  If
there is a piece of information that your program absolutely requires
in order to run successfully, that’s what positional arguments are
for.

As an example of good command-line interface design, consider the
humble `cp' utility, for copying files.  It doesn’t make much sense
to try to copy files without supplying a destination and at least one
source. Hence, `cp' fails if you run it with no arguments.  However, it
has a flexible, useful syntax that does not require any options at all:

    cp SOURCE DEST
    cp SOURCE ... DEST-DIR

You can get pretty far with just that.  Most `cp' implementations
provide a bunch of options to tweak exactly how the files are copied:
you can preserve mode and modification time, avoid following symlinks,
ask before clobbering existing files, etc.  But none of this distracts
from the core mission of `cp', which is to copy either one file to
another, or several files to another directory.


File: python.info,  Node: What are positional arguments for?,  Prev: What are options for?,  Up: Background

5.15.5.4 What are positional arguments for?
...........................................

Positional arguments are for those pieces of information that your
program absolutely, positively requires to run.

A good user interface should have as few absolute requirements as
possible.  If your program requires 17 distinct pieces of information
in order to run successfully, it doesn’t much matter `how' you get
that information from the user—most people will give up and walk away
before they successfully run the program.  This applies whether the
user interface is a command-line, a configuration file, or a GUI: if
you make that many demands on your users, most of them will simply give
up.

In short, try to minimize the amount of information that users are
absolutely required to supply—use sensible defaults whenever
possible.  Of course, you also want to make your programs reasonably
flexible.  That’s what options are for.  Again, it doesn’t matter
if they are entries in a config file, widgets in the “Preferences”
dialog of a GUI, or command-line options—the more options you
implement, the more flexible your program is, and the more complicated
its implementation becomes.  Too much flexibility has drawbacks as
well, of course; too many options can overwhelm users and make your
code much harder to maintain.


File: python.info,  Node: Tutorial,  Next: Reference Guide,  Prev: Background,  Up: optparse — Parser for command line options

5.15.5.5 Tutorial
.................

While *Note optparse: 128. is quite flexible and powerful, it’s also
straightforward to use in most cases.  This section covers the code
patterns that are common to any *Note optparse: 128.-based program.

First, you need to import the OptionParser class; then, early in the
main program, create an OptionParser instance:

    from optparse import OptionParser
    ...
    parser = OptionParser()

Then you can start defining options.  The basic syntax is:

    parser.add_option(opt_str, ...,
                      attr=value, ...)

Each option has one or more option strings, such as `-f' or `--file',
and several option attributes that tell *Note optparse: 128. what to
expect and what to do when it encounters that option on the command
line.

Typically, each option will have one short option string and one long
option string, e.g.:

    parser.add_option("-f", "--file", ...)

You’re free to define as many short option strings and as many long
option strings as you like (including zero), as long as there is at
least one option string overall.

The option strings passed to *Note OptionParser.add_option(): 1275. are
effectively labels for the option defined by that call.  For brevity,
we will frequently refer to `encountering an option' on the command
line; in reality, *Note optparse: 128.  encounters `option strings' and
looks up options from them.

Once all of your options are defined, instruct *Note optparse: 128. to
parse your program’s command line:

    (options, args) = parser.parse_args()

(If you like, you can pass a custom argument list to `parse_args()', but
that’s rarely necessary: by default it uses `sys.argv[1:]'.)

`parse_args()' returns two values:

   * `options', an object containing values for all of your
     options—e.g. if `--file' takes a single string argument, then
     `options.file' will be the filename supplied by the user, or
     `None' if the user did not supply that option

   * `args', the list of positional arguments leftover after parsing
     options

This tutorial section only covers the four most important option
attributes: *Note action: 1283, *Note type: 1284, *Note dest: 1285.
(destination), and *Note help: 1286. Of these, *Note action: 1283. is
the most fundamental.

* Menu:

* Understanding option actions::
* The store action::
* Handling boolean (flag) options: Handling boolean flag options.
* Other actions::
* Default values::
* Generating help::
* Printing a version string::
* How optparse handles errors::
* Putting it all together::


File: python.info,  Node: Understanding option actions,  Next: The store action,  Up: Tutorial

5.15.5.6 Understanding option actions
.....................................

Actions tell *Note optparse: 128. what to do when it encounters an
option on the command line.  There is a fixed set of actions hard-coded
into *Note optparse: 128.; adding new actions is an advanced topic
covered in section *Note Extending optparse: 1289.  Most actions tell
*Note optparse: 128. to store a value in some variable—for example,
take a string from the command line and store it in an attribute of
`options'.

If you don’t specify an option action, *Note optparse: 128. defaults
to `store'.


File: python.info,  Node: The store action,  Next: Handling boolean flag options,  Prev: Understanding option actions,  Up: Tutorial

5.15.5.7 The store action
.........................

The most common option action is `store', which tells *Note optparse:
128. to take the next argument (or the remainder of the current
argument), ensure that it is of the correct type, and store it to your
chosen destination.

For example:

    parser.add_option("-f", "--file",
                      action="store", type="string", dest="filename")

Now let’s make up a fake command line and ask *Note optparse: 128. to
parse it:

    args = ["-f", "foo.txt"]
    (options, args) = parser.parse_args(args)

When *Note optparse: 128. sees the option string `-f', it consumes the
next argument, `foo.txt', and stores it in `options.filename'.  So,
after this call to `parse_args()', `options.filename' is `"foo.txt"'.

Some other option types supported by *Note optparse: 128. are `int' and
`float'.  Here’s an option that expects an integer argument:

    parser.add_option("-n", type="int", dest="num")

Note that this option has no long option string, which is perfectly
acceptable.  Also, there’s no explicit action, since the default is
`store'.

Let’s parse another fake command-line.  This time, we’ll jam the
option argument right up against the option: since `-n42' (one
argument) is equivalent to `-n 42' (two arguments), the code

    (options, args) = parser.parse_args(["-n42"])
    print options.num

will print `42'.

If you don’t specify a type, *Note optparse: 128. assumes `string'.
Combined with the fact that the default action is `store', that means
our first example can be a lot shorter:

    parser.add_option("-f", "--file", dest="filename")

If you don’t supply a destination, *Note optparse: 128. figures out a
sensible default from the option strings: if the first long option
string is `--foo-bar', then the default destination is `foo_bar'.  If
there are no long option strings, *Note optparse: 128. looks at the
first short option string: the default destination for `-f' is `f'.

*Note optparse: 128. also includes built-in `long' and `complex' types.
Adding types is covered in section *Note Extending optparse: 1289.


File: python.info,  Node: Handling boolean flag options,  Next: Other actions,  Prev: The store action,  Up: Tutorial

5.15.5.8 Handling boolean (flag) options
........................................

Flag options—set a variable to true or false when a particular option
is seen —are quite common.  *Note optparse: 128. supports them with
two separate actions, `store_true' and `store_false'.  For example, you
might have a `verbose' flag that is turned on with `-v' and off with
`-q':

    parser.add_option("-v", action="store_true", dest="verbose")
    parser.add_option("-q", action="store_false", dest="verbose")

Here we have two different options with the same destination, which is
perfectly OK.  (It just means you have to be a bit careful when setting
default values— see below.)

When *Note optparse: 128. encounters `-v' on the command line, it sets
`options.verbose' to `True'; when it encounters `-q', `options.verbose'
is set to `False'.


File: python.info,  Node: Other actions,  Next: Default values,  Prev: Handling boolean flag options,  Up: Tutorial

5.15.5.9 Other actions
......................

Some other actions supported by *Note optparse: 128. are:

`"store_const"'
     store a constant value

`"append"'
     append this option’s argument to a list

`"count"'
     increment a counter by one

`"callback"'
     call a specified function

These are covered in section *Note Reference Guide: 1290, Reference
Guide and section *Note Option Callbacks: 1291.


File: python.info,  Node: Default values,  Next: Generating help,  Prev: Other actions,  Up: Tutorial

5.15.5.10 Default values
........................

All of the above examples involve setting some variable (the
“destination”) when certain command-line options are seen.  What
happens if those options are never seen?  Since we didn’t supply any
defaults, they are all set to `None'.  This is usually fine, but
sometimes you want more control.  *Note optparse: 128. lets you supply
a default value for each destination, which is assigned before the
command line is parsed.

First, consider the verbose/quiet example.  If we want *Note optparse:
128. to set `verbose' to `True' unless `-q' is seen, then we can do
this:

    parser.add_option("-v", action="store_true", dest="verbose", default=True)
    parser.add_option("-q", action="store_false", dest="verbose")

Since default values apply to the `destination' rather than to any
particular option, and these two options happen to have the same
destination, this is exactly equivalent:

    parser.add_option("-v", action="store_true", dest="verbose")
    parser.add_option("-q", action="store_false", dest="verbose", default=True)

Consider this:

    parser.add_option("-v", action="store_true", dest="verbose", default=False)
    parser.add_option("-q", action="store_false", dest="verbose", default=True)

Again, the default value for `verbose' will be `True': the last default
value supplied for any particular destination is the one that counts.

A clearer way to specify default values is the `set_defaults()' method
of OptionParser, which you can call at any time before calling
`parse_args()':

    parser.set_defaults(verbose=True)
    parser.add_option(...)
    (options, args) = parser.parse_args()

As before, the last value specified for a given option destination is
the one that counts.  For clarity, try to use one method or the other
of setting default values, not both.


File: python.info,  Node: Generating help,  Next: Printing a version string,  Prev: Default values,  Up: Tutorial

5.15.5.11 Generating help
.........................

*Note optparse: 128.’s ability to generate help and usage text
automatically is useful for creating user-friendly command-line
interfaces.  All you have to do is supply a *Note help: 1286. value for
each option, and optionally a short usage message for your whole
program.  Here’s an OptionParser populated with user-friendly
(documented) options:

    usage = "usage: %prog [options] arg1 arg2"
    parser = OptionParser(usage=usage)
    parser.add_option("-v", "--verbose",
                      action="store_true", dest="verbose", default=True,
                      help="make lots of noise [default]")
    parser.add_option("-q", "--quiet",
                      action="store_false", dest="verbose",
                      help="be vewwy quiet (I'm hunting wabbits)")
    parser.add_option("-f", "--filename",
                      metavar="FILE", help="write output to FILE")
    parser.add_option("-m", "--mode",
                      default="intermediate",
                      help="interaction mode: novice, intermediate, "
                           "or expert [default: %default]")

If *Note optparse: 128. encounters either `-h' or `--help' on the
command-line, or if you just call `parser.print_help()', it prints the
following to standard output:

    Usage: <yourscript> [options] arg1 arg2

    Options:
      -h, --help            show this help message and exit
      -v, --verbose         make lots of noise [default]
      -q, --quiet           be vewwy quiet (I'm hunting wabbits)
      -f FILE, --filename=FILE
                            write output to FILE
      -m MODE, --mode=MODE  interaction mode: novice, intermediate, or
                            expert [default: intermediate]

(If the help output is triggered by a help option, *Note optparse: 128.
exits after printing the help text.)

There’s a lot going on here to help *Note optparse: 128. generate the
best possible help message:

   * the script defines its own usage message:

         usage = "usage: %prog [options] arg1 arg2"

     *Note optparse: 128. expands `%prog' in the usage string to the
     name of the current program, i.e. `os.path.basename(sys.argv[0])'.
     The expanded string is then printed before the detailed option
     help.

     If you don’t supply a usage string, *Note optparse: 128. uses a
     bland but sensible default: `"Usage: %prog [options]"', which is
     fine if your script doesn’t take any positional arguments.

   * every option defines a help string, and doesn’t worry about
     line-wrapping— *Note optparse: 128. takes care of wrapping lines
     and making the help output look good.

   * options that take a value indicate this fact in their
     automatically-generated help message, e.g. for the “mode”
     option:

         -m MODE, --mode=MODE

     Here, “MODE” is called the meta-variable: it stands for the
     argument that the user is expected to supply to `-m'/`--mode'.  By
     default, *Note optparse: 128. converts the destination variable
     name to uppercase and uses that for the meta-variable.  Sometimes,
     that’s not what you want—for example, the `--filename' option
     explicitly sets `metavar="FILE"', resulting in this
     automatically-generated option description:

         -f FILE, --filename=FILE

     This is important for more than just saving space, though: the
     manually written help text uses the meta-variable `FILE' to clue
     the user in that there’s a connection between the semi-formal
     syntax `-f FILE' and the informal semantic description “write
     output to FILE”. This is a simple but effective way to make your
     help text a lot clearer and more useful for end users.

New in version 2.4: Options that have a default value can include
`%default' in the help string—*Note optparse: 128. will replace it
with *Note str(): 1ea. of the option’s default value.  If an option
has no default value (or the default value is `None'), `%default'
expands to `none'.

* Menu:

* Grouping Options::


File: python.info,  Node: Grouping Options,  Up: Generating help

5.15.5.12 Grouping Options
..........................

When dealing with many options, it is convenient to group these options
for better help output.  An *Note OptionParser: 1278. can contain
several option groups, each of which can contain several options.

An option group is obtained using the class *Note OptionGroup: 1297.:

 -- Class: optparse.OptionGroup (parser, title, description=None)
     where

        * parser is the *Note OptionParser: 1278. instance the group
          will be insterted in to

        * title is the group title

        * description, optional, is a long description of the group

*Note OptionGroup: 1297. inherits from `OptionContainer' (like *Note
OptionParser: 1278.) and so the `add_option()' method can be used to add
an option to the group.

Once all the options are declared, using the *Note OptionParser: 1278.
method `add_option_group()' the group is added to the previously
defined parser.

Continuing with the parser defined in the previous section, adding an
*Note OptionGroup: 1297. to a parser is easy:

    group = OptionGroup(parser, "Dangerous Options",
                        "Caution: use these options at your own risk.  "
                        "It is believed that some of them bite.")
    group.add_option("-g", action="store_true", help="Group option.")
    parser.add_option_group(group)

This would result in the following help output:

    Usage: <yourscript> [options] arg1 arg2

    Options:
      -h, --help            show this help message and exit
      -v, --verbose         make lots of noise [default]
      -q, --quiet           be vewwy quiet (I'm hunting wabbits)
      -f FILE, --filename=FILE
                            write output to FILE
      -m MODE, --mode=MODE  interaction mode: novice, intermediate, or
                            expert [default: intermediate]

      Dangerous Options:
        Caution: use these options at your own risk.  It is believed that some
        of them bite.

        -g                  Group option.

A bit more complete example might involve using more than one group:
still extending the previous example:

    group = OptionGroup(parser, "Dangerous Options",
                        "Caution: use these options at your own risk.  "
                        "It is believed that some of them bite.")
    group.add_option("-g", action="store_true", help="Group option.")
    parser.add_option_group(group)

    group = OptionGroup(parser, "Debug Options")
    group.add_option("-d", "--debug", action="store_true",
                     help="Print debug information")
    group.add_option("-s", "--sql", action="store_true",
                     help="Print all SQL statements executed")
    group.add_option("-e", action="store_true", help="Print every action done")
    parser.add_option_group(group)

that results in the following output:

    Usage: <yourscript> [options] arg1 arg2

    Options:
      -h, --help            show this help message and exit
      -v, --verbose         make lots of noise [default]
      -q, --quiet           be vewwy quiet (I'm hunting wabbits)
      -f FILE, --filename=FILE
                            write output to FILE
      -m MODE, --mode=MODE  interaction mode: novice, intermediate, or expert
                            [default: intermediate]

      Dangerous Options:
        Caution: use these options at your own risk.  It is believed that some
        of them bite.

        -g                  Group option.

      Debug Options:
        -d, --debug         Print debug information
        -s, --sql           Print all SQL statements executed
        -e                  Print every action done

Another interesting method, in particular when working programmatically
with option groups is:

 -- Method: OptionParser.get_option_group (opt_str)
     Return the *Note OptionGroup: 1297. to which the short or long
     option string `opt_str' (e.g. `'-o'' or `'--option'') belongs. If
     there’s no such *Note OptionGroup: 1297, return `None'.


File: python.info,  Node: Printing a version string,  Next: How optparse handles errors,  Prev: Generating help,  Up: Tutorial

5.15.5.13 Printing a version string
...................................

Similar to the brief usage string, *Note optparse: 128. can also print
a version string for your program.  You have to supply the string as
the `version' argument to OptionParser:

    parser = OptionParser(usage="%prog [-f] [-q]", version="%prog 1.0")

`%prog' is expanded just like it is in `usage'.  Apart from that,
`version' can contain anything you like.  When you supply it, *Note
optparse: 128.  automatically adds a `--version' option to your parser.
If it encounters this option on the command line, it expands your
`version' string (by replacing `%prog'), prints it to stdout, and exits.

For example, if your script is called `/usr/bin/foo':

    $ /usr/bin/foo --version
    foo 1.0

The following two methods can be used to print and get the `version'
string:

 -- Method: OptionParser.print_version (file=None)
     Print the version message for the current program (`self.version')
     to `file' (default stdout).  As with *Note print_usage(): 129c,
     any occurrence of `%prog' in `self.version' is replaced with the
     name of the current program.  Does nothing if `self.version' is
     empty or undefined.

 -- Method: OptionParser.get_version ()
     Same as *Note print_version(): 129b. but returns the version
     string instead of printing it.


File: python.info,  Node: How optparse handles errors,  Next: Putting it all together,  Prev: Printing a version string,  Up: Tutorial

5.15.5.14 How `optparse' handles errors
.......................................

There are two broad classes of errors that *Note optparse: 128. has to
worry about: programmer errors and user errors.  Programmer errors are
usually erroneous calls to *Note OptionParser.add_option(): 1275, e.g.
invalid option strings, unknown option attributes, missing option
attributes, etc.  These are dealt with in the usual way: raise an
exception (either `optparse.OptionError' or *Note TypeError: 218.) and
let the program crash.

Handling user errors is much more important, since they are guaranteed
to happen no matter how stable your code is.  *Note optparse: 128. can
automatically detect some user errors, such as bad option arguments
(passing `-n 4x' where `-n' takes an integer argument), missing
arguments (`-n' at the end of the command line, where `-n' takes an
argument of any type).  Also, you can call `OptionParser.error()' to
signal an application-defined error condition:

    (options, args) = parser.parse_args()
    ...
    if options.a and options.b:
        parser.error("options -a and -b are mutually exclusive")

In either case, *Note optparse: 128. handles the error the same way: it
prints the program’s usage message and an error message to standard
error and exits with error status 2.

Consider the first example above, where the user passes `4x' to an
option that takes an integer:

    $ /usr/bin/foo -n 4x
    Usage: foo [options]

    foo: error: option -n: invalid integer value: '4x'

Or, where the user fails to pass a value at all:

    $ /usr/bin/foo -n
    Usage: foo [options]

    foo: error: -n option requires an argument

*Note optparse: 128.-generated error messages take care always to
mention the option involved in the error; be sure to do the same when
calling `OptionParser.error()' from your application code.

If *Note optparse: 128.’s default error-handling behaviour does not
suit your needs, you’ll need to subclass OptionParser and override
its `exit()' and/or `error()' methods.


File: python.info,  Node: Putting it all together,  Prev: How optparse handles errors,  Up: Tutorial

5.15.5.15 Putting it all together
.................................

Here’s what *Note optparse: 128.-based scripts usually look like:

    from optparse import OptionParser
    ...
    def main():
        usage = "usage: %prog [options] arg"
        parser = OptionParser(usage)
        parser.add_option("-f", "--file", dest="filename",
                          help="read data from FILENAME")
        parser.add_option("-v", "--verbose",
                          action="store_true", dest="verbose")
        parser.add_option("-q", "--quiet",
                          action="store_false", dest="verbose")
        ...
        (options, args) = parser.parse_args()
        if len(args) != 1:
            parser.error("incorrect number of arguments")
        if options.verbose:
            print "reading %s..." % options.filename
        ...

    if __name__ == "__main__":
        main()


File: python.info,  Node: Reference Guide,  Next: Option Callbacks,  Prev: Tutorial,  Up: optparse — Parser for command line options

5.15.5.16 Reference Guide
.........................

* Menu:

* Creating the parser::
* Populating the parser::
* Defining options::
* Option attributes::
* Standard option actions::
* Standard option types::
* Parsing arguments: Parsing arguments<2>.
* Querying and manipulating your option parser::
* Conflicts between options::
* Cleanup::
* Other methods::


File: python.info,  Node: Creating the parser,  Next: Populating the parser,  Up: Reference Guide

5.15.5.17 Creating the parser
.............................

The first step in using *Note optparse: 128. is to create an
OptionParser instance.

 -- Class: optparse.OptionParser (...)
     The OptionParser constructor has no required arguments, but a
     number of optional keyword arguments.  You should always pass them
     as keyword arguments, i.e. do not rely on the order in which the
     arguments are declared.

    `usage' (default: `"%prog [options]"')
          The usage summary to print when your program is run
          incorrectly or with a help option.  When *Note optparse: 128.
          prints the usage string, it expands `%prog' to
          `os.path.basename(sys.argv[0])' (or to `prog' if you passed
          that keyword argument).  To suppress a usage message, pass the
          special value `optparse.SUPPRESS_USAGE'.

    `option_list' (default: `[]')
          A list of Option objects to populate the parser with.  The
          options in `option_list' are added after any options in
          `standard_option_list' (a class attribute that may be set by
          OptionParser subclasses), but before any version or help
          options. Deprecated; use *Note add_option(): 1275. after
          creating the parser instead.

    `option_class' (default: optparse.Option)
          Class to use when adding options to the parser in *Note
          add_option(): 1275.

    `version' (default: `None')
          A version string to print when the user supplies a version
          option. If you supply a true value for `version', *Note
          optparse: 128. automatically adds a version option with the
          single option string `--version'.  The substring `%prog' is
          expanded the same as for `usage'.

    `conflict_handler' (default: `"error"')
          Specifies what to do when options with conflicting option
          strings are added to the parser; see section *Note Conflicts
          between options: 12a5.

    `description' (default: `None')
          A paragraph of text giving a brief overview of your program.
          *Note optparse: 128. reformats this paragraph to fit the
          current terminal width and prints it when the user requests
          help (after `usage', but before the list of options).

    `formatter' (default: a new `IndentedHelpFormatter')
          An instance of optparse.HelpFormatter that will be used for
          printing help text.  *Note optparse: 128. provides two
          concrete classes for this purpose: IndentedHelpFormatter and
          TitledHelpFormatter.

    `add_help_option' (default: `True')
          If true, *Note optparse: 128. will add a help option (with
          option strings `-h' and `--help') to the parser.

    `prog'
          The string to use when expanding `%prog' in `usage' and
          `version' instead of `os.path.basename(sys.argv[0])'.

    `epilog' (default: `None')
          A paragraph of help text to print after the option help.


File: python.info,  Node: Populating the parser,  Next: Defining options,  Prev: Creating the parser,  Up: Reference Guide

5.15.5.18 Populating the parser
...............................

There are several ways to populate the parser with options.  The
preferred way is by using *Note OptionParser.add_option(): 1275, as
shown in section *Note Tutorial: 1281.  `add_option()' can be called in
one of two ways:

   * pass it an Option instance (as returned by `make_option()')

   * pass it any combination of positional and keyword arguments that
     are acceptable to `make_option()' (i.e., to the Option
     constructor), and it will create the Option instance for you

The other alternative is to pass a list of pre-constructed Option
instances to the OptionParser constructor, as in:

    option_list = [
        make_option("-f", "--filename",
                    action="store", type="string", dest="filename"),
        make_option("-q", "--quiet",
                    action="store_false", dest="verbose"),
        ]
    parser = OptionParser(option_list=option_list)

(`make_option()' is a factory function for creating Option instances;
currently it is an alias for the Option constructor.  A future version
of *Note optparse: 128. may split Option into several classes, and
`make_option()' will pick the right class to instantiate.  Do not
instantiate Option directly.)


File: python.info,  Node: Defining options,  Next: Option attributes,  Prev: Populating the parser,  Up: Reference Guide

5.15.5.19 Defining options
..........................

Each Option instance represents a set of synonymous command-line option
strings, e.g. `-f' and `--file'.  You can specify any number of short or
long option strings, but you must specify at least one overall option
string.

The canonical way to create an `Option' instance is with the
`add_option()' method of *Note OptionParser: 1278.

 -- Method: OptionParser.add_option (option)
 -- Method: OptionParser.add_option (*opt_str, attr=value, ...)
     To define an option with only a short option string:

         parser.add_option("-f", attr=value, ...)

     And to define an option with only a long option string:

         parser.add_option("--foo", attr=value, ...)

     The keyword arguments define attributes of the new Option object.
     The most important option attribute is *Note action: 1283, and it
     largely determines which other attributes are relevant or
     required.  If you pass irrelevant option attributes, or fail to
     pass required ones, *Note optparse: 128.  raises an `OptionError'
     exception explaining your mistake.

     An option’s `action' determines what *Note optparse: 128. does
     when it encounters this option on the command-line.  The standard
     option actions hard-coded into *Note optparse: 128. are:

    `"store"'
          store this option’s argument (default)

    `"store_const"'
          store a constant value

    `"store_true"'
          store a true value

    `"store_false"'
          store a false value

    `"append"'
          append this option’s argument to a list

    `"append_const"'
          append a constant value to a list

    `"count"'
          increment a counter by one

    `"callback"'
          call a specified function

    `"help"'
          print a usage message including all options and the
          documentation for them

     (If you don’t supply an action, the default is `"store"'.  For
     this action, you may also supply *Note type: 1284. and *Note dest:
     1285. option attributes; see *Note Standard option actions: 12aa.)

As you can see, most actions involve storing or updating a value
somewhere.  *Note optparse: 128. always creates a special object for
this, conventionally called `options' (it happens to be an instance of
`optparse.Values').  Option arguments (and various other values) are
stored as attributes of this object, according to the *Note dest: 1285.
(destination) option attribute.

For example, when you call

    parser.parse_args()

one of the first things *Note optparse: 128. does is create the
`options' object:

    options = Values()

If one of the options in this parser is defined with

    parser.add_option("-f", "--file", action="store", type="string", dest="filename")

and the command-line being parsed includes any of the following:

    -ffoo
    -f foo
    --file=foo
    --file foo

then *Note optparse: 128, on seeing this option, will do the equivalent
of

    options.filename = "foo"

The *Note type: 1284. and *Note dest: 1285. option attributes are almost
as important as *Note action: 1283, but *Note action: 1283. is the only
one that makes sense for `all' options.


File: python.info,  Node: Option attributes,  Next: Standard option actions,  Prev: Defining options,  Up: Reference Guide

5.15.5.20 Option attributes
...........................

The following option attributes may be passed as keyword arguments to
*Note OptionParser.add_option(): 1275.  If you pass an option attribute
that is not relevant to a particular option, or fail to pass a required
option attribute, *Note optparse: 128. raises `OptionError'.

 -- Attribute: Option.action
     (default: `"store"')

     Determines *Note optparse: 128.’s behaviour when this option is
     seen on the command line; the available options are documented
     *Note here: 12aa.

 -- Attribute: Option.type
     (default: `"string"')

     The argument type expected by this option (e.g., `"string"' or
     `"int"'); the available option types are documented *Note here:
     12ad.

 -- Attribute: Option.dest
     (default: derived from option strings)

     If the option’s action implies writing or modifying a value
     somewhere, this tells *Note optparse: 128. where to write it:
     *Note dest: 1285. names an attribute of the `options' object that
     *Note optparse: 128. builds as it parses the command line.

 -- Attribute: Option.default
     The value to use for this option’s destination if the option is
     not seen on the command line.  See also *Note
     OptionParser.set_defaults(): 12af.

 -- Attribute: Option.nargs
     (default: 1)

     How many arguments of type *Note type: 1284. should be consumed
     when this option is seen.  If > 1, *Note optparse: 128. will store
     a tuple of values to *Note dest: 1285.

 -- Attribute: Option.const
     For actions that store a constant value, the constant value to
     store.

 -- Attribute: Option.choices
     For options of type `"choice"', the list of strings the user may
     choose from.

 -- Attribute: Option.callback
     For options with action `"callback"', the callable to call when
     this option is seen.  See section *Note Option Callbacks: 1291.
     for detail on the arguments passed to the callable.

 -- Attribute: Option.callback_args
 -- Attribute: Option.callback_kwargs
     Additional positional and keyword arguments to pass to `callback'
     after the four standard callback arguments.

 -- Attribute: Option.help
     Help text to print for this option when listing all available
     options after the user supplies a *Note help: 1286. option (such
     as `--help').  If no help text is supplied, the option will be
     listed without help text.  To hide this option, use the special
     value `optparse.SUPPRESS_HELP'.

 -- Attribute: Option.metavar
     (default: derived from option strings)

     Stand-in for the option argument(s) to use when printing help
     text.  See section *Note Tutorial: 1281. for an example.


File: python.info,  Node: Standard option actions,  Next: Standard option types,  Prev: Option attributes,  Up: Reference Guide

5.15.5.21 Standard option actions
.................................

The various option actions all have slightly different requirements and
effects.  Most actions have several relevant option attributes which
you may specify to guide *Note optparse: 128.’s behaviour; a few have
required attributes, which you must specify for any option using that
action.

   * `"store"' [relevant: *Note type: 1284, *Note dest: 1285, *Note
     nargs: 12b0, *Note choices: 12b2.]

     The option must be followed by an argument, which is converted to
     a value according to *Note type: 1284. and stored in *Note dest:
     1285.  If *Note nargs: 12b0. > 1, multiple arguments will be
     consumed from the command line; all will be converted according to
     *Note type: 1284. and stored to *Note dest: 1285. as a tuple.  See
     the *Note Standard option types: 12ad. section.

     If *Note choices: 12b2. is supplied (a list or tuple of strings),
     the type defaults to `"choice"'.

     If *Note type: 1284. is not supplied, it defaults to `"string"'.

     If *Note dest: 1285. is not supplied, *Note optparse: 128. derives
     a destination from the first long option string (e.g., `--foo-bar'
     implies `foo_bar'). If there are no long option strings, *Note
     optparse: 128. derives a destination from the first short option
     string (e.g., `-f' implies `f').

     Example:

         parser.add_option("-f")
         parser.add_option("-p", type="float", nargs=3, dest="point")

     As it parses the command line

         -f foo.txt -p 1 -3.5 4 -fbar.txt

     *Note optparse: 128. will set

         options.f = "foo.txt"
         options.point = (1.0, -3.5, 4.0)
         options.f = "bar.txt"

   * `"store_const"' [required: *Note const: 12b1.; relevant: *Note
     dest: 1285.]

     The value *Note const: 12b1. is stored in *Note dest: 1285.

     Example:

         parser.add_option("-q", "--quiet",
                           action="store_const", const=0, dest="verbose")
         parser.add_option("-v", "--verbose",
                           action="store_const", const=1, dest="verbose")
         parser.add_option("--noisy",
                           action="store_const", const=2, dest="verbose")

     If `--noisy' is seen, *Note optparse: 128. will set

         options.verbose = 2

   * `"store_true"' [relevant: *Note dest: 1285.]

     A special case of `"store_const"' that stores a true value to
     *Note dest: 1285.

   * `"store_false"' [relevant: *Note dest: 1285.]

     Like `"store_true"', but stores a false value.

     Example:

         parser.add_option("--clobber", action="store_true", dest="clobber")
         parser.add_option("--no-clobber", action="store_false", dest="clobber")

   * `"append"' [relevant: *Note type: 1284, *Note dest: 1285, *Note
     nargs: 12b0, *Note choices: 12b2.]

     The option must be followed by an argument, which is appended to
     the list in *Note dest: 1285.  If no default value for *Note dest:
     1285. is supplied, an empty list is automatically created when
     *Note optparse: 128. first encounters this option on the
     command-line.  If *Note nargs: 12b0. > 1, multiple arguments are
     consumed, and a tuple of length *Note nargs: 12b0.  is appended to
     *Note dest: 1285.

     The defaults for *Note type: 1284. and *Note dest: 1285. are the
     same as for the `"store"' action.

     Example:

         parser.add_option("-t", "--tracks", action="append", type="int")

     If `-t3' is seen on the command-line, *Note optparse: 128. does
     the equivalent of:

         options.tracks = []
         options.tracks.append(int("3"))

     If, a little later on, `--tracks=4' is seen, it does:

         options.tracks.append(int("4"))

     The `append' action calls the `append' method on the current value
     of the option.  This means that any default value specified must
     have an `append' method.  It also means that if the default value
     is non-empty, the default elements will be present in the parsed
     value for the option, with any values from the command line
     appended after those default values:

         >>> parser.add_option("--files", action="append", default=['~/.mypkg/defaults'])
         >>> opts, args = parser.parse_args(['--files', 'overrides.mypkg'])
         >>> opts.files
         ['~/.mypkg/defaults', 'overrides.mypkg']

   * `"append_const"' [required: *Note const: 12b1.; relevant: *Note
     dest: 1285.]

     Like `"store_const"', but the value *Note const: 12b1. is appended
     to *Note dest: 1285.; as with `"append"', *Note dest: 1285.
     defaults to `None', and an empty list is automatically created the
     first time the option is encountered.

   * `"count"' [relevant: *Note dest: 1285.]

     Increment the integer stored at *Note dest: 1285.  If no default
     value is supplied, *Note dest: 1285. is set to zero before being
     incremented the first time.

     Example:

         parser.add_option("-v", action="count", dest="verbosity")

     The first time `-v' is seen on the command line, *Note optparse:
     128. does the equivalent of:

         options.verbosity = 0
         options.verbosity += 1

     Every subsequent occurrence of `-v' results in

         options.verbosity += 1

   * `"callback"' [required: *Note callback: 12b3.; relevant: *Note
     type: 1284, *Note nargs: 12b0, *Note callback_args: 12b4, *Note
     callback_kwargs: 12b5.]

     Call the function specified by *Note callback: 12b3, which is
     called as

         func(option, opt_str, value, parser, *args, **kwargs)

     See section *Note Option Callbacks: 1291. for more detail.

   * `"help"'

     Prints a complete help message for all the options in the current
     option parser.  The help message is constructed from the `usage'
     string passed to OptionParser’s constructor and the *Note help:
     1286. string passed to every option.

     If no *Note help: 1286. string is supplied for an option, it will
     still be listed in the help message.  To omit an option entirely,
     use the special value `optparse.SUPPRESS_HELP'.

     *Note optparse: 128. automatically adds a *Note help: 1286. option
     to all OptionParsers, so you do not normally need to create one.

     Example:

         from optparse import OptionParser, SUPPRESS_HELP

         # usually, a help option is added automatically, but that can
         # be suppressed using the add_help_option argument
         parser = OptionParser(add_help_option=False)

         parser.add_option("-h", "--help", action="help")
         parser.add_option("-v", action="store_true", dest="verbose",
                           help="Be moderately verbose")
         parser.add_option("--file", dest="filename",
                           help="Input file to read data from")
         parser.add_option("--secret", help=SUPPRESS_HELP)

     If *Note optparse: 128. sees either `-h' or `--help' on the
     command line, it will print something like the following help
     message to stdout (assuming `sys.argv[0]' is `"foo.py"'):

         Usage: foo.py [options]

         Options:
           -h, --help        Show this help message and exit
           -v                Be moderately verbose
           --file=FILENAME   Input file to read data from

     After printing the help message, *Note optparse: 128. terminates
     your process with `sys.exit(0)'.

   * `"version"'

     Prints the version number supplied to the OptionParser to stdout
     and exits.  The version number is actually formatted and printed
     by the `print_version()' method of OptionParser.  Generally only
     relevant if the `version' argument is supplied to the OptionParser
     constructor.  As with *Note help: 1286. options, you will rarely
     create `version' options, since *Note optparse: 128. automatically
     adds them when needed.


File: python.info,  Node: Standard option types,  Next: Parsing arguments<2>,  Prev: Standard option actions,  Up: Reference Guide

5.15.5.22 Standard option types
...............................

*Note optparse: 128. has six built-in option types: `"string"', `"int"',
`"long"', `"choice"', `"float"' and `"complex"'.  If you need to add new
option types, see section *Note Extending optparse: 1289.

Arguments to string options are not checked or converted in any way:
the text on the command line is stored in the destination (or passed to
the callback) as-is.

Integer arguments (type `"int"' or `"long"') are parsed as follows:

   * if the number starts with `0x', it is parsed as a hexadecimal
     number

   * if the number starts with `0', it is parsed as an octal number

   * if the number starts with `0b', it is parsed as a binary number

   * otherwise, the number is parsed as a decimal number

The conversion is done by calling either *Note int(): 1f2. or *Note
long(): 1f3. with the appropriate base (2, 8, 10, or 16).  If this
fails, so will *Note optparse: 128, although with a more useful error
message.

`"float"' and `"complex"' option arguments are converted directly with
*Note float(): 1eb. and *Note complex(): 1ec, with similar
error-handling.

`"choice"' options are a subtype of `"string"' options.  The *Note
choices: 12b2. option attribute (a sequence of strings) defines the set
of allowed option arguments.  `optparse.check_choice()' compares
user-supplied option arguments against this master list and raises
`OptionValueError' if an invalid string is given.


File: python.info,  Node: Parsing arguments<2>,  Next: Querying and manipulating your option parser,  Prev: Standard option types,  Up: Reference Guide

5.15.5.23 Parsing arguments
...........................

The whole point of creating and populating an OptionParser is to call
its `parse_args()' method:

    (options, args) = parser.parse_args(args=None, values=None)

where the input parameters are

`args'
     the list of arguments to process (default: `sys.argv[1:]')

`values'
     an `optparse.Values' object to store option arguments in (default:
     a new instance of `Values') – if you give an existing object, the
     option defaults will not be initialized on it

and the return values are

`options'
     the same object that was passed in as `values', or the
     optparse.Values instance created by *Note optparse: 128.

`args'
     the leftover positional arguments after all options have been
     processed

The most common usage is to supply neither keyword argument.  If you
supply `values', it will be modified with repeated *Note setattr():
8a2. calls (roughly one for every option argument stored to an option
destination) and returned by `parse_args()'.

If `parse_args()' encounters any errors in the argument list, it calls
the OptionParser’s `error()' method with an appropriate end-user
error message.  This ultimately terminates your process with an exit
status of 2 (the traditional Unix exit status for command-line errors).


File: python.info,  Node: Querying and manipulating your option parser,  Next: Conflicts between options,  Prev: Parsing arguments<2>,  Up: Reference Guide

5.15.5.24 Querying and manipulating your option parser
......................................................

The default behavior of the option parser can be customized slightly,
and you can also poke around your option parser and see what’s there.
OptionParser provides several methods to help you out:

 -- Method: OptionParser.disable_interspersed_args ()
     Set parsing to stop on the first non-option.  For example, if `-a'
     and `-b' are both simple options that take no arguments, *Note
     optparse: 128.  normally accepts this syntax:

         prog -a arg1 -b arg2

     and treats it as equivalent to

         prog -a -b arg1 arg2

     To disable this feature, call *Note disable_interspersed_args():
     12bd.  This restores traditional Unix syntax, where option parsing
     stops with the first non-option argument.

     Use this if you have a command processor which runs another
     command which has options of its own and you want to make sure
     these options don’t get confused.  For example, each command
     might have a different set of options.

 -- Method: OptionParser.enable_interspersed_args ()
     Set parsing to not stop on the first non-option, allowing
     interspersing switches with command arguments.  This is the
     default behavior.

 -- Method: OptionParser.get_option (opt_str)
     Returns the Option instance with the option string `opt_str', or
     `None' if no options have that option string.

 -- Method: OptionParser.has_option (opt_str)
     Return true if the OptionParser has an option with option string
     `opt_str' (e.g., `-q' or `--verbose').

 -- Method: OptionParser.remove_option (opt_str)
     If the *Note OptionParser: 1278. has an option corresponding to
     `opt_str', that option is removed.  If that option provided any
     other option strings, all of those option strings become invalid.
     If `opt_str' does not occur in any option belonging to this *Note
     OptionParser: 1278, raises *Note ValueError: 236.


File: python.info,  Node: Conflicts between options,  Next: Cleanup,  Prev: Querying and manipulating your option parser,  Up: Reference Guide

5.15.5.25 Conflicts between options
...................................

If you’re not careful, it’s easy to define options with conflicting
option strings:

    parser.add_option("-n", "--dry-run", ...)
    ...
    parser.add_option("-n", "--noisy", ...)

(This is particularly true if you’ve defined your own OptionParser
subclass with some standard options.)

Every time you add an option, *Note optparse: 128. checks for conflicts
with existing options.  If it finds any, it invokes the current
conflict-handling mechanism.  You can set the conflict-handling
mechanism either in the constructor:

    parser = OptionParser(..., conflict_handler=handler)

or with a separate call:

    parser.set_conflict_handler(handler)

The available conflict handlers are:

    `"error"' (default)
          assume option conflicts are a programming error and raise
          `OptionConflictError'

    `"resolve"'
          resolve option conflicts intelligently (see below)

As an example, let’s define an *Note OptionParser: 1278. that
resolves conflicts intelligently and add conflicting options to it:

    parser = OptionParser(conflict_handler="resolve")
    parser.add_option("-n", "--dry-run", ..., help="do no harm")
    parser.add_option("-n", "--noisy", ..., help="be noisy")

At this point, *Note optparse: 128. detects that a previously-added
option is already using the `-n' option string.  Since
`conflict_handler' is `"resolve"', it resolves the situation by
removing `-n' from the earlier option’s list of option strings.  Now
`--dry-run' is the only way for the user to activate that option.  If
the user asks for help, the help message will reflect that:

    Options:
      --dry-run     do no harm
      ...
      -n, --noisy   be noisy

It’s possible to whittle away the option strings for a
previously-added option until there are none left, and the user has no
way of invoking that option from the command-line.  In that case, *Note
optparse: 128. removes that option completely, so it doesn’t show up
in help text or anywhere else. Carrying on with our existing
OptionParser:

    parser.add_option("--dry-run", ..., help="new dry-run option")

At this point, the original `-n'/`--dry-run' option is no longer
accessible, so *Note optparse: 128. removes it, leaving this help text:

    Options:
      ...
      -n, --noisy   be noisy
      --dry-run     new dry-run option


File: python.info,  Node: Cleanup,  Next: Other methods,  Prev: Conflicts between options,  Up: Reference Guide

5.15.5.26 Cleanup
.................

OptionParser instances have several cyclic references.  This should not
be a problem for Python’s garbage collector, but you may wish to
break the cyclic references explicitly by calling `destroy()' on your
OptionParser once you are done with it.  This is particularly useful in
long-running applications where large object graphs are reachable from
your OptionParser.


File: python.info,  Node: Other methods,  Prev: Cleanup,  Up: Reference Guide

5.15.5.27 Other methods
.......................

OptionParser supports several other public methods:

 -- Method: OptionParser.set_usage (usage)
     Set the usage string according to the rules described above for
     the `usage' constructor keyword argument.  Passing `None' sets the
     default usage string; use `optparse.SUPPRESS_USAGE' to suppress a
     usage message.

 -- Method: OptionParser.print_usage (file=None)
     Print the usage message for the current program (`self.usage') to
     `file' (default stdout).  Any occurrence of the string `%prog' in
     `self.usage' is replaced with the name of the current program.
     Does nothing if `self.usage' is empty or not defined.

 -- Method: OptionParser.get_usage ()
     Same as *Note print_usage(): 129c. but returns the usage string
     instead of printing it.

 -- Method: OptionParser.set_defaults (dest=value, ...)
     Set default values for several option destinations at once.  Using
     *Note set_defaults(): 12af. is the preferred way to set default
     values for options, since multiple options can share the same
     destination.  For example, if several “mode” options all set
     the same destination, any one of them can set the default, and the
     last one wins:

         parser.add_option("--advanced", action="store_const",
                           dest="mode", const="advanced",
                           default="novice")    # overridden below
         parser.add_option("--novice", action="store_const",
                           dest="mode", const="novice",
                           default="advanced")  # overrides above setting

     To avoid this confusion, use *Note set_defaults(): 12af.:

         parser.set_defaults(mode="advanced")
         parser.add_option("--advanced", action="store_const",
                           dest="mode", const="advanced")
         parser.add_option("--novice", action="store_const",
                           dest="mode", const="novice")


File: python.info,  Node: Option Callbacks,  Next: Extending optparse,  Prev: Reference Guide,  Up: optparse — Parser for command line options

5.15.5.28 Option Callbacks
..........................

When *Note optparse: 128.’s built-in actions and types aren’t quite
enough for your needs, you have two choices: extend *Note optparse:
128. or define a callback option.  Extending *Note optparse: 128. is
more general, but overkill for a lot of simple cases.  Quite often a
simple callback is all you need.

There are two steps to defining a callback option:

   * define the option itself using the `"callback"' action

   * write the callback; this is a function (or method) that takes at
     least four arguments, as described below

* Menu:

* Defining a callback option::
* How callbacks are called::
* Raising errors in a callback::
* Callback example 1; trivial callback: Callback example 1 trivial callback.
* Callback example 2; check option order: Callback example 2 check option order.
* Callback example 3; check option order (generalized): Callback example 3 check option order generalized.
* Callback example 4; check arbitrary condition: Callback example 4 check arbitrary condition.
* Callback example 5; fixed arguments: Callback example 5 fixed arguments.
* Callback example 6; variable arguments: Callback example 6 variable arguments.


File: python.info,  Node: Defining a callback option,  Next: How callbacks are called,  Up: Option Callbacks

5.15.5.29 Defining a callback option
....................................

As always, the easiest way to define a callback option is by using the
*Note OptionParser.add_option(): 1275. method.  Apart from *Note
action: 1283, the only option attribute you must specify is `callback',
the function to call:

    parser.add_option("-c", action="callback", callback=my_callback)

`callback' is a function (or other callable object), so you must have
already defined `my_callback()' when you create this callback option.
In this simple case, *Note optparse: 128. doesn’t even know if `-c'
takes any arguments, which usually means that the option takes no
arguments—the mere presence of `-c' on the command-line is all it
needs to know.  In some circumstances, though, you might want your
callback to consume an arbitrary number of command-line arguments.
This is where writing callbacks gets tricky; it’s covered later in
this section.

*Note optparse: 128. always passes four particular arguments to your
callback, and it will only pass additional arguments if you specify
them via *Note callback_args: 12b4. and *Note callback_kwargs: 12b5.
Thus, the minimal callback function signature is:

    def my_callback(option, opt, value, parser):

The four arguments to a callback are described below.

There are several other option attributes that you can supply when you
define a callback option:

*Note type: 1284.
     has its usual meaning: as with the `"store"' or `"append"'
     actions, it instructs *Note optparse: 128. to consume one argument
     and convert it to *Note type: 1284.  Rather than storing the
     converted value(s) anywhere, though, *Note optparse: 128. passes
     it to your callback function.

*Note nargs: 12b0.
     also has its usual meaning: if it is supplied and > 1, *Note
     optparse: 128. will consume *Note nargs: 12b0. arguments, each of
     which must be convertible to *Note type: 1284.  It then passes a
     tuple of converted values to your callback.

*Note callback_args: 12b4.
     a tuple of extra positional arguments to pass to the callback

*Note callback_kwargs: 12b5.
     a dictionary of extra keyword arguments to pass to the callback


File: python.info,  Node: How callbacks are called,  Next: Raising errors in a callback,  Prev: Defining a callback option,  Up: Option Callbacks

5.15.5.30 How callbacks are called
..................................

All callbacks are called as follows:

    func(option, opt_str, value, parser, *args, **kwargs)

where

`option'
     is the Option instance that’s calling the callback

`opt_str'
     is the option string seen on the command-line that’s triggering
     the callback.  (If an abbreviated long option was used, `opt_str'
     will be the full, canonical option string—e.g. if the user puts
     `--foo' on the command-line as an abbreviation for `--foobar',
     then `opt_str' will be `"--foobar"'.)

`value'
     is the argument to this option seen on the command-line.  *Note
     optparse: 128. will only expect an argument if *Note type: 1284.
     is set; the type of `value' will be the type implied by the
     option’s type.  If *Note type: 1284. for this option is `None'
     (no argument expected), then `value' will be `None'.  If *Note
     nargs: 12b0.  > 1, `value' will be a tuple of values of the
     appropriate type.

`parser'
     is the OptionParser instance driving the whole thing, mainly
     useful because you can access some other interesting data through
     its instance attributes:

    `parser.largs'
          the current list of leftover arguments, ie. arguments that
          have been consumed but are neither options nor option
          arguments. Feel free to modify `parser.largs', e.g. by adding
          more arguments to it.  (This list will become `args', the
          second return value of `parse_args()'.)

    `parser.rargs'
          the current list of remaining arguments, ie. with `opt_str'
          and `value' (if applicable) removed, and only the arguments
          following them still there.  Feel free to modify
          `parser.rargs', e.g. by consuming more arguments.

    `parser.values'
          the object where option values are by default stored (an
          instance of optparse.OptionValues).  This lets callbacks use
          the same mechanism as the rest of *Note optparse: 128. for
          storing option values; you don’t need to mess around with
          globals or closures.  You can also access or modify the
          value(s) of any options already encountered on the
          command-line.

`args'
     is a tuple of arbitrary positional arguments supplied via the
     *Note callback_args: 12b4. option attribute.

`kwargs'
     is a dictionary of arbitrary keyword arguments supplied via *Note
     callback_kwargs: 12b5.


File: python.info,  Node: Raising errors in a callback,  Next: Callback example 1 trivial callback,  Prev: How callbacks are called,  Up: Option Callbacks

5.15.5.31 Raising errors in a callback
......................................

The callback function should raise `OptionValueError' if there are any
problems with the option or its argument(s).  *Note optparse: 128.
catches this and terminates the program, printing the error message you
supply to stderr.  Your message should be clear, concise, accurate, and
mention the option at fault.  Otherwise, the user will have a hard time
figuring out what he did wrong.


File: python.info,  Node: Callback example 1 trivial callback,  Next: Callback example 2 check option order,  Prev: Raising errors in a callback,  Up: Option Callbacks

5.15.5.32 Callback example 1: trivial callback
..............................................

Here’s an example of a callback option that takes no arguments, and
simply records that the option was seen:

    def record_foo_seen(option, opt_str, value, parser):
        parser.values.saw_foo = True

    parser.add_option("--foo", action="callback", callback=record_foo_seen)

Of course, you could do that with the `"store_true"' action.


File: python.info,  Node: Callback example 2 check option order,  Next: Callback example 3 check option order generalized,  Prev: Callback example 1 trivial callback,  Up: Option Callbacks

5.15.5.33 Callback example 2: check option order
................................................

Here’s a slightly more interesting example: record the fact that `-a'
is seen, but blow up if it comes after `-b' in the command-line.

    def check_order(option, opt_str, value, parser):
        if parser.values.b:
            raise OptionValueError("can't use -a after -b")
        parser.values.a = 1
    ...
    parser.add_option("-a", action="callback", callback=check_order)
    parser.add_option("-b", action="store_true", dest="b")


File: python.info,  Node: Callback example 3 check option order generalized,  Next: Callback example 4 check arbitrary condition,  Prev: Callback example 2 check option order,  Up: Option Callbacks

5.15.5.34 Callback example 3: check option order (generalized)
..............................................................

If you want to re-use this callback for several similar options (set a
flag, but blow up if `-b' has already been seen), it needs a bit of
work: the error message and the flag that it sets must be generalized.

    def check_order(option, opt_str, value, parser):
        if parser.values.b:
            raise OptionValueError("can't use %s after -b" % opt_str)
        setattr(parser.values, option.dest, 1)
    ...
    parser.add_option("-a", action="callback", callback=check_order, dest='a')
    parser.add_option("-b", action="store_true", dest="b")
    parser.add_option("-c", action="callback", callback=check_order, dest='c')


File: python.info,  Node: Callback example 4 check arbitrary condition,  Next: Callback example 5 fixed arguments,  Prev: Callback example 3 check option order generalized,  Up: Option Callbacks

5.15.5.35 Callback example 4: check arbitrary condition
.......................................................

Of course, you could put any condition in there—you’re not limited
to checking the values of already-defined options.  For example, if you
have options that should not be called when the moon is full, all you
have to do is this:

    def check_moon(option, opt_str, value, parser):
        if is_moon_full():
            raise OptionValueError("%s option invalid when moon is full"
                                   % opt_str)
        setattr(parser.values, option.dest, 1)
    ...
    parser.add_option("--foo",
                      action="callback", callback=check_moon, dest="foo")

(The definition of `is_moon_full()' is left as an exercise for the
reader.)


File: python.info,  Node: Callback example 5 fixed arguments,  Next: Callback example 6 variable arguments,  Prev: Callback example 4 check arbitrary condition,  Up: Option Callbacks

5.15.5.36 Callback example 5: fixed arguments
.............................................

Things get slightly more interesting when you define callback options
that take a fixed number of arguments.  Specifying that a callback
option takes arguments is similar to defining a `"store"' or `"append"'
option: if you define *Note type: 1284, then the option takes one
argument that must be convertible to that type; if you further define
*Note nargs: 12b0, then the option takes *Note nargs: 12b0. arguments.

Here’s an example that just emulates the standard `"store"' action:

    def store_value(option, opt_str, value, parser):
        setattr(parser.values, option.dest, value)
    ...
    parser.add_option("--foo",
                      action="callback", callback=store_value,
                      type="int", nargs=3, dest="foo")

Note that *Note optparse: 128. takes care of consuming 3 arguments and
converting them to integers for you; all you have to do is store them.
(Or whatever; obviously you don’t need a callback for this example.)


File: python.info,  Node: Callback example 6 variable arguments,  Prev: Callback example 5 fixed arguments,  Up: Option Callbacks

5.15.5.37 Callback example 6: variable arguments
................................................

Things get hairy when you want an option to take a variable number of
arguments.  For this case, you must write a callback, as *Note
optparse: 128. doesn’t provide any built-in capabilities for it.  And
you have to deal with certain intricacies of conventional Unix
command-line parsing that *Note optparse: 128. normally handles for
you.  In particular, callbacks should implement the conventional rules
for bare `--' and `-' arguments:

   * either `--' or `-' can be option arguments

   * bare `--' (if not the argument to some option): halt command-line
     processing and discard the `--'

   * bare `-' (if not the argument to some option): halt command-line
     processing but keep the `-' (append it to `parser.largs')

If you want an option that takes a variable number of arguments, there
are several subtle, tricky issues to worry about.  The exact
implementation you choose will be based on which trade-offs you’re
willing to make for your application (which is why *Note optparse: 128.
doesn’t support this sort of thing directly).

Nevertheless, here’s a stab at a callback for an option with variable
arguments:

    def vararg_callback(option, opt_str, value, parser):
        assert value is None
        value = []

        def floatable(str):
            try:
                float(str)
                return True
            except ValueError:
                return False

        for arg in parser.rargs:
            # stop on --foo like options
            if arg[:2] == "--" and len(arg) > 2:
                break
            # stop on -a, but not on -3 or -3.0
            if arg[:1] == "-" and len(arg) > 1 and not floatable(arg):
                break
            value.append(arg)

        del parser.rargs[:len(value)]
        setattr(parser.values, option.dest, value)

    ...
    parser.add_option("-c", "--callback", dest="vararg_attr",
                      action="callback", callback=vararg_callback)


File: python.info,  Node: Extending optparse,  Prev: Option Callbacks,  Up: optparse — Parser for command line options

5.15.5.38 Extending `optparse'
..............................

Since the two major controlling factors in how *Note optparse: 128.
interprets command-line options are the action and type of each option,
the most likely direction of extension is to add new actions and new
types.

* Menu:

* Adding new types::
* Adding new actions::


File: python.info,  Node: Adding new types,  Next: Adding new actions,  Up: Extending optparse

5.15.5.39 Adding new types
..........................

To add new types, you need to define your own subclass of *Note
optparse: 128.’s `Option' class.  This class has a couple of
attributes that define *Note optparse: 128.’s types: *Note TYPES:
12df. and *Note TYPE_CHECKER: 12e0.

 -- Attribute: Option.TYPES
     A tuple of type names; in your subclass, simply define a new tuple
     *Note TYPES: 12df. that builds on the standard one.

 -- Attribute: Option.TYPE_CHECKER
     A dictionary mapping type names to type-checking functions.  A
     type-checking function has the following signature:

         def check_mytype(option, opt, value)

     where `option' is an `Option' instance, `opt' is an option string
     (e.g., `-f'), and `value' is the string from the command line that
     must be checked and converted to your desired type.
     `check_mytype()' should return an object of the hypothetical type
     `mytype'.  The value returned by a type-checking function will
     wind up in the OptionValues instance returned by
     `OptionParser.parse_args()', or be passed to a callback as the
     `value' parameter.

     Your type-checking function should raise `OptionValueError' if it
     encounters any problems.  `OptionValueError' takes a single string
     argument, which is passed as-is to *Note OptionParser: 1278.’s
     `error()' method, which in turn prepends the program name and the
     string `"error:"' and prints everything to stderr before
     terminating the process.

Here’s a silly example that demonstrates adding a `"complex"' option
type to parse Python-style complex numbers on the command line.  (This
is even sillier than it used to be, because *Note optparse: 128. 1.3
added built-in support for complex numbers, but never mind.)

First, the necessary imports:

    from copy import copy
    from optparse import Option, OptionValueError

You need to define your type-checker first, since it’s referred to
later (in the *Note TYPE_CHECKER: 12e0. class attribute of your Option
subclass):

    def check_complex(option, opt, value):
        try:
            return complex(value)
        except ValueError:
            raise OptionValueError(
                "option %s: invalid complex value: %r" % (opt, value))

Finally, the Option subclass:

    class MyOption (Option):
        TYPES = Option.TYPES + ("complex",)
        TYPE_CHECKER = copy(Option.TYPE_CHECKER)
        TYPE_CHECKER["complex"] = check_complex

(If we didn’t make a *Note copy(): 71. of *Note Option.TYPE_CHECKER:
12e0, we would end up modifying the *Note TYPE_CHECKER: 12e0. attribute
of *Note optparse: 128.’s Option class.  This being Python, nothing
stops you from doing that except good manners and common sense.)

That’s it!  Now you can write a script that uses the new option type
just like any other *Note optparse: 128.-based script, except you have
to instruct your OptionParser to use MyOption instead of Option:

    parser = OptionParser(option_class=MyOption)
    parser.add_option("-c", type="complex")

Alternately, you can build your own option list and pass it to
OptionParser; if you don’t use `add_option()' in the above way, you
don’t need to tell OptionParser which option class to use:

    option_list = [MyOption("-c", action="store", type="complex", dest="c")]
    parser = OptionParser(option_list=option_list)


File: python.info,  Node: Adding new actions,  Prev: Adding new types,  Up: Extending optparse

5.15.5.40 Adding new actions
............................

Adding new actions is a bit trickier, because you have to understand
that *Note optparse: 128. has a couple of classifications for actions:

“store” actions
     actions that result in *Note optparse: 128. storing a value to an
     attribute of the current OptionValues instance; these options
     require a *Note dest: 1285.  attribute to be supplied to the
     Option constructor.

“typed” actions
     actions that take a value from the command line and expect it to
     be of a certain type; or rather, a string that can be converted to
     a certain type.  These options require a *Note type: 1284.
     attribute to the Option constructor.

These are overlapping sets: some default “store” actions are
`"store"', `"store_const"', `"append"', and `"count"', while the
default “typed” actions are `"store"', `"append"', and `"callback"'.

When you add an action, you need to categorize it by listing it in at
least one of the following class attributes of Option (all are lists of
strings):

 -- Attribute: Option.ACTIONS
     All actions must be listed in ACTIONS.

 -- Attribute: Option.STORE_ACTIONS
     “store” actions are additionally listed here.

 -- Attribute: Option.TYPED_ACTIONS
     “typed” actions are additionally listed here.

 -- Attribute: Option.ALWAYS_TYPED_ACTIONS
     Actions that always take a type (i.e. whose options always take a
     value) are additionally listed here.  The only effect of this is
     that *Note optparse: 128.  assigns the default type, `"string"',
     to options with no explicit type whose action is listed in *Note
     ALWAYS_TYPED_ACTIONS: 12e6.

In order to actually implement your new action, you must override
Option’s `take_action()' method and add a case that recognizes your
action.

For example, let’s add an `"extend"' action.  This is similar to the
standard `"append"' action, but instead of taking a single value from
the command-line and appending it to an existing list, `"extend"' will
take multiple values in a single comma-delimited string, and extend an
existing list with them.  That is, if `--names' is an `"extend"' option
of type `"string"', the command line

    --names=foo,bar --names blah --names ding,dong

would result in a list

    ["foo", "bar", "blah", "ding", "dong"]

Again we define a subclass of Option:

    class MyOption(Option):

        ACTIONS = Option.ACTIONS + ("extend",)
        STORE_ACTIONS = Option.STORE_ACTIONS + ("extend",)
        TYPED_ACTIONS = Option.TYPED_ACTIONS + ("extend",)
        ALWAYS_TYPED_ACTIONS = Option.ALWAYS_TYPED_ACTIONS + ("extend",)

        def take_action(self, action, dest, opt, value, values, parser):
            if action == "extend":
                lvalue = value.split(",")
                values.ensure_value(dest, []).extend(lvalue)
            else:
                Option.take_action(
                    self, action, dest, opt, value, values, parser)

Features of note:

   * `"extend"' both expects a value on the command-line and stores
     that value somewhere, so it goes in both *Note STORE_ACTIONS:
     12e4. and *Note TYPED_ACTIONS: 12e5.

   * to ensure that *Note optparse: 128. assigns the default type of
     `"string"' to `"extend"' actions, we put the `"extend"' action in
     *Note ALWAYS_TYPED_ACTIONS: 12e6. as well.

   * `MyOption.take_action()' implements just this one new action, and
     passes control back to `Option.take_action()' for the standard
     *Note optparse: 128.  actions.

   * `values' is an instance of the optparse_parser.Values class, which
     provides the very useful `ensure_value()' method. `ensure_value()'
     is essentially *Note getattr(): 89d. with a safety valve; it is
     called as

         values.ensure_value(attr, value)

     If the `attr' attribute of `values' doesn’t exist or is `None',
     then ensure_value() first sets it to `value', and then returns
     ‘value. This is very handy for actions like `"extend"',
     `"append"', and `"count"', all of which accumulate data in a
     variable and expect that variable to be of a certain type (a list
     for the first two, an integer for the latter).  Using
     `ensure_value()' means that scripts using your action don’t have
     to worry about setting a default value for the option destinations
     in question; they can just leave the default as `None' and
     `ensure_value()' will take care of getting it right when it’s
     needed.


File: python.info,  Node: getopt — C-style parser for command line options,  Next: logging — Logging facility for Python,  Prev: optparse — Parser for command line options,  Up: Generic Operating System Services

5.15.6 `getopt' — C-style parser for command line options
-----------------------------------------------------------

`Source code:' Lib/getopt.py(1)

__________________________________________________________________

     Note: The *Note getopt: df. module is a parser for command line
     options whose API is designed to be familiar to users of the C
     `getopt()' function. Users who are unfamiliar with the C
     `getopt()' function or who would like to write less code and get
     better help and error messages should consider using the *Note
     argparse: d. module instead.

This module helps scripts to parse the command line arguments in
`sys.argv'.  It supports the same conventions as the Unix `getopt()'
function (including the special meanings of arguments of the form
‘`-'‘ and ‘`--'‘).  Long options similar to those supported by
GNU software may be used as well via an optional third argument.

This module provides two functions and an exception:

 -- Function: getopt.getopt (args, options[, long_options])
     Parses command line options and parameter list.  `args' is the
     argument list to be parsed, without the leading reference to the
     running program. Typically, this means `sys.argv[1:]'. `options'
     is the string of option letters that the script wants to
     recognize, with options that require an argument followed by a
     colon (`':''; i.e., the same format that Unix `getopt()' uses).

          Note: Unlike GNU `getopt()', after a non-option argument, all
          further arguments are considered also non-options. This is
          similar to the way non-GNU Unix systems work.

     `long_options', if specified, must be a list of strings with the
     names of the long options which should be supported.  The leading
     `'--'' characters should not be included in the option name.  Long
     options which require an argument should be followed by an equal
     sign (`'='').  Optional arguments are not supported.  To accept
     only long options, `options' should be an empty string.  Long
     options on the command line can be recognized so long as they
     provide a prefix of the option name that matches exactly one of
     the accepted options.  For example, if `long_options' is `['foo',
     'frob']', the option `--fo' will match as `--foo', but `--f' will
     not match uniquely, so *Note GetoptError: 12ea. will be raised.

     The return value consists of two elements: the first is a list of
     `(option, value)' pairs; the second is the list of program
     arguments left after the option list was stripped (this is a
     trailing slice of `args').  Each option-and-value pair returned
     has the option as its first element, prefixed with a hyphen for
     short options (e.g., `'-x'') or two hyphens for long options
     (e.g., `'--long-option''), and the option argument as its second
     element, or an empty string if the option has no argument.  The
     options occur in the list in the same order in which they were
     found, thus allowing multiple occurrences.  Long and short options
     may be mixed.

 -- Function: getopt.gnu_getopt (args, options[, long_options])
     This function works like *Note getopt(): df, except that GNU style
     scanning mode is used by default. This means that option and
     non-option arguments may be intermixed. The *Note getopt(): df.
     function stops processing options as soon as a non-option argument
     is encountered.

     If the first character of the option string is `'+'', or if the
     environment variable `POSIXLY_CORRECT' is set, then option
     processing stops as soon as a non-option argument is encountered.

     New in version 2.3.


 -- Exception: getopt.GetoptError
     This is raised when an unrecognized option is found in the
     argument list or when an option requiring an argument is given
     none. The argument to the exception is a string indicating the
     cause of the error.  For long options, an argument given to an
     option which does not require one will also cause this exception
     to be raised.  The attributes `msg' and `opt' give the error
     message and related option; if there is no specific option to
     which the exception relates, `opt' is an empty string.

     Changed in version 1.6: Introduced *Note GetoptError: 12ea. as a
     synonym for *Note error: 12ec.


 -- Exception: getopt.error
     Alias for *Note GetoptError: 12ea.; for backward compatibility.

An example using only Unix style options:

    >>> import getopt
    >>> args = '-a -b -cfoo -d bar a1 a2'.split()
    >>> args
    ['-a', '-b', '-cfoo', '-d', 'bar', 'a1', 'a2']
    >>> optlist, args = getopt.getopt(args, 'abc:d:')
    >>> optlist
    [('-a', ''), ('-b', ''), ('-c', 'foo'), ('-d', 'bar')]
    >>> args
    ['a1', 'a2']

Using long option names is equally easy:

    >>> s = '--condition=foo --testing --output-file abc.def -x a1 a2'
    >>> args = s.split()
    >>> args
    ['--condition=foo', '--testing', '--output-file', 'abc.def', '-x', 'a1', 'a2']
    >>> optlist, args = getopt.getopt(args, 'x', [
    ...     'condition=', 'output-file=', 'testing'])
    >>> optlist
    [('--condition', 'foo'), ('--testing', ''), ('--output-file', 'abc.def'), ('-x', '')]
    >>> args
    ['a1', 'a2']

In a script, typical usage is something like this:

    import getopt, sys

    def main():
        try:
            opts, args = getopt.getopt(sys.argv[1:], "ho:v", ["help", "output="])
        except getopt.GetoptError as err:
            # print help information and exit:
            print str(err)  # will print something like "option -a not recognized"
            usage()
            sys.exit(2)
        output = None
        verbose = False
        for o, a in opts:
            if o == "-v":
                verbose = True
            elif o in ("-h", "--help"):
                usage()
                sys.exit()
            elif o in ("-o", "--output"):
                output = a
            else:
                assert False, "unhandled option"
        # ...

    if __name__ == "__main__":
        main()

Note that an equivalent command line interface could be produced with
less code and more informative help and error messages by using the
*Note argparse: d. module:

    import argparse

    if __name__ == '__main__':
        parser = argparse.ArgumentParser()
        parser.add_argument('-o', '--output')
        parser.add_argument('-v', dest='verbose', action='store_true')
        args = parser.parse_args()
        # ... do something with args.output ...
        # ... do something with args.verbose ..

See also
........

Module *Note argparse: d.
     Alternative command line option and argument parsing library.

---------- Footnotes ----------

(1) https://hg.python.org/cpython/file/2.7/Lib/getopt.py


File: python.info,  Node: logging — Logging facility for Python,  Next: logging config — Logging configuration,  Prev: getopt — C-style parser for command line options,  Up: Generic Operating System Services

5.15.7 `logging' — Logging facility for Python
------------------------------------------------

Important
.........

This page contains the API reference information. For tutorial
information and discussion of more advanced topics, see

   * *Note Basic Tutorial: 12ef.

   * *Note Advanced Tutorial: 12f0.

   * *Note Logging Cookbook: 12f1.

`Source code:' Lib/logging/__init__.py(1)

__________________________________________________________________

New in version 2.3.

This module defines functions and classes which implement a flexible
event logging system for applications and libraries.

The key benefit of having the logging API provided by a standard
library module is that all Python modules can participate in logging,
so your application log can include your own messages integrated with
messages from third-party modules.

The module provides a lot of functionality and flexibility.  If you are
unfamiliar with logging, the best way to get to grips with it is to see
the tutorials (see the links on the right).

The basic classes defined by the module, together with their functions,
are listed below.

   * Loggers expose the interface that application code directly uses.

   * Handlers send the log records (created by loggers) to the
     appropriate destination.

   * Filters provide a finer grained facility for determining which log
     records to output.

   * Formatters specify the layout of log records in the final output.

* Menu:

* Logger Objects::
* Logging Levels::
* Handler Objects::
* Formatter Objects::
* Filter Objects::
* LogRecord Objects::
* LogRecord attributes::
* LoggerAdapter Objects::
* Thread Safety::
* Module-Level Functions::
* Integration with the warnings module::

---------- Footnotes ----------

(1) https://hg.python.org/cpython/file/2.7/Lib/logging/__init__.py


File: python.info,  Node: Logger Objects,  Next: Logging Levels,  Up: logging — Logging facility for Python

5.15.7.1 Logger Objects
.......................

Loggers have the following attributes and methods.  Note that Loggers
are never instantiated directly, but always through the module-level
function `logging.getLogger(name)'.  Multiple calls to *Note
getLogger(): 12f4. with the same name will always return a reference to
the same Logger object.

The `name' is potentially a period-separated hierarchical value, like
`foo.bar.baz' (though it could also be just plain `foo', for example).
Loggers that are further down in the hierarchical list are children of
loggers higher up in the list.  For example, given a logger with a name
of `foo', loggers with names of `foo.bar', `foo.bar.baz', and `foo.bam'
are all descendants of `foo'.  The logger name hierarchy is analogous
to the Python package hierarchy, and identical to it if you organise
your loggers on a per-module basis using the recommended construction
`logging.getLogger(__name__)'.  That’s because in a module, `__name__'
is the module’s name in the Python package namespace.

 -- Class: logging.Logger

 -- Attribute: Logger.propagate
     If this evaluates to true, events logged to this logger will be
     passed to the handlers of higher level (ancestor) loggers, in
     addition to any handlers attached to this logger. Messages are
     passed directly to the ancestor loggers’ handlers - neither the
     level nor filters of the ancestor loggers in question are
     considered.

     If this evaluates to false, logging messages are not passed to the
     handlers of ancestor loggers.

     The constructor sets this attribute to `True'.

          Note: If you attach a handler to a logger `and' one or more
          of its ancestors, it may emit the same record multiple times.
          In general, you should not need to attach a handler to more
          than one logger - if you just attach it to the appropriate
          logger which is highest in the logger hierarchy, then it will
          see all events logged by all descendant loggers, provided
          that their propagate setting is left set to `True'. A common
          scenario is to attach handlers only to the root logger, and
          to let propagation take care of the rest.

 -- Method: Logger.setLevel (lvl)
     Sets the threshold for this logger to `lvl'. Logging messages
     which are less severe than `lvl' will be ignored. When a logger is
     created, the level is set to `NOTSET' (which causes all messages
     to be processed when the logger is the root logger, or delegation
     to the parent when the logger is a non-root logger). Note that the
     root logger is created with level `WARNING'.

     The term ‘delegation to the parent’ means that if a logger has
     a level of NOTSET, its chain of ancestor loggers is traversed
     until either an ancestor with a level other than NOTSET is found,
     or the root is reached.

     If an ancestor is found with a level other than NOTSET, then that
     ancestor’s level is treated as the effective level of the logger
     where the ancestor search began, and is used to determine how a
     logging event is handled.

     If the root is reached, and it has a level of NOTSET, then all
     messages will be processed. Otherwise, the root’s level will be
     used as the effective level.

     See *Note Logging Levels: 12f7. for a list of levels.

 -- Method: Logger.isEnabledFor (lvl)
     Indicates if a message of severity `lvl' would be processed by
     this logger.  This method checks first the module-level level set
     by `logging.disable(lvl)' and then the logger’s effective level
     as determined by *Note getEffectiveLevel(): 12f9.

 -- Method: Logger.getEffectiveLevel ()
     Indicates the effective level for this logger. If a value other
     than `NOTSET' has been set using *Note setLevel(): 12f6, it is
     returned. Otherwise, the hierarchy is traversed towards the root
     until a value other than `NOTSET' is found, and that value is
     returned. The value returned is an integer, typically one of
     `logging.DEBUG', `logging.INFO' etc.

 -- Method: Logger.getChild (suffix)
     Returns a logger which is a descendant to this logger, as
     determined by the suffix.  Thus,
     `logging.getLogger('abc').getChild('def.ghi')' would return the
     same logger as would be returned by
     `logging.getLogger('abc.def.ghi')'. This is a convenience method,
     useful when the parent logger is named using e.g. `__name__'
     rather than a literal string.

     New in version 2.7.


 -- Method: Logger.debug (msg, *args, **kwargs)
     Logs a message with level `DEBUG' on this logger. The `msg' is the
     message format string, and the `args' are the arguments which are
     merged into `msg' using the string formatting operator. (Note that
     this means that you can use keywords in the format string,
     together with a single dictionary argument.)

     There are two keyword arguments in `kwargs' which are inspected:
     `exc_info' which, if it does not evaluate as false, causes
     exception information to be added to the logging message. If an
     exception tuple (in the format returned by *Note sys.exc_info():
     306.) is provided, it is used; otherwise, *Note sys.exc_info():
     306.  is called to get the exception information.

     The second keyword argument is `extra' which can be used to pass a
     dictionary which is used to populate the __dict__ of the LogRecord
     created for the logging event with user-defined attributes. These
     custom attributes can then be used as you like. For example, they
     could be incorporated into logged messages. For example:

         FORMAT = '%(asctime)-15s %(clientip)s %(user)-8s %(message)s'
         logging.basicConfig(format=FORMAT)
         d = {'clientip': '192.168.0.1', 'user': 'fbloggs'}
         logger = logging.getLogger('tcpserver')
         logger.warning('Protocol problem: %s', 'connection reset', extra=d)

     would print something like

         2006-02-08 22:20:02,165 192.168.0.1 fbloggs  Protocol problem: connection reset

     The keys in the dictionary passed in `extra' should not clash with
     the keys used by the logging system. (See the *Note Formatter:
     12fb. documentation for more information on which keys are used by
     the logging system.)

     If you choose to use these attributes in logged messages, you need
     to exercise some care. In the above example, for instance, the
     *Note Formatter: 12fb. has been set up with a format string which
     expects ‘clientip’ and ‘user’ in the attribute dictionary
     of the LogRecord. If these are missing, the message will not be
     logged because a string formatting exception will occur. So in
     this case, you always need to pass the `extra' dictionary with
     these keys.

     While this might be annoying, this feature is intended for use in
     specialized circumstances, such as multi-threaded servers where
     the same code executes in many contexts, and interesting
     conditions which arise are dependent on this context (such as
     remote client IP address and authenticated user name, in the above
     example). In such circumstances, it is likely that specialized
     *Note Formatter: 12fb.s would be used with particular `Handler's.

 -- Method: Logger.info (msg, *args, **kwargs)
     Logs a message with level `INFO' on this logger. The arguments are
     interpreted as for *Note debug(): 12fd.

 -- Method: Logger.warning (msg, *args, **kwargs)
     Logs a message with level `WARNING' on this logger. The arguments
     are interpreted as for *Note debug(): 12fd.

 -- Method: Logger.error (msg, *args, **kwargs)
     Logs a message with level `ERROR' on this logger. The arguments are
     interpreted as for *Note debug(): 12fd.

 -- Method: Logger.critical (msg, *args, **kwargs)
     Logs a message with level `CRITICAL' on this logger. The arguments
     are interpreted as for *Note debug(): 12fd.

 -- Method: Logger.log (lvl, msg, *args, **kwargs)
     Logs a message with integer level `lvl' on this logger. The other
     arguments are interpreted as for *Note debug(): 12fd.

 -- Method: Logger.exception (msg, *args, **kwargs)
     Logs a message with level `ERROR' on this logger. The arguments are
     interpreted as for *Note debug(): 12fd, except that any passed
     `exc_info' is not inspected. Exception info is always added to the
     logging message. This method should only be called from an
     exception handler.

 -- Method: Logger.addFilter (filt)
     Adds the specified filter `filt' to this logger.

 -- Method: Logger.removeFilter (filt)
     Removes the specified filter `filt' from this logger.

 -- Method: Logger.filter (record)
     Applies this logger’s filters to the record and returns a true
     value if the record is to be processed. The filters are consulted
     in turn, until one of them returns a false value. If none of them
     return a false value, the record will be processed (passed to
     handlers). If one returns a false value, no further processing of
     the record occurs.

 -- Method: Logger.addHandler (hdlr)
     Adds the specified handler `hdlr' to this logger.

 -- Method: Logger.removeHandler (hdlr)
     Removes the specified handler `hdlr' from this logger.

 -- Method: Logger.findCaller ()
     Finds the caller’s source filename and line number. Returns the
     filename, line number and function name as a 3-element tuple.

     Changed in version 2.4: The function name was added. In earlier
     versions, the filename and line number were returned as a
     2-element tuple.


 -- Method: Logger.handle (record)
     Handles a record by passing it to all handlers associated with
     this logger and its ancestors (until a false value of `propagate'
     is found). This method is used for unpickled records received from
     a socket, as well as those created locally.  Logger-level
     filtering is applied using *Note filter(): 1305.

 -- Method: Logger.makeRecord (name, lvl, fn, lno, msg, args, exc_info,
          func=None, extra=None)
     This is a factory method which can be overridden in subclasses to
     create specialized *Note LogRecord: 130b. instances.

     Changed in version 2.5: `func' and `extra' were added.



File: python.info,  Node: Logging Levels,  Next: Handler Objects,  Prev: Logger Objects,  Up: logging — Logging facility for Python

5.15.7.2 Logging Levels
.......................

The numeric values of logging levels are given in the following table.
These are primarily of interest if you want to define your own levels,
and need them to have specific values relative to the predefined
levels. If you define a level with the same numeric value, it
overwrites the predefined value; the predefined name is lost.

Level              Numeric value
--------------------------------------- 
`CRITICAL'         50
`ERROR'            40
`WARNING'          30
`INFO'             20
`DEBUG'            10
`NOTSET'           0


File: python.info,  Node: Handler Objects,  Next: Formatter Objects,  Prev: Logging Levels,  Up: logging — Logging facility for Python

5.15.7.3 Handler Objects
........................

Handlers have the following attributes and methods. Note that `Handler'
is never instantiated directly; this class acts as a base for more
useful subclasses. However, the *Note __init__(): 394. method in
subclasses needs to call *Note Handler.__init__(): 130f.

 -- Method: Handler.__init__ (level=NOTSET)
     Initializes the `Handler' instance by setting its level, setting
     the list of filters to the empty list and creating a lock (using
     *Note createLock(): 1310.) for serializing access to an I/O
     mechanism.

 -- Method: Handler.createLock ()
     Initializes a thread lock which can be used to serialize access to
     underlying I/O functionality which may not be threadsafe.

 -- Method: Handler.acquire ()
     Acquires the thread lock created with *Note createLock(): 1310.

 -- Method: Handler.release ()
     Releases the thread lock acquired with *Note acquire(): 1311.

 -- Method: Handler.setLevel (lvl)
     Sets the threshold for this handler to `lvl'. Logging messages
     which are less severe than `lvl' will be ignored. When a handler
     is created, the level is set to `NOTSET' (which causes all
     messages to be processed).

     See *Note Logging Levels: 12f7. for a list of levels.

 -- Method: Handler.setFormatter (form)
     Sets the *Note Formatter: 12fb. for this handler to `form'.

 -- Method: Handler.addFilter (filt)
     Adds the specified filter `filt' to this handler.

 -- Method: Handler.removeFilter (filt)
     Removes the specified filter `filt' from this handler.

 -- Method: Handler.filter (record)
     Applies this handler’s filters to the record and returns a true
     value if the record is to be processed. The filters are consulted
     in turn, until one of them returns a false value. If none of them
     return a false value, the record will be emitted. If one returns a
     false value, the handler will not emit the record.

 -- Method: Handler.flush ()
     Ensure all logging output has been flushed. This version does
     nothing and is intended to be implemented by subclasses.

 -- Method: Handler.close ()
     Tidy up any resources used by the handler. This version does no
     output but removes the handler from an internal list of handlers
     which is closed when *Note shutdown(): 131a. is called. Subclasses
     should ensure that this gets called from overridden *Note close():
     1319. methods.

 -- Method: Handler.handle (record)
     Conditionally emits the specified logging record, depending on
     filters which may have been added to the handler. Wraps the actual
     emission of the record with acquisition/release of the I/O thread
     lock.

 -- Method: Handler.handleError (record)
     This method should be called from handlers when an exception is
     encountered during an *Note emit(): 131d. call. If the
     module-level attribute `raiseExceptions' is `False', exceptions
     get silently ignored. This is what is mostly wanted for a logging
     system - most users will not care about errors in the logging
     system, they are more interested in application errors. You could,
     however, replace this with a custom handler if you wish.  The
     specified record is the one which was being processed when the
     exception occurred. (The default value of `raiseExceptions' is
     `True', as that is more useful during development).

 -- Method: Handler.format (record)
     Do formatting for a record - if a formatter is set, use it.
     Otherwise, use the default formatter for the module.

 -- Method: Handler.emit (record)
     Do whatever it takes to actually log the specified logging record.
     This version is intended to be implemented by subclasses and so
     raises a *Note NotImplementedError: 978.

For a list of handlers included as standard, see *Note
logging.handlers: 104.


File: python.info,  Node: Formatter Objects,  Next: Filter Objects,  Prev: Handler Objects,  Up: logging — Logging facility for Python

5.15.7.4 Formatter Objects
..........................

*Note Formatter: 12fb. objects have the following attributes and
methods. They are responsible for converting a *Note LogRecord: 130b.
to (usually) a string which can be interpreted by either a human or an
external system. The base *Note Formatter: 12fb. allows a formatting
string to be specified. If none is supplied, the default value of
`'%(message)s'' is used, which just includes the message in the logging
call. To have additional items of information in the formatted output
(such as a timestamp), keep reading.

A Formatter can be initialized with a format string which makes use of
knowledge of the *Note LogRecord: 130b. attributes - such as the
default value mentioned above making use of the fact that the user’s
message and arguments are pre-formatted into a *Note LogRecord:
130b.’s `message' attribute.  This format string contains standard
Python %-style mapping keys. See section *Note String Formatting
Operations: 53f.  for more information on string formatting.

The useful mapping keys in a *Note LogRecord: 130b. are given in the
section on *Note LogRecord attributes: 1321.

 -- Class: logging.Formatter (fmt=None, datefmt=None)
     Returns a new instance of the *Note Formatter: 12fb. class.  The
     instance is initialized with a format string for the message as a
     whole, as well as a format string for the date/time portion of a
     message.  If no `fmt' is specified, `'%(message)s'' is used.  If
     no `datefmt' is specified, the ISO8601 date format is used.

      -- Method: format (record)
          The record’s attribute dictionary is used as the operand to
          a string formatting operation. Returns the resulting string.
          Before formatting the dictionary, a couple of preparatory
          steps are carried out. The `message' attribute of the record
          is computed using `msg' % `args'. If the formatting string
          contains `'(asctime)'', *Note formatTime(): 1323. is called
          to format the event time. If there is exception information,
          it is formatted using *Note formatException(): 1324. and
          appended to the message. Note that the formatted exception
          information is cached in attribute `exc_text'. This is useful
          because the exception information can be pickled and sent
          across the wire, but you should be careful if you have more
          than one *Note Formatter: 12fb. subclass which customizes the
          formatting of exception information. In this case, you will
          have to clear the cached value after a formatter has done its
          formatting, so that the next formatter to handle the event
          doesn’t use the cached value but recalculates it afresh.

      -- Method: formatTime (record, datefmt=None)
          This method should be called from *Note format(): 1ef. by a
          formatter which wants to make use of a formatted time. This
          method can be overridden in formatters to provide for any
          specific requirement, but the basic behavior is as follows:
          if `datefmt' (a string) is specified, it is used with *Note
          time.strftime(): 3d8. to format the creation time of the
          record. Otherwise, the ISO8601 format is used.  The resulting
          string is returned.

          This function uses a user-configurable function to convert
          the creation time to a tuple. By default, *Note
          time.localtime(): b19. is used; to change this for a
          particular formatter instance, set the `converter' attribute
          to a function with the same signature as *Note
          time.localtime(): b19. or *Note time.gmtime(): b7f. To change
          it for all formatters, for example if you want all logging
          times to be shown in GMT, set the `converter' attribute in
          the `Formatter' class.

      -- Method: formatException (exc_info)
          Formats the specified exception information (a standard
          exception tuple as returned by *Note sys.exc_info(): 306.) as
          a string. This default implementation just uses *Note
          traceback.print_exception(): 1325. The resulting string is
          returned.


File: python.info,  Node: Filter Objects,  Next: LogRecord Objects,  Prev: Formatter Objects,  Up: logging — Logging facility for Python

5.15.7.5 Filter Objects
.......................

`Filters' can be used by `Handlers' and `Loggers' for more sophisticated
filtering than is provided by levels. The base filter class only allows
events which are below a certain point in the logger hierarchy. For
example, a filter initialized with ‘A.B’ will allow events logged
by loggers ‘A.B’, ‘A.B.C’, ‘A.B.C.D’, ‘A.B.D’ etc. but
not ‘A.BB’, ‘B.A.B’ etc. If initialized with the empty string,
all events are passed.

 -- Class: logging.Filter (name='')
     Returns an instance of the *Note Filter: 1328. class. If `name' is
     specified, it names a logger which, together with its children,
     will have its events allowed through the filter. If `name' is the
     empty string, allows every event.

      -- Method: filter (record)
          Is the specified record to be logged? Returns zero for no,
          nonzero for yes. If deemed appropriate, the record may be
          modified in-place by this method.

Note that filters attached to handlers are consulted before an event is
emitted by the handler, whereas filters attached to loggers are
consulted whenever an event is logged (using *Note debug(): 12fd, *Note
info(): 132a, etc.), before sending an event to handlers. This means
that events which have been generated by descendant loggers will not be
filtered by a logger’s filter setting, unless the filter has also
been applied to those descendant loggers.

You don’t actually need to subclass `Filter': you can pass any
instance which has a `filter' method with the same semantics.

Although filters are used primarily to filter records based on more
sophisticated criteria than levels, they get to see every record which
is processed by the handler or logger they’re attached to: this can
be useful if you want to do things like counting how many records were
processed by a particular logger or handler, or adding, changing or
removing attributes in the LogRecord being processed. Obviously
changing the LogRecord needs to be done with some care, but it does
allow the injection of contextual information into logs (see *Note
Using Filters to impart contextual information: 132b.).


File: python.info,  Node: LogRecord Objects,  Next: LogRecord attributes,  Prev: Filter Objects,  Up: logging — Logging facility for Python

5.15.7.6 LogRecord Objects
..........................

*Note LogRecord: 130b. instances are created automatically by the *Note
Logger: 1dd.  every time something is logged, and can be created
manually via *Note makeLogRecord(): 132e. (for example, from a pickled
event received over the wire).

 -- Class: logging.LogRecord (name, level, pathname, lineno, msg, args,
          exc_info, func=None)
     Contains all the information pertinent to the event being logged.

     The primary information is passed in `msg' and `args', which are
     combined using `msg % args' to create the `message' field of the
     record.

     Parameters:

        * `name' – The name of the logger used to log the event
          represented by this LogRecord. Note that this name will
          always have this value, even though it may be emitted by a
          handler attached to a different (ancestor) logger.

        * `level' – The numeric level of the logging event (one of
          DEBUG, INFO etc.)  Note that this is converted to `two'
          attributes of the LogRecord: `levelno' for the numeric value
          and `levelname' for the corresponding level name.

        * `pathname' – The full pathname of the source file where the
          logging call was made.

        * `lineno' – The line number in the source file where the
          logging call was made.

        * `msg' – The event description message, possibly a format
          string with placeholders for variable data.

        * `args' – Variable data to merge into the `msg' argument to
          obtain the event description.

        * `exc_info' – An exception tuple with the current exception
          information, or `None' if no exception information is
          available.

        * `func' – The name of the function or method from which the
          logging call was invoked.

     Changed in version 2.5: `func' was added.

      -- Method: getMessage ()
          Returns the message for this *Note LogRecord: 130b. instance
          after merging any user-supplied arguments with the message.
          If the user-supplied message argument to the logging call is
          not a string, *Note str(): 1ea. is called on it to convert it
          to a string. This allows use of user-defined classes as
          messages, whose `__str__' method can return the actual format
          string to be used.


File: python.info,  Node: LogRecord attributes,  Next: LoggerAdapter Objects,  Prev: LogRecord Objects,  Up: logging — Logging facility for Python

5.15.7.7 LogRecord attributes
.............................

The LogRecord has a number of attributes, most of which are derived
from the parameters to the constructor. (Note that the names do not
always correspond exactly between the LogRecord constructor parameters
and the LogRecord attributes.) These attributes can be used to merge
data from the record into the format string. The following table lists
(in alphabetical order) the attribute names, their meanings and the
corresponding placeholder in a %-style format string.

Attribute name       Format                        Description
------------------------------------------------------------------------------------------------------- 
args                 You shouldn’t need to       The tuple of arguments merged into `msg' to
                     format this yourself.         produce `message', or a dict whose values are used
                                                   for the merge (when there is only one argument,
                                                   and it is a dictionary).
asctime              `%(asctime)s'                 Human-readable time when the *Note LogRecord:
                                                   130b. was created.  By default this is of the form
                                                   ‘2003-07-08 16:49:45,896’ (the numbers after
                                                   the comma are millisecond portion of the time).
created              `%(created)f'                 Time when the *Note LogRecord: 130b. was created
                                                   (as returned by *Note time.time(): 47d.).
exc_info             You shouldn’t need to       Exception tuple (  la `sys.exc_info') or, if no
                     format this yourself.         exception has occurred, `None'.
filename             `%(filename)s'                Filename portion of `pathname'.
funcName             `%(funcName)s'                Name of function containing the logging call.
levelname            `%(levelname)s'               Text logging level for the message (`'DEBUG'',
                                                   `'INFO'', `'WARNING'', `'ERROR'', `'CRITICAL'').
levelno              `%(levelno)s'                 Numeric logging level for the message (`DEBUG',
                                                   `INFO', `WARNING', `ERROR', `CRITICAL').
lineno               `%(lineno)d'                  Source line number where the logging call was
                                                   issued (if available).
module               `%(module)s'                  Module (name portion of `filename').
msecs                `%(msecs)d'                   Millisecond portion of the time when the *Note
                                                   LogRecord: 130b. was created.
message              `%(message)s'                 The logged message, computed as `msg % args'. This
                                                   is set when *Note Formatter.format(): 1322. is
                                                   invoked.
msg                  You shouldn’t need to       The format string passed in the original logging
                     format this yourself.         call. Merged with `args' to produce `message', or
                                                   an arbitrary object (see *Note Using arbitrary
                                                   objects as messages: 1331.).
name                 `%(name)s'                    Name of the logger used to log the call.
pathname             `%(pathname)s'                Full pathname of the source file where the logging
                                                   call was issued (if available).
process              `%(process)d'                 Process ID (if available).
processName          `%(processName)s'             Process name (if available).
relativeCreated      `%(relativeCreated)d'         Time in milliseconds when the LogRecord was
                                                   created, relative to the time the logging module
                                                   was loaded.
thread               `%(thread)d'                  Thread ID (if available).
threadName           `%(threadName)s'              Thread name (if available).

Changed in version 2.5: `funcName' was added.

Changed in version 2.6: `processName' was added.

